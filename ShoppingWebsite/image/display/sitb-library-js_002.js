var SitbReaderVersion="201205161341",SITB_STR_LANG={BOOK_SECTIONS:"\u7ae0\u8282",SURPRISE_ME:"\u7ed9\u6211\u60ca\u559c!",BY:"\u4f5c\u8005 #{AUTHORS}",GO_TO_BOOK_PAGE:"\u8f6c\u5230\u201c#{BOOK_TITLE}\u201d\u9875\u9762 ",USED_AND_NEW_FROM:"<a href='/gp/offer-listing/#{ASIN}/ref=rdr_ext_uan' id='sitbReaderUsedCount'> #{COUNT} \u65b0\u4e66/\u4e8c\u624b\u4e66</a>, \u6700\u4f4e <span id='sitbReaderUsedPrice' class='sitbReaderPrice'>#{PRICE}</span>",DELIVER_TO:"Deliver To",SEND_SAMPLE:"Send this sample to your Kindle",
PAGE_NOT_AVAILABLE:"\u8be5\u9875\u9762\u6682\u65f6\u4e0d\u53ef\u7528\u3002",SITB_IMAGE_BASE:"http://g-ecx.images-amazon.com/images/G/28/digital/sitb/reader/v4/201111161604/",DEFAULT_ERROR_MSG_HEADER:"\u5f88\u62b1\u6b49\uff01 ",DEFAULT_ERROR_MSG_TEXT:"\u5728\u5b8c\u6210\u60a8\u7684\u8bf7\u6c42\u65f6\u51fa\u73b0\u4e34\u65f6\u51fa\u9519\u3002\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002",DEFAULT_RELATED_EDITION_MSG:"\u60a8\u67e5\u770b\u7684\u662f\u60a8\u539f\u6765\u70b9\u51fb\u8fc7\u7684\u56fe\u4e66\u7684\u76f8\u5173\u7248\u672c\u3002\u5982\u679c\u60a8\u5c06\u6b64\u4e66\u52a0\u5165\u8d2d\u7269\u8f66\uff0c\u60a8\u5c06\u5f97\u5230\u539f\u6765\u70b9\u51fb\u8fc7\u7684\u7248\u672c\u3002",
DEFAULT_RELATED_EDITION_XREF_KINDLE_MSG:"This is a preview of the Kindle book. A preview of the print book is currently not available.",DEFAULT_RELATED_EDITION_XREF_PRINT_MSG:"This is a preview of the print book. A preview of the Kindle book is currently not available.",JUST_SO_YOU_KNOW:"\u60a8\u8981\u77e5\u9053",IN_STANDARDVIEW_TEXT:"\u5c55\u5f00\u89c6\u56fe",IN_FULLSCREEN_TEXT:"\u6807\u51c6\u89c6\u56fe",TTIP_ZOOM_IN:"\u653e\u5927",TTIP_ZOOM_OUT:"\u7f29\u5c0f",TTIP_NEXT_PAGE:"\u4e0b\u4e00\u9875",
TTIP_PREV_PAGE:"\u4e0a\u4e00\u9875",TTIP_NEXT_RESULT:"\u4e0b\u4e00\u7ed3\u679c\u9875",TTIP_PREV_RESULT:"\u4e0a\u4e00\u7ed3\u679c\u9875",TTIP_READER_CLOSE:"\u5173\u95ed \u201c\u5728\u7ebf\u8bd5\u8bfb\u201d(Reader)",TTIP_SEARCH_CLOSE:"\u5173\u95ed\u6b64\u641c\u7d22",TTIP_SEARCH_GO:"\u641c\u7d22",TTIP_SEARCH_INPUT:"\u4e66\u5185\u641c\u7d22",TTIP_MORE_RESULTS:"\u663e\u793a\u66f4\u591a\u7ed3\u679c",SB_HIST_LINK:"\u67e5\u770b\u60a8\u7684\u56fe\u4e66\u5386\u53f2\u8bb0\u5f55",SB_OFF_HIST_LINK:"\u4e86\u89e3\u66f4\u591a",
SB_NO_HIST_LINK:"\u4e86\u89e3\u66f4\u591a",SB_NO_HIST_TEXT:"\u60a8\u6ca1\u6709\u56fe\u4e66\u6d4f\u89c8\u5386\u53f2\u8bb0\u5f55",SB_OFF_HIST_TEXT:"\u60a8\u7684\u56fe\u4e66\u5386\u53f2\u8bb0\u5f55\u5df2\u5173\u95ed",SB_ERR_HIST_TEXT:"\u65e0\u6cd5\u68c0\u7d22\u60a8\u7684\u56fe\u4e66\u5386\u53f2\u8bb0\u5f55",SB_NO_SIMS:"\u65e0\u6cd5\u68c0\u7d22\u5ba2\u6237\u540c\u65f6\u8d2d\u4e70\u7684\u56fe\u4e66",TTIP_SB_PANE_CLD:"\u70b9\u51fb\u67e5\u770b\u60a8\u7684\u6d4f\u89c8\u5386\u53f2\u8bb0\u5f55\u4ee5\u53ca\u7c7b\u4f3c\u56fe\u4e66 ",
TTIP_SB_PANE_OPN:"\u5173\u95ed\u6b64\u56fe\u4e66\u5217\u8868 ",TTIP_SB_TITLE:"\u8f6c\u5230\u5546\u54c1\u9875 #{TITLE}",TTIP_SB_LITB_BUTTON:"\u6253\u5f00\u6b64\u56fe\u4e66\u4ee5\u67e5\u770b\u4e66\u5185\u4fe1\u606f\uff01 ",TTIP_SB_HIST_LINK:"\u67e5\u770b\u60a8\u7684\u56fe\u4e66\u5386\u53f2\u8bb0\u5f55",TTIP_LP_TAB:"\u70b9\u51fb\u67e5\u770b\u6b64\u56fe\u4e66\u7684\u8be6\u60c5 ",PLEASE_SELECT:"\u8bf7\u9009\u62e9...","1_VERY_UNLIKELY":"1 - \u5f88\u4e0d\u53ef\u80fd","2_UNLIKELY":"2 - \u4e0d\u53ef\u80fd",
"3_NEITHER":"3 - \u8bf4\u4e0d\u51c6","4_LIKELY":"4 - \u53ef\u80fd","5_VERY_LIKELY":"5 - \u5f88\u6709\u53ef\u80fd",FEATURE_BROWSING_HISTORY:"\u529f\u80fd\uff1a\u6211\u7684\u6d4f\u89c8\u5386\u53f2",FEATURE_ALSO_BOUGHT:"\u529f\u80fd\uff1a\u5ba2\u6237\u8fd8\u8d2d\u4e70 ",SHARING_YOUR_THOUGHT:"\u5206\u4eab\u60a8\u7684\u60f3\u6cd5\u80fd\u5e2e\u52a9\u6211\u4eec\u6539\u8fdb\u5353\u8d8a\u4e9a\u9a6c\u900a\u201c\u5728\u7ebf\u8bd5\u8bfb\u201d(Amazon Reader)\u3002\u5c3d\u7ba1\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u56de\u590d\uff0c\u6211\u4eec\u80af\u5b9a\u4f1a\u9605\u8bfb\u548c\u8003\u8651\u6240\u6709\u53cd\u9988\u3002 ",
FEEDBACK_TYPE:"\u53cd\u9988\u7c7b\u578b\uff1a ",SUGGESTION:"\u5efa\u8bae",COMMENT_ABOUT:"\u5173\u4e8e\u672c\u4e66\u7684\u8bc4\u8bba",TECHNICAL_PROBLEM:"\u6280\u672f\u95ee\u9898",PRAISE:"\u8d5e\u626c",COMPLAINT:"\u6295\u8bc9\u62b1\u6028",OTHER:"\u5176\u4ed6",YOUR_COMMENTS:"\u60a8\u7684\u8bc4\u8bba\uff1a","1500_MAXIMUM":"\uff08\u6700\u957f 1500 \u4e2a\u5b57\u7b26\uff09",HOW_LIKELY:"\u60a8\u5411\u670b\u53cb\u63a8\u8350\u5353\u8d8a\u4e9a\u9a6c\u900a\u201c\u5728\u7ebf\u8bd5\u8bfb\u201d(Amazon Reader)\u7684\u53ef\u80fd\u6027\u6709\u591a\u5927\uff1f",
THANK_YOU_FOR_FEEDBACK:"\u611f\u8c22\u60a8\u7684\u53cd\u9988\uff01",REQUIRED:"\u5fc5\u586b\u9879",FEEDBACK:"\u53cd\u9988",HELP:"\u5e2e\u52a9",CLOSE:"\u5173\u95ed",KINDLE_PREVIEW:"Kindle Book",PRINT_PREVIEW:"Print Book",INFORMATION_UNAVAILABLE:"\u8be5\u4e66\u4fe1\u606f\u6682\u65f6\u4e0d\u53ef\u7528\u3002",SERVER_TIMEOUT:"\u670d\u52a1\u5668\u8d85\u65f6",PAGE:"\u7b2c #{PAGE} \u9875",INSERT:"\u63d2\u5165",BACK_MATTER:"\u540e\u7f6e\u9875",FRONT_MATTER:"\u524d\u7f6e\u9875",FIRST_PAGES:"\u6b63\u6587\u8282\u9009",
THIS_IS_A_PREVIEW:"\u8fd9\u662f\u4e66\u7684\u6837\u672c\u3002\u53ea\u6709\u90e8\u4efd\u9875\u9762\u663e\u793a\u3002",BROWSING_HISTORY:"\u60a8\u7684\u6d4f\u89c8\u5386\u53f2",CUSTOMER_ALSO_BOUGHT:"\u8d2d\u4e70\u6b64\u5546\u54c1\u7684\u987e\u5ba2\u4e5f\u540c\u65f6\u8d2d\u4e70",PAGE_OF:"\u7b2c #{HTML_START} \u9875\uff0c\u5171 #{HTML_END} \u9875",SEARCH_INSIDE_THIS_BOOK:"\u4e66\u5185\u641c\u7d22",SAMPLE_SEARCHES:"\u4e66\u5185\u6837\u672c\u641c\u7d22:",SIGN_IN_TO_VIEW:"<a href='/gp/search-inside/sign-in?asin=#{ASIN}&query=#{QUERY}'>\u767b\u5f55</a>\u5e76\u67e5\u770b\u641c\u7d22\u7ed3\u679c\u3002",
SHOW_MORE_RESULT:"\u663e\u793a #{RESULT_TO_LOAD}\u66f4\u591a\u7ed3\u679c...",SHOW_MORE_RESULTS:"\u663e\u793a #{RESULTS_TO_LOAD}\u66f4\u591a\u7ed3\u679c...",RESULT_FOR:"<b>#{RESULT_NUM}#{HTML_REPLACE}</b> \u7684\u7ed3\u679c #{SIGN_IN_MSG}",RESULTS_FOR:"<b>#{RESULT_NUM}#{HTML_REPLACE}</b> \u7684\u7ed3\u679c #{SIGN_IN_MSG}",SOME_PAGES_OMITTED:"\u4e00\u4e9b\u9875\u9762\u5728\u672c\u4e66\u9884\u89c8\u65f6\u5ffd\u7565\u3002",PLEASE_USE_SURPRISE_OR_SITB:"\u8bf7\u4f7f\u7528<a class='sitbReader-bookmark-surprise' href='javascript:void(0)' onclick='SitbReader.PageSequenceActions.goToRandomPage()'>\u201c\u8ba9\u6211\u60ca\u559c\uff01\u201d</a>\u6216\u8005\u201c\u4e66\u5185\u641c\u7d22\u201d\u529f\u80fd\u6765\u67e5\u770b\u66f4\u591a\u9875\u9762\u3002 ",
PAGE_NOT_INCLUDED:"\u672c\u4e66\u9884\u89c8\u4e0d\u5305\u542b\u7b2c #{LABEL_START}\u9875.",PAGES_NOT_INCLUDED:"\u672c\u4e66\u9884\u89c8\u4e0d\u5305\u542b\u7b2c #{LABEL_START}\u9875\u5230\u7b2c#{LABEL_END}\u9875.",PLEASE_SIGN_IN:"\u8bf7<a href='/gp/search-inside/sign-in?asin=#{ASIN}&page=#{PAGE}'>\u767b\u5f55</a>\u4ee5\u67e5\u770b\u672c\u4e66\u7684\u66f4\u591a\u9875\u9762\u3002",THIS_IS_A_RANDOM_PAGE:"\u8fd9\u662f\u5c0f\u6837\u672c\u7684\u968f\u673a\u9875\u9762\u3002<a href='/gp/search-inside/sign-in?asin=#{ASIN}&page=random'>\u767b\u5f55</a>\u4ee5\u540e\uff0c\u60a8\u80fd\u9884\u89c8\u8be5\u4e66\u7684\u66f4\u591a\u6837\u672c\u9875\u9762\u3002 ",
REL_ED_MSG_PRINT:"\u6b64\u89c6\u56fe\u4e3a #{AUTHORITY_LINK}#{AUTHORITY_YEAR_DISP}#{AUTHORITY_PUB_DISP}. \u5982\u679c\u5355\u51fb\u5de6\u4fa7\u7684\u201c\u6dfb\u52a0\u5230\u8d2d\u7269\u8f66\u201d\u6309\u94ae\uff0c\u60a8\u6536\u5230\u7684\u5c06\u662f\u60a8\u6700\u521d\u67e5\u770b\u7684 #{RELATED_LINK}#{RELATED_YEAR_DISP}#{RELATED_PUB_DISP}.",REL_ED_MSG_KINDLE:"This view is of the #{AUTHORITY_LINK}#{AUTHORITY_YEAR_DISP}#{AUTHORITY_PUB_DISP}. The #{RELATED_LINK}#{RELATED_YEAR_DISP}#{RELATED_PUB_DISP} that you originally viewed is the one you'll receive if you click the Buy with 1-Click button at left.",
REL_ED_XREF_MSG_PRINT:"This view is of the print book (#{AUTHORITY_LINK_TEXT}). A preview of the Kindle book is currently not available.",REL_ED_XREF_MSG_KINDLE:"This view is of the Kindle book. A preview of the print book (#{RELATED_LINK_TEXT}) is currently not available.",EDITION_NAME:"#{NAME}\u7248\u672c",RELATED_EDITION:"\u76f8\u5173\u7248\u672c",AUTHORITY_EDITION:"\u6743\u5a01\u7248\u672c",PUB_NAME:" \u7531#{NAME}\u63d0\u4f9b",END_OF_PREVIEW:"",END_OF_PREVIEW_BUY:"",NEED_TO_SIGN_IN:"\u6211\u9700\u8981\u767b\u5f55\u624d\u80fd\u9884\u89c8\u56fe\u4e66\u5417\uff1f",
MY_PRIOR_PURCHASE:"\u6211\u9700\u8981\u8d2d\u4e70\u8fc7\u56fe\u4e66\u5417\uff1f",SLIGHTLY_DIFFERENT_CONTENT:"\u4e3a\u4ec0\u4e48\u6211\u770b\u5230\u7684\u8fd9\u672c\u4e66\u5185\u5bb9\u7565\u6709\u4e0d\u540c\uff1f",ADJUST_SIZE_TEXT:"\u6211\u80fd\u8c03\u6574\u6587\u5b57\u7684\u5927\u5c0f\u5417\uff1f",SEARCH_MORE_EFFECTIVELY:"\u6211\u600e\u6837\u624d\u80fd\u66f4\u6709\u6548\u5730\u641c\u7d22\uff1f",PROVIDE_FEEDBACK:"\u6211\u5982\u4f55\u63d0\u4f9b\u53cd\u9988\u3001\u8d5e\u626c\u6216\u6539\u8fdb\u5efa\u8bae\uff1f",
WHAT_IS_BROWSING_HISTORY:"\u4ec0\u4e48\u662f\u6211\u7684\u56fe\u4e66\u6d4f\u89c8\u5386\u53f2\uff1f",NEED_TO_SIGN_IN_ANSWER:"\u4e0d\u7528\uff0c\u4f46\u662f\u67d0\u4e9b\u529f\u80fd\u548c\u9875\u9762\u53ea\u6709\u5728\u60a8\u767b\u5f55\u5230\u5353\u8d8a\u4e9a\u9a6c\u900a\u5e10\u6237\u5e76\u4e14\u5df2\u7ecf\u8d2d\u8fc7\u7269\u624d\u80fd\u4f7f\u7528\u3002\u5bf9\u4e8e\u9009\u62e9\u4e0d\u767b\u5f55\u6216\u8005\u4ece\u672a\u8d2d\u8fc7\u7269\u7684\u5ba2\u6237\uff0c\u6211\u4eec\u4ecd\u7136\u4f1a\u63d0\u4f9b\u4e00\u7ec4\u6709\u5e2e\u52a9\u7684\u4e66\u5185\u9884\u89c8\u9875\u9762\u3002",
MY_PRIOR_PURCHASE_ANSWER:"\u4e0d\u9700\u8981\u3002 Amazon.cn \u9500\u552e\u7684\u4efb\u4f55\u5546\u54c1\u5747\u53ef\u3002\uff08\u6570\u5b57\u5546\u54c1\u53ca\u901a\u8fc7\u5353\u8d8a\u4e9a\u9a6c\u900a\u7f51\u7ad9\u5411\u5176\u4ed6\u5356\u65b9\u8d2d\u4e70\u7684\u5546\u54c1\u76ee\u524d\u6682\u4e0d\u7b26\u5408\u6761\u4ef6\u3002\uff09\u60a8\u7684\u8ba2\u5355\u5386\u53f2\u8bb0\u5f55\u4e2d\u5fc5\u987b\u6709\u5df2\u53d1\u8d27\u7684\u8ba2\u5355\u3002\u5982\u679c\u9700\u8981\u6211\u4eec\u5e2e\u52a9\u60a8\u66f4\u6539\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u6216\u53d6\u56de\u60a8\u65e7\u5e10\u6237\u7684\u5bc6\u7801\uff0c\u8bf7\u8054\u7cfb\u5ba2\u6237\u670d\u52a1\u3002",
SLIGHTLY_DIFFERENT_CONTENT_ANSWER:"\u4e00\u4e9b\u56fe\u4e66\u7684\u9884\u89c8\u94fe\u63a5\u5230\u6211\u4eec\u626b\u63cf\u7684\u56fe\u4e66\u7684\u67d0\u4e2a\u76f8\u5173\u7248\u672c\u3002\u7531\u4e8e\u5185\u5bb9\u57fa\u672c\u76f8\u540c\uff0c\u6211\u4eec\u901a\u5e38\u53ea\u626b\u63cf\u4e00\u4e2a\u7248\u672c\u5e76\u5c06\u8be5\u626b\u63cf\u5185\u5bb9\u5171\u7528\u4e8e\u4e24\u4e2a\u7248\u672c\u7684\u56fe\u4e66\u3002 \u5982\u679c\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u4f1a\u6307\u660e\u6587\u5b57\u6765\u81ea\u54ea\u4e00\u7248\u672c\u7684\u4e66\u3002 ",
ADJUST_SIZE_TEXT_ANSWER:"\u5f53\u7136\u53ef\u4ee5\uff01\u5982\u679c\u9ed8\u8ba4\u7684\u6587\u5b57\u8fc7\u5927\u6216\u8fc7\u5c0f\uff0c\u53ea\u9700\u70b9\u51fb\u7f29\u653e\u56fe\u6807\u5373\u53ef\u653e\u5927\u6216\u7f29\u5c0f\u3002\u5728\u5904\u4e8e\u653e\u5927\u89c6\u56fe\u65f6\uff0c\u60a8\u8fd8\u53ef\u4ee5\u201c\u6293\u53d6\u201d\u56fe\u50cf\uff0c\u62d6\u52a8\u548c\u5e73\u79fb\u3002",SEARCH_MORE_EFFECTIVELY_ANSWER:"\u5982\u679c\u60a8\u641c\u7d22\u7279\u5b9a\u7684\u77ed\u8bed\uff0c\u800c\u4e0d\u662f\u4e00\u7ec4\u5173\u952e\u5b57\uff0c\u8bf7\u7ed9\u77ed\u8bed\u52a0\u4e0a\u5f15\u53f7\uff08\u4f8b\u5982\u201c\u5de6\u6487\u5b50\u51fb\u7403\u624b\u201d\uff09\u3002 \u8fd9\u6837\u5c06\u6bd4\u641c\u7d22\u4e0d\u5e26\u5f15\u53f7\u7684\u77ed\u8bed\u83b7\u5f97\u66f4\u7b80\u77ed\u3001\u66f4\u7cbe\u786e\u7684\u7ed3\u679c\u5217\u8868\u3002",
PROVIDE_FEEDBACK_ANSWER:"\u6211\u4eec\u91cd\u89c6\u60a8\u7684\u53cd\u9988\uff0c\u60a8\u7684\u60f3\u6cd5\u6216\u5efa\u8bae\u662f\u6211\u4eec\u4e0d\u65ad\u6539\u8fdb\u7684\u52a8\u529b\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u201c\u5728\u7ebf\u8bd5\u8bfb\u201d(Reader)\u53f3\u4e0a\u89d2\u7684\u201c\u53cd\u9988\u201d\u7ed9\u4efb\u4f55\u56fe\u4e66\u63d0\u4f9b\u53cd\u9988\u3002",WHAT_IS_BROWSING_HISTORY_ANSWER:'\u56fe\u4e66\u6d4f\u89c8\u5386\u53f2\u8bb0\u5f55\u53ef\u5e2e\u52a9\u60a8\u8bb0\u5f55\u60a8\u6700\u8fd1\u67e5\u770b\u7684\u56fe\u4e66\u3002\u6d4f\u89c8\u5386\u53f2\u8bb0\u5f55\u4f1a\u4e0d\u65ad\u66f4\u65b0\uff0c\u4ee5\u6536\u5f55\u60a8\u6700\u8fd1\u67e5\u770b\u7684\u5546\u54c1\u3002\u8981\u6e05\u9664\u60a8\u7684\u8fd1\u671f\u5386\u53f2\u8bb0\u5f55\uff0c\u8bf7\u8bbf\u95ee<a href="/gp/yourstore/pym/">\u6d4f\u89c8\u5386\u53f2\u8bb0\u5f55</a>\uff0c\u7136\u540e\u70b9\u51fb\u4f4d\u4e8e\u6bcf\u4e2a\u5546\u54c1\u65c1\u7684\u201c\u5220\u9664\u6b64\u8bb0\u5f55\u201d\u94fe\u63a5\u3002\u8981\u6e05\u9664\u6240\u6709\u5546\u54c1\uff0c\u8bf7\u70b9\u51fb\u53f3\u4fa7\u7684\u201c\u5168\u90e8\u5220\u9664\u201d\u6309\u94ae\u3002\u6211\u4eec\u5e0c\u671b\u6d4f\u89c8\u5386\u53f2\u8bb0\u5f55\u5bf9\u60a8\u6709\u5e2e\u52a9\u3002\u5982\u679c\u60a8\u4e0d\u559c\u6b22\u8fd9\u4e2a\u529f\u80fd\uff0c\u60f3\u8981\u5c06\u5b83\u5173\u95ed\uff0c<a href="/gp/yourstore/pym/cc/">\u8bf7\u70b9\u51fb\u6b64\u5904</a>\u3002',
HELP_PAGE:"/gp/help/customer/display.html?nodeId=200497500",FAQ:"\u5e38\u89c1\u95ee\u9898",LEARN_MORE_LITB:"\u8be6\u7ec6\u4e86\u89e3\u201c\u4e66\u5185\u6d4f\u89c8\u201d\u529f\u80fd\uff01",TOC:"\u76ee\u5f55",FRONT_COVER:"\u5c01\u9762",FRONT_FLAP:"\u524d\u52d2\u53e3",COPYRIGHT:"\u7248\u6743\u9875",INDEX:"\u7d22\u5f15",BACK_FLAP:"\u540e\u52d2\u53e3",BACK_COVER:"\u5c01\u5e95",FRONT_FACE:"\u6b63\u9762",BACK_FACE:"\u80cc\u9762",PLEASE_SIGN_IN_TITLE:"\u8bf7\u767b\u5f55",PLEASE_SIGN_IN_TEXT:"\u60a8\u5fc5\u987b\u4ee5\u6709\u6548\u8d26\u6237\u767b\u5f55\u4e4b\u540e\u65b9\u53ef\u67e5\u770b\u672c\u9875\u3002\u8bf7<a href='/gp/search-inside/sign-in?#{LOGIN_RETURN_ARGS}'>\u767b\u5f55</a>\u60a8\u7684\u5353\u8d8a\u4e9a\u9a6c\u900a\u8d26\u6237\u3002",
PAGE_NOT_AVAILABLE_TITLE:"\u9875\u9762\u4e0d\u53ef\u7528",PAGE_NOT_AVAILABLE_TEXT:"\u4e00\u4e9b\u9875\u9762\u672a\u5305\u62ec\u5728\u672c\u4e66\u6837\u672c\u4e2d",FEATURE_UNAVAILABLE_TITLE:"\u529f\u80fd\u4e0d\u53ef\u7528",FEATURE_UNAVAILABLE_TEXT:"\u5f88\u62b1\u6b49\uff0c\u8be5\u529f\u80fd\u6682\u65f6\u4e0d\u53ef\u7528\u3002\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002",PIC_SUPP_MSG:"\u672c\u4e66\u6837\u672c\u4e2d\u7684\u4e00\u4e9b\u56fe\u50cf\u6839\u636e\u51fa\u7248\u5546\u8981\u6c42\u672a\u663e\u793a ",
PARTIAL_CONTENT_MSG:"\u60a8\u9884\u89c8\u7684\u8fd9\u4e9b\u6837\u672c\u9875\u662f\u51fa\u7248\u5546\u4ece\u56fe\u4e66\u4e2d\u6311\u9009\u51fa\u6765\u7684\u3002",KINDLE_COVER:"Cover",KINDLE_START_READING_LOCATION:"Beginning",SEND_CUSTOMER_REQUEST:"<strong>Tell the Publisher!</strong><br><a id='sitbReaderCustomerRequestLink'>I\u2019d like to read this book on Kindle</a><br><br>Don\u2019t have a Kindle?  <a href='/Kindle-Wireless-Reader-Wifi-Graphite/dp/B002Y27P3M/'>Get your Kindle here</a>, or download a <b>FREE</b> <a href='/gp/kindle/kcp/'> Kindle Reading App</a>.<br>",
SEND_CUSTOMER_REQUEST_SUCCESS:"<span><strong>Thank You</strong></span><br><br>Thank you for requesting <a href='dp/#{ASIN}'>#{TITLE}</a> for Kindle. We will pass your specific request on to the publisher.",SEND_CUSTOMER_REQUEST_ERROR:"<span><strong>Sorry</strong></span><br><br>There has been an error processing your request. Please try again later."};SITB_HELP_TEXT_LENGTH=SITB_FEEDBACK_TEXT_LENGTH=34;SITB_MESSAGE_LEFT_SPACE_SIGNIN2=SITB_MESSAGE_LEFT_SPACE_SIGNIN1=160;
SITB_MESSAGE_LEFT_SPACE_SKIP=230;SITB_MESSAGE_LEFT_SPACE_PREVIEW=SITB_MESSAGE_LEFT_SPACE_SKIPNONFPS=330;SITB_CHAPADA_ENABLED=!1;function sitbReaderPriceString(a){return!sitbReaderIsBlank(a)||a===0?"\uffe5"+Number(a).toFixed(2):""}
(function(a){var b,c,d,e;function f(b){return a.data(b,"sitbReader-tooltip")}function g(b){f(this).delay?p=setTimeout(h,f(this).delay):h();o=!!f(this).track;a(document.body).bind("mousemove",m);m(b)}function k(){if(!a.tooltip.blocked&&!(this==l||!this.tooltipText&&!f(this).bodyHandler)){l=this;n=this.tooltipText;if(f(this).bodyHandler){c.hide();var h=f(this).bodyHandler.call(this);h.nodeType||h.jquery?d.empty().append(h):d.html(h);d.show()}else if(f(this).showBody){h=n.split(f(this).showBody);c.html(h.shift()).show();
d.empty();for(var k=0,j;j=h[k];k++)k>0&&d.append("<br/>"),d.append(j);d.hideWhenEmpty()}else c.html(n).show(),d.hide();f(this).showURL&&a(this).url()?e.html(a(this).url().replace("http://","")).show():e.hide();b.addClass(f(this).extraClass);f(this).fixPNG&&b.fixPNG();g.apply(this,arguments)}}function h(){p=null;(!j||!a.fn.bgiframe)&&f(l).fade?b.is(":animated")?b.stop().show().fadeTo(f(l).fade,l.tOpacity):b.is(":visible")?b.fadeTo(f(l).fade,l.tOpacity):b.fadeIn(f(l).fade):b.show();m()}function m(c){if(!a.tooltip.blocked&&
!(c&&c.target.tagName=="OPTION"))if(!o&&b.is(":visible")&&a(document.body).unbind("mousemove",m),l==null)a(document.body).unbind("mousemove",m);else{b.removeClass("viewport-right").removeClass("viewport-bottom");var d=b[0].offsetLeft,e=b[0].offsetTop;c&&(d=c.pageX+f(l).left,e=c.pageY+f(l).top,c="auto",f(l).positionLeft&&(c=a(window).width()-d,d="auto"),b.css({left:d,right:c,top:e}));var c=a(window).scrollLeft(),g=a(window).scrollTop(),h=a(window).width(),k=a(window).height(),j=b[0];c+h<j.offsetLeft+
j.offsetWidth&&(d-=j.offsetWidth+20+f(l).left,b.css({left:d+"px"}).addClass("viewport-right"));g+k<j.offsetTop+j.offsetHeight&&(e-=j.offsetHeight+20+f(l).top,b.css({top:e+"px"}).addClass("viewport-bottom"))}}function q(){function c(){b.removeClass(d.extraClass).hide().css("opacity","")}if(!a.tooltip.blocked){p&&clearTimeout(p);l=null;var d=f(this);(!j||!a.fn.bgiframe)&&d.fade?b.is(":animated")?b.stop().fadeTo(d.fade,0,c):b.stop().fadeOut(d.fade,c):c();f(this).fixPNG&&b.unfixPNG()}}b=void 0;c=void 0;
d=void 0;e=void 0;var l,n,p,j=a.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),o=!1;a.tooltip={blocked:!1,defaults:{delay:200,fade:!1,showURL:!0,extraClass:"",top:15,left:15,id:"sitbReader-tooltip"},block:function(){a.tooltip.blocked=!a.tooltip.blocked}};a.fn.extend({tooltip:function(f){f=a.extend({},a.tooltip.defaults,f);b||(b=a('<div id="'+f.id+'"><span></span><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide(),a.fn.bgiframe&&b.bgiframe(),c=a("span",
b),d=a("div.body",b),e=a("div.url",b));return this.each(function(){a.data(this,"sitbReader-tooltip",f);this.tOpacity=b.css("opacity");this.tooltipText=this.title;a(this).removeAttr("title");this.alt=""}).mouseover(k).mouseout(q).click(q)},fixPNG:j?function(){return this.each(function(){var b=a(this).css("backgroundImage");if(b.match(/^url\(["']?(.*\.png)["']?\)$/i))b=RegExp.$1,a(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+
b+"')"}).each(function(){var b=a(this).css("position");b!="absolute"&&b!="relative"&&a(this).css("position","relative")})})}:function(){return this},unfixPNG:j?function(){return this.each(function(){a(this).css({filter:"",backgroundImage:""})})}:function(){return this},hideWhenEmpty:function(){return this.each(function(){a(this)[a(this).html()?"show":"hide"]()})},url:function(){return this.attr("href")||this.attr("src")}})})(jQuery);
var SitbReader={},SITB_READER_BASE_IMG_URL=sitbReaderGetString("SITB_IMAGE_BASE"),SITB_READER_SPRITES_URL=SITB_READER_BASE_IMG_URL+"sitbreader-sprites._V1_.png",SITB_READER_VERT_SPRITE_URL=SITB_READER_BASE_IMG_URL+"sitbreader-vert-sprites._V1_.png",SITB_READER_HORZ_SPRITE_URL=SITB_READER_BASE_IMG_URL+"sitbreader-horz-sprites._V1_.png",SITB_READER_PANNING_HAND_OPEN=SITB_READER_BASE_IMG_URL+"pho._V1_.cur",SITB_READER_PANNING_HAND_CLOSED=SITB_READER_BASE_IMG_URL+"phc._V1_.cur",SITB_READER_SITB_MODE=
"sitb",SITB_READER_LITB_MODE="litb",LITB_FWD_PAGE_CACHING=2,SITB_FWD_PAGE_CACHING=1,SITB_VIEWABLE_RANGE_LEFT=2,SITB_VIEWABLE_RANGE_RIGHT=2,SITB_READER_BOOKDATA_CACHE_SIZE=3,SITB_READER_2PAGE_SPACING=1,SITB_READER_SEARCH_FETCH_NUMBER_NEXT=20,SITB_READER_SEARCH_FETCH_NUMBER_FIRST=SITB_READER_SEARCH_FETCH_NUMBER_NEXT*1,SITB_READER_DEFAULT_ERROR_MSG_HEADER=sitbReaderGetString("DEFAULT_ERROR_MSG_HEADER"),SITB_READER_DEFAULT_ERROR_MSG_TEXT=sitbReaderGetString("DEFAULT_ERROR_MSG_TEXT"),SITB_READER_DEFAULT_RELATED_EDITION_MSG=
sitbReaderGetString("DEFAULT_RELATED_EDITION_MSG"),SITB_READER_DEFAULT_RELATED_EDITION_XREF_PRINT_MSG=sitbReaderGetString("DEFAULT_RELATED_EDITION_XREF_PRINT_MSG"),SITB_READER_DEFAULT_RELATED_EDITION_XREF_KINDLE_MSG=sitbReaderGetString("DEFAULT_RELATED_EDITION_XREF_KINDLE_MSG"),SITB_READER_JUST_SO_YOU_KNOW=sitbReaderGetString("JUST_SO_YOU_KNOW"),SITB_READER_IN_STANDARDVIEW_TEXT=sitbReaderGetString("IN_STANDARDVIEW_TEXT"),SITB_READER_IN_FULLSCREEN_TEXT=sitbReaderGetString("IN_FULLSCREEN_TEXT"),SITB_READER_TTIP_ZOOM_IN=
sitbReaderGetString("TTIP_ZOOM_IN"),SITB_READER_TTIP_ZOOM_OUT=sitbReaderGetString("TTIP_ZOOM_OUT"),SITB_READER_TTIP_NEXT_PAGE=sitbReaderGetString("TTIP_NEXT_PAGE"),SITB_READER_TTIP_PREV_PAGE=sitbReaderGetString("TTIP_PREV_PAGE"),SITB_READER_TTIP_NEXT_RESULT=sitbReaderGetString("TTIP_NEXT_RESULT"),SITB_READER_TTIP_PREV_RESULT=sitbReaderGetString("TTIP_PREV_RESULT"),SITB_READER_TTIP_READER_CLOSE=sitbReaderGetString("TTIP_READER_CLOSE"),SITB_READER_TTIP_SEARCH_CLOSE=sitbReaderGetString("TTIP_SEARCH_CLOSE"),
SITB_READER_TTIP_SEARCH_GO=sitbReaderGetString("TTIP_SEARCH_GO"),SITB_READER_TTIP_SEARCH_INPUT=sitbReaderGetString("TTIP_SEARCH_INPUT"),SITB_READER_TTIP_MORE_RESULTS=sitbReaderGetString("TTIP_MORE_RESULTS"),SITB_READER_AJAX_TIMEOUT=1E4,SITB_READER_IMG_TIMEOUT=2E4,SITB_READER_KINDLE_CONTENT_AJAX_TIMEOUT=6E4,SITB_SB_LOAD_DELAY_MILLISECONDS=200,SITB_MESSAGE_CLOSE_DELAY=5E3,SITB_READER_BORDER_R=SITB_READER_BASE_IMG_URL+"po_right._V1_.png",SITB_READER_BORDER_L=SITB_READER_BASE_IMG_URL+"po_left._V1_.png",
SITB_READER_BORDER_T=SITB_READER_BASE_IMG_URL+"po_top._V1_.png",SITB_READER_BORDER_B=SITB_READER_BASE_IMG_URL+"po_bottom._V1_.png",SITB_READER_BORDER_TR=SITB_READER_BASE_IMG_URL+"po_top_right._V1_.png",SITB_READER_BORDER_TL=SITB_READER_BASE_IMG_URL+"po_top_left._V1_.png",SITB_READER_BORDER_BL=SITB_READER_BASE_IMG_URL+"po_bottom_left._V1_.png",SITB_READER_BORDER_BR=SITB_READER_BASE_IMG_URL+"po_bottom_right._V1_.png",SITB_READER_LB_TOP=60,SITB_READER_LB_TOP_FULL=27,SITB_READER_LB_LEFT=37,SITB_READER_LB_LEFT_FULL=
5,SITB_READER_LB_LEFT_FULL_IE=3,SITB_READER_LB_HEIGHT_ADJ=41,SITB_READER_LB_HEIGHT_ADJ_FULL=17,SITB_READER_MIN_LB_OFFSET=30,SITB_READER_LB_BOTTOM=38,SITB_READER_SCROLLBAR_WIDTH=20,SITB_READER_LANDSCAPE_BOOK_MARGIN=25,SITB_READER_ZOOM_IN_WIDTH=53,SITB_READER_ZOOM_PADDING_FULL=5,SITB_READER_ZOOM_PADDING_STD=37,SITB_READER_MIN_ZOOM_LINKS_PADDING=10,SITB_READER_MAX_WIDTH=jQuery(document).width()-2*SITB_READER_LB_LEFT,SITB_READER_SMALLSCREEN_MAX_HEIGHT=414,SITB_READER_AJAX_URL="/gp/search-inside/service-data",
SITB_READER_TRIGGER_URL="/gp/search-inside/trigger",SITB_READER_PAGE_HEADER=100,SITB_READER_RIGHT_PAD=15,SITB_READER_LEFT_PANEL_WIDTH=200,SITB_READER_LEFT_PANEL_WIDTH_OPN=206,SITB_READER_LEFT_PANEL_WIDTH_CLD=12,sitbReaderShowPerformanceInfo=!1,SITB_READER_OPEN_DELAY=200,SITB_READER_SCROLL_END_TOLERANCE=80,SITB_READER_BOOKMARK_MIN_HEIGHT=42,SITB_READER_MUTEX_TIMEOUT=500,sitbReaderIsIE=jQuery.browser.msie&&jQuery.browser.version<10,sitbReaderIsIE6=sitbReaderIsIE&&jQuery.browser.version<7,sitbReaderIsFF=
jQuery.browser.mozilla,sitbReaderIsFF2=jQuery.browser.mozilla&&jQuery.browser.version.substr(0,3)=="1.8",SITB_READER_PAGE_SHADOW_WIDTH=4,SITB_READER_PAGE_PADDING=SITB_READER_PAGE_SHADOW_WIDTH+2,SITB_READER_KEY_CODES={LEFT:37,RIGHT:39,UP:38,DOWN:40,PGUP:33,PGDOWN:34,SPACE:32,END:35,ZERO:48,ZERO_NUM:96,MINUS1:109,MINUS2:129,MINUS3:189,PLUS1:61,PLUS2:107,PLUS3:187,HOME:36},SITB_READER_SUPPORTED_KEY_CODE_VALUES=[37,39,38,40,33,34,32,35,48,96,109,129,189,61,107,187,36],SITB_READER_PAN_INCREMENT=20,SITB_READER_PAN_PAGE_RATIO=
0.9,SITB_READER_TRAILING_ELLIPSES_PATTERN=/\.\s*$/,SITB_READER_BLANK_REGEX=/^\s*$/,SITB_READER_SB_HIST_LINK=sitbReaderGetString("SB_HIST_LINK"),SITB_READER_SB_OFF_HIST_LINK=sitbReaderGetString("SB_OFF_HIST_LINK"),SITB_READER_SB_NO_HIST_LINK=sitbReaderGetString("SB_NO_HIST_LINK"),SITB_READER_SB_NO_HIST_TEXT=sitbReaderGetString("SB_NO_HIST_TEXT"),SITB_READER_SB_OFF_HIST_TEXT=sitbReaderGetString("SB_OFF_HIST_TEXT"),SITB_READER_SB_ERR_HIST_TEXT=sitbReaderGetString("SB_ERR_HIST_TEXT"),SITB_READER_SB_NO_SIMS=
sitbReaderGetString("SB_NO_SIMS"),SITB_READER_SB_TITLE_CUT=19,SITB_READER_SB_AUTHOR_CUT=19,SITB_READER_SB_WIDTH=214,SITB_READER_SB_OPENER_WIDTH=20,SITB_READER_SB_OPENER_HEIGHT=263,SITB_READER_MIN_DEFAULT_WIDTH=1152,SITB_READER_LEFT_PANE_COLLAPSER_TOP_ADJ=9,SITB_READER_SB_OPENER_TOP_ADJ=13,SITB_READER_TTIP_SB_PANE_CLD=sitbReaderGetString("TTIP_SB_PANE_CLD"),SITB_READER_TTIP_SB_PANE_OPN=sitbReaderGetString("TTIP_SB_PANE_OPN"),SITB_READER_TTIP_SB_TITLE=sitbReaderGetString("TTIP_SB_TITLE"),SITB_READER_TTIP_SB_LITB_BUTTON=
sitbReaderGetString("TTIP_SB_LITB_BUTTON"),SITB_READER_TTIP_SB_HIST_LINK=sitbReaderGetString("TTIP_SB_HIST_LINK"),SITB_READER_TTIP_LP_TAB=sitbReaderGetString("TTIP_LP_TAB"),SITB_READER_BOOK_TYPE={PRINT:1,HTML:2},SITB_READER_PG_STATE={C:1,Q:0,X:-1,Y:2},SITB_READER_DE_TYPE={PG:1,MSG:2,HS:3},SITB_READER_DE_MSG_TYPE={SIGNIN1:1,SKIP:2,SIGNIN2:3,SKIP_T2NONFPS:4,PREVIEW:5,END_OF_PREVIEW:6},SITB_Reader_MSG_BOX_TYPE={CUSTOMER_REQUEST:1,FONT_SIZE:2,ERROR:3},SITB_READER_TOUCH_DEVICE_TYPES={ios:1,android_2_x:2,
android_3_x:3,kindle_fire:4,other:5},SITB_READER_TOUCH_DEVICE=void 0,SITB_READER_IS_TOUCH_SUPPORTED=isTouchSupported(),SITB_READER_MINIMUM_KINDLE_SAMPLE_LENGTH=100;function sitbReaderIsBlank(a){if(a&&typeof(a!=="string"))return!1;else if(a&&!SITB_READER_BLANK_REGEX.test(a))return!1;return!0}function sitbReaderIsEmpty(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function sitbReaderTrimString(a,b){var c="";a.length>b&&(c="&#0133;");return a.substring(0,b)+c}
function getCurrentPageSequenceNumber(){for(var a=SitbReader.pageSequence.currentPage.toString(36).toUpperCase(),b=3-a.length,c=0;c<b;c++)a="0"+a;return"S"+a}function sitbReaderAjaxRecordTrigger(a){sitbReaderGenericAjaxCall(SITB_READER_TRIGGER_URL,{method:a})}function sitbReaderAjaxCall(a,b,c,d){sitbReaderGenericAjaxCall(SITB_READER_AJAX_URL,a,b,c,d)}
function sitbReaderGenericAjaxCall(a,b,c,d,e){var f=SitbReader.encodingProperties;if(f&&f.on)b[f.name]=f.value;e&&(a+="/ref="+e);jQuery.ajax({url:a,async:!0,type:"POST",data:b,cache:!1,dataType:"json",timeout:SITB_READER_AJAX_TIMEOUT,error:d?d:sitbReaderAjaxCallErrorCallback,success:c})}function sitbReaderAjaxCallErrorCallback(a,b){sitbReaderAjaxErrorMetricLog(b,SitbReader.RefTag.Timeout.generic);SitbReader.ReaderActions.showAjaxErrorMessage()}
function sitbReaderAjaxErrorMetricLog(a,b){SitbReader.metrics.count("ajaxerrors");a=="timeout"&&SitbReader.metrics.count("ajaxtimeouts");SitbReader.RefTag.post(SitbReader.RefTag.Actions.timeout,b)}function sitbReaderAjaxPageNavErrorMetricLog(a,b){SitbReader.metrics.count("ajaxerrors","pagenavajaxerrors");a=="timeout"&&SitbReader.metrics.count("ajaxtimeouts","pagenavajaxtimeouts");SitbReader.RefTag.post(SitbReader.RefTag.Actions.timeout,b)}
function sitbReaderStopEvent(a){a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault()}
function sitbReaderBrowserCode(){var a=navigator.userAgent,b=jQuery.browser.version||"0";return a.match(/iPad/i)?"ipad":a.match(/iPhone/i)?"iphone":a.match(/silk/i)?"fire":a.match(/Android\s2/i)?"android2":a.match(/Android\s3/i)?"android3":a.match(/Android\s4/i)?"android4":jQuery.browser.msie?b.match(/^7/)?"ie7":b.match(/^6/)?"ie6":b.match(/^8/)?"ie8":b.match(/^9/)?"ie9":"ie":jQuery.browser.safari?a.match(/Chrome/i)?"cr":"sf":a.match(/FireFox/i)?"ff":"others"}
jQuery.fn.menufy=function(a,b,c,d){this.unbind("click");typeof d=="undefined"&&(d=6*(a.length+1));return this.click(function(){jQuery("#sitbReaderMenu-title").text()!=a&&(jQuery("#sitbReaderMenu-title").html(a).unbind("click").click(function(){jQuery("#sitbReaderHelpMenu").hide()}).css("cursor","pointer"),jQuery("#sitbReaderMenu-content-center").html(b));jQuery(window).unbind("click.sitbreader");jQuery(window).bind("click.sitbreader",function(a){a=jQuery(a.target);!a.parents().is("#sitbReaderHelpMenu")&&
!a.parents().is("#sitbReaderTBLinks")&&(jQuery("#sitbReaderHelpMenu").hide(),jQuery(window).unbind("click.sitbreader"))});jQuery.browser.msie?(jQuery("#sitbReaderMenu-topcontent").css("padding-right","9px"),jQuery("#sitbReaderMenu-rightborder-top").height(25),jQuery("#sitbReaderMenu-leftborder").height(25),jQuery("#sitbReaderMenu-topright-top").css("left",16+d+"px"),jQuery("#sitbReaderMenu-topborder-top").css("width",13+d+"px"),jQuery("#sitbReaderMenu-topcontent").css("width",18+d+"px"),jQuery("#sitbReaderMenu-rightborder-top").css("left",
20+d+"px"),jQuery("#sitbReaderMenu-close").css("right","10px")):jQuery("#sitbReaderMenu-topcontent").css("width",2+d+"px");jQuery("#sitbReaderMenu-content").css("left",-300+(d+12)+"px");jQuery("#sitbReaderMenu-topborder-content").css("width",284-d+"px");jQuery("#sitbReaderHelpMenu").css("left",jQuery("#"+this.id).offset().left-jQuery("#sitbReaderTBLinks").offset().left-16);jQuery("#sitbReaderHelpMenu").show();sitbRedrawMenuBorder();c&&jQuery.isFunction(c)&&c()})};
function sitbRedrawMenuBorder(){if(jQuery.browser.msie){var a=jQuery("#sitbReaderMenu-content").height();jQuery(".sitbReaderMenu-bottomborder-content").css("top",a);jQuery(".sitbReaderMenu-leftborder-content").height(a-7);jQuery(".sitbReaderMenu-rightborder-content").height(a-7)}}function sitbReaderTruncateToSpace(a,b){if(sitbReaderIsBlank(a)||a.length<=b)return a;var c=a.substring(0,b);return/\s/.test(a[b])?c+"...":c.replace(/(.*)\s+[^\s]*$/,"$1")+"..."}
function sitbReaderGetStateBoolean(a){return a?"1":"0"}function centerJQueryObjectInWindow(a){var b=jQuery(window),c=b.width()/2-a.width()/2,b=b.scrollTop()+b.height()/2-a.height()/2;return a.css({left:c,top:b})}function sitbReaderFindNextResult(a,b,c){for(var d=a.length,e=-1,f;d-e>1;)a[f=d+e>>1]<b?e=f:d=f;c>0?((a[d]<=b||d<0)&&d++,d>=a.length&&(d=0)):((a[d]>=b||d>=a.length)&&d--,d<0&&(d=a.length-1));return a[d]}
function getDecompactedArray(a){var b=[];if(typeof a=="string"&&a.match("((\\d+|\\d+-\\d+),)*(\\d+|\\d+-\\d+)"))for(var a=a.split(","),c=0;c<a.length;c++)if(a[c].match("^\\d+$"))b.push(parseInt(a[c]));else if(/(\d+)-(\d+)/.test(a[c]))for(var d=a[c].split("-"),e=parseInt(d[0]),d=parseInt(d[1]);e<=d;e++)b.push(e);return b}function sitbReaderReplaceHtmlEntities(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}
function sitbReaderGetString(a,b){var c=SITB_STR_LANG[a];typeof b!="undefined"&&(c=c.replace(/\#{([^{]+)}/g,function(a,c){return b[c]}));return c}function sitbReadDhandlerMsg(a){return a.args?sitbReaderGetString(a.key,a.args):sitbReaderGetString(a.key)}function getEncodingProperties(a){var b={on:!1},c=/<input type="hidden" name="(.*)" value="(.*)" \/>/g;if(typeof a=="string"&&a.match(c))b.on=!0,b.name=RegExp.$1,b.value=RegExp.$2;return b}
function sitbReaderGetWeightedNumber(a){var b=Math.random()*100,c=0,d;for(d in a)if(defaultValue=d,c+=a[d],b<c)return d;return 0}
function isTouchSupported(){if(navigator.userAgent.toLowerCase().indexOf("iphone")!=-1||navigator.userAgent.toLowerCase().indexOf("ipad")!=-1)SITB_READER_TOUCH_DEVICE=SITB_READER_TOUCH_DEVICE_TYPES.ios;else if(navigator.userAgent.toLowerCase().indexOf("silk")!=-1)SITB_READER_TOUCH_DEVICE=SITB_READER_TOUCH_DEVICE_TYPES.kindle_fire;else if(navigator.userAgent.toLowerCase().indexOf("android 4")!=-1)SITB_READER_TOUCH_DEVICE=SITB_READER_TOUCH_DEVICE_TYPES.android_4_x;else if(navigator.userAgent.toLowerCase().indexOf("android 3")!=
-1)SITB_READER_TOUCH_DEVICE=SITB_READER_TOUCH_DEVICE_TYPES.android_3_x;else if(navigator.userAgent.toLowerCase().indexOf("android 2")!=-1)SITB_READER_TOUCH_DEVICE=SITB_READER_TOUCH_DEVICE_TYPES.android_2_x;else if("createTouch"in document)SITB_READER_TOUCH_DEVICE=SITB_READER_TOUCH_DEVICE_TYPES.other;return SITB_READER_TOUCH_DEVICE!==void 0}
function sitbReaderGetScrollbarWidth(){var a=jQuery("body"),b=a.css("overflow"),c=a.css("overflow","hidden").width();a.css("overflow","scroll");c-=a.width();c||(c=a.width()-a[0].clientWidth);a.css("overflow",b);SITB_READER_SCROLLBAR_WIDTH=c}function sitbReaderStartsWith(a,b){return a.lastIndexOf(b,0)===0}
SitbReader.BorderElement=function(a,b,c,d,e,f,g){this.spriteUrl=a;this.ie6Url=b;this.spriteOffset={};this.spriteOffset.x=c;this.spriteOffset.y=d;this.offsets=g;this.width=e;this.height=f;this.handle=null;for(var k in SitbReader.Border.borderOffsets)this.offsets[SitbReader.Border.borderOffsets[k]]||(this.offsets[SitbReader.Border.borderOffsets[k]]=null)};
SitbReader.Border={orientations:"t,b,l,r,tr,tl,br,bl".split(","),borderOffsets:["right","left","top","bottom"],applyBorderSet:function(a,b,c){var d=jQuery(a).width(),e=jQuery(a).height(),f;for(f in this.orientations)c[this.orientations[f]]&&this.attachBorderWithOrientation(a,d,e,b,c[this.orientations[f]],this.orientations[f])},isVertical:function(a){return a=="r"||a=="l"?!0:!1},isCorner:function(a){return a.length=="2"?!0:!1},isTop:function(a){return a.substr(0,1)=="t"?!0:!1},isRight:function(a){return a.length==
"2"&&a.substr(1,1)=="r"||a.substr(0,1)=="r"?!0:!1},attachBorderWithOrientation:function(a,b,c,d,e,f){var g,k,h={};k=e.width;g=e.height;var m=!0;this.isRight(f)?h.right=-1*k+e.offsets.right:h.left=-1*k+e.offsets.left;this.isTop(f)?h.top=-1*g+e.offsets.top:h.bottom=-1*g+e.offsets.bottom;this.isCorner(f)?(e.handle?(d=e.handle,m=!1):(d=this.createTransPngDiv(d,e,"no-repeat"),e.handle=d),h.width=k,h.height=g):this.isVertical(f)?(b=h.top=e.offsets.top+0,g=e.offsets.bottom+0,e.handle?(d=e.handle,m=!1):(d=
this.createTransPngDiv(d,e,"repeat-y"),e.handle=d),h.width=k,h.height=c-(b+g)):(k=h.left=e.offsets.left+0,c=e.offsets.right+0,e.handle?(d=e.handle,m=!1):(d=this.createTransPngDiv(d,e,"repeat-x"),e.handle=d),h.width=b-(k+c),h.height=g);h["font-size"]="1px";jQuery(d).css(h);if(m)jQuery(a).append(d),e.parent=!0},createTransPngDiv:function(a,b,c){var d=document.createElement("div");jQuery(d).addClass(a);jQuery(d).css("position","absolute");sitbReaderIsIE6?(a="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+
b.ie6Url+"', sizingMethod=scale)",d=jQuery(d).css("filter",a)):d=jQuery(d).css({background:'url("'+b.spriteUrl+'") '+c,"background-position":"-"+b.spriteOffset.x+"px -"+b.spriteOffset.y+"px"});return d}};SitbReader.Metrics=function(){this.counters={};this.timers={}};SitbReader.Metrics.prototype.start=function(){this.sessionStart=(new Date).getTime()};
SitbReader.Metrics.prototype.end=function(){if(this.sessionStart){var a=(new Date).getTime();if(SitbReader.currentBook.isPrint())for(var b=SitbReader.currentBook.pages,c=1;c<b.length;c++)b[c].visibleStart>0&&a-b[c].visibleStart>1E4&&this.count("twirly");reftag=SitbReader.pageSequence.collectPageMetrics();a-=this.sessionStart;var b=[],d;for(d in this.counters)b.push(d+":"+this.counters[d]);d=[];for(var e in this.timers)c=this.timers[e],c.count>0&&d.push(e+":"+parseInt(c.sum/c.count)+":"+c.count);this.counters=
{};this.timers={};this.sessionStart=null;jQuery.ajax({url:"/gp/search-inside/performance/ref="+reftag,data:{sessionTime:a,counters:b.join(","),timing:d.join(",")}})}};SitbReader.Metrics.prototype.count=function(){for(var a=0;a<arguments.length;a++)this.counters[arguments[a]]?this.counters[arguments[a]]++:this.counters[arguments[a]]=1};
SitbReader.Metrics.prototype.startTimer=function(a){var b=this.timers[a];b?b.start?this.count("ub"+a):b.start=(new Date).getTime():this.timers[a]={start:(new Date).getTime(),sum:0,count:0}};SitbReader.Metrics.prototype.endTimer=function(a){var b=this.timers[a];b&&b.start?(b.sum+=(new Date).getTime()-b.start,b.count++,b.start=null):this.count("ub"+a)};SitbReader.Metrics.prototype.recordTimer=function(a,b){var c=this.timers[a];c||(c={sum:0,count:0},this.timers[a]=c);c.sum+=b;c.count++};
SitbReader.RefTag={httpGet:function(a){jQuery.get("/gp/search-inside/reftag/ref="+a+"?asin="+SitbReader.currentBook.buyingAsin)},post:function(a,b,c){setTimeout(function(){SitbReader.RefTag.httpGet(SitbReader.RefTag.getFormatedRefTag(a,b,c))},10)},tokenizeLandingPage:function(a){var b="";switch(a){case sitbReaderGetString("FRONT_COVER"):b="fcv";break;case sitbReaderGetString("FRONT_FLAP"):b="ffl";break;case sitbReaderGetString("COPYRIGHT"):b="cpy";break;case sitbReaderGetString("TOC"):b="toc";break;
case sitbReaderGetString("FIRST_PAGES"):b="txt";break;case sitbReaderGetString("INDEX"):b="idx";break;case sitbReaderGetString("BACK_FLAP"):b="bfl";break;case sitbReaderGetString("BACK_COVER"):b="bcv";break;default:b="cst"}return b},getFormatedRefTag:function(a,b,c){var d="rdr_";SitbReader.currentBook&&SitbReader.currentBook.isHTML()&&(d+="kindle_");if(a&&b&&!c)d+=a+"_"+b;else if(a&&b&&c)firstRefTag=d+a+"_"+b,SitbReader.RefTag.httpGet(firstRefTag),d+=a+"_"+c;else if(a&&!b&&!c)d+=a;else throw"No support for "+
arguments.length+" parameters";return d}};
SitbReader.RefTag.Actions={zoom:"zom",zoomIn:"zmi",zoomOut:"zmo",help:"hlp",next:"nxt",previous:"prv",section:"sec",samplePage:"sam",searchExecuted:"sch",sampleSearchExecuted:"ssch",searchResult:"spg",nextSearchResult:"srn",previousSearchResult:"srp",message:"msg",closeMessage:"msc",exit:"ext",panel:"pan",feedback:"fdb",standardView:"vw_lb",fullscreenView:"vw_fs",leftSeperator:"bk_sep",sbBookHistory:"sb_bh",sbSeperator:"sb_sep",sbPage:"sb_pg",clickToc:"toc",mode:"mode",bottomButton:"bbt",sendCustomerRequest:"scr",
scrolledToEnd:"sc_end",moreSearchResults:"rdr_bar_moreres",sbPaneItem:"rdr_ext_sb_pi",sbTitle:"rdr_ext_sb_ti",sbLookInside:"rdr_sb_li",sbReview:"rdr_ext_cr_",touch:"touch",timeout:"tot",error:"err"};SitbReader.RefTag.LandingPage={frontCover:"fcv",frontFlap:"ffl",toc:"toc",copyright:"cpy",frontMatter:"fma",excerpt:"exc",otherText:"txt",backMatter:"bma",index:"idx",backFlap:"bfl",backCover:"bcv",searchResults:"sch",sitb:"sitb"};
SitbReader.RefTag.MessageType={relatedEditions:"rel",pictureSupression:"pic",notLoggedIn:"login",skipped:"skip",partialContent:"partial"};SitbReader.RefTag.PanelAction={openSections:"seo",closeSections:"sec",openSearch:"sro",closeSearch:"src",open:"opn",close:"cls"};SitbReader.RefTag.SerendipityBar={history:"hist",similarities:"sims"};
SitbReader.RefTag.ExitMethod={thumbnail:"tmb",title:"tit",author:"aut",cart:"atc",usedNew:"uan",link:"cls",button:"clx",exterior:"clg",keyboard:"clk",backbutton:"bck",oneClickBuy:"ocb",sendSample:"ssm",customerRequestKindle:"crb_kdl",customerRequestKindleApps:"crb_kra",customerRequestBooks:"crb_book",endOfSampleBuyLink:"eos_buy",endOfSampleMoreDetail:"eos_detail"};SitbReader.RefTag.Performance={onDocumentReadyLoadStart:"load_start",onDocumentReadyLoadEnd:"load_end"};
SitbReader.RefTag.Application={kindle_dp:"sib_dp_kndl_dp",print_dp:"sib_dp_prnt_dp",kindle_show:"sib_dp_kndl_show",print_show:"sib_dp_prnt_show",dp_tag:"sib_dp"};SitbReader.RefTag.Touch={ios:"ios",android2:"and2",android3:"and3",android4:"and4",fire:"fire",other:"oth"};SitbReader.RefTag.Timeout={readerOpen:"opn",serendipityBar:"sb",highlights:"hgl",toc:"toc",relatedEdition:"rled",pageUrls:"purl",search:"srch",kindleSample:"kdls",generic:"gnrc"};SitbReader.RefTag.Error={empty_sample:"emp_sam"};
SitbReader.Book=function(a){this.type=a.type=="print"?SITB_READER_BOOK_TYPE.PRINT:SITB_READER_BOOK_TYPE.HTML;this.originalBookType=a.original_book_type=="print"?SITB_READER_BOOK_TYPE.PRINT:SITB_READER_BOOK_TYPE.HTML;this.asin=a.ASIN;this.buyingAsin=a.buyingAsin;this.kindleAsin=a.kindleAsin;this.sitbAsin=a.sitbAsin;this.originalAsin=a.originalAsin;this.marketplaceId=a.marketplaceId;this.title=a.title;this.authorNameList=a.authorNameList;this.thumbnailImage=a.thumbnailImage.replace(/\._.+_/,"");this.binding=
a.binding;this.usedAndNewCount=a.usedAndNewCount;this.usedAndNewLowestPrice=a.usedAndNewLowestPrice;this.buyingPrice=a.buyingPrice;this.oneClick=a.oneClick;this.relatedEditionAsin=a.relatedEditionAsin;this.searchable=a.searchable?a.searchable:!1;this.hasFullAccess=a.hasFullAccess?a.hasFullAccess:!1;this.hasPartialContent=a.hasPartialContent?a.hasPartialContent:!1;this.numPages=a.numPages;this.bookmarks=new SitbReader.Bookmarks(a.bookmarks);this.pageLabels=new SitbReader.Pagelabel(a.pageLabelSet,this.numPages,
this.bookmarks);this.sips=a.sampleSearches;this.bookDataLoaded=!0;this.sessionId=a.sessionId;this.reviewStarsImageTag=a.reviewStarsImageTag;this.pages=null;this.st=parseInt(a.st);this.pt=parseInt(a.pt);this.litbPages=a.litbPages;this.zoomable=a.zoomable;this.isAmazonOffer=a.isAmazonOffer?a.isAmazonOffer:!1;this.xPages=getDecompactedArray(a.xPages);this.type==SITB_READER_BOOK_TYPE.PRINT?this.initializePages(a,this.bookmarks):this.sample=a.sample;this.kindleDevices=sitbReaderIsBlank(a.kindleDeviceListHTML)?
"":a.kindleDeviceListHTML;this.kindleBuyItURL=sitbReaderIsBlank(a.buyItURL)?"":a.buyItURL;this.merchantID=sitbReaderIsBlank(a.merchantID)?"":a.merchantID;this.offerListingID=sitbReaderIsBlank(a.offerListingID)?"":a.offerListingID};
SitbReader.Book.prototype.initializePages=function(a,b){this.pages=[];var c=[];a.cPages=getDecompactedArray(a.cPages);var d=SitbReader.pageSequence;if(SitbReader.availability.level==1)for(var e in a.t1Tokens){e=parseInt(e);for(var f=e-2;f<=e+2;f++)c.push(f)}for(e=1;e<=this.numPages;e++)jQuery.inArray(e,this.xPages)>=0?(this.pages[e]=new SitbReader.BookPage(e,b,null,null,null,SITB_READER_PG_STATE.X),SitbReader.availability.irreversibleXPages[e]=!0):jQuery.inArray(e,a.litbPages)>=0||!this.inTextPages(e)?
(f=typeof a.largeImageUrls[e]!="undefined"&&typeof a.jumboImageUrls[e]!="undefined"?new SitbReader.BookPage(e,b,a.largeImageUrls[e],a.jumboImageUrls[e],null,SITB_READER_PG_STATE.C):new SitbReader.BookPage(e,b,null,null,null,SITB_READER_PG_STATE.C),this.pages[e]=f,d.lastAvailablePageNumber=e):(SitbReader.availability.isFPS&&jQuery.inArray(e,a.cPages)>=0?(f=SITB_READER_PG_STATE.C,d.lastAvailablePageNumber=e):SitbReader.availability.level==2&&!SitbReader.availability.isFPS?f=SITB_READER_PG_STATE.Y:SitbReader.availability.numRemPages<=
0?f=SITB_READER_PG_STATE.X:(f=SITB_READER_PG_STATE.Q,d.lastAvailablePageNumber=e),this.pages[e]=new SitbReader.BookPage(e,b,null,null,null,f));if(SitbReader.availability.level<2){d=this.getLastTextPage();for(e=this.st;e<=d;e++)if(this.pages[e].isQ()&&jQuery.inArray(e,c)<0)this.pages[e].state=SITB_READER_PG_STATE.X}if(SitbReader.availability.isFPS&&a.numRemPages>0&&SitbReader.availability.level==1)for(e in a.t1Tokens)this.initializeTokens(e,a.t1Tokens[e]);d=SitbReader.pageSequence;if(this.pages[d.lastAvailablePageNumber].isX())for(e=
d.lastAvailablePageNumber;e>0;e--)if(this.pages[e].isC()||this.pages[e].isQ()){d.lastAvailablePageNumber=e;break}if(this.pages[d.firstAvailablePageNumber].isX())for(e=d.firstAvailablePageNumber;e<=d.lastAvailablePageNumber;e++)if(this.pages[e].isC()||this.pages[e].isQ()){d.firstAvailablePageNumber=e;break}};
SitbReader.Book.prototype.initializeTokens=function(a,b){for(var a=parseInt(a),c=Math.max(a-2,1);c<=Math.min(a+2,this.numPages);c++)if(this.pages[c].token=b,this.pages[c].state!=SITB_READER_PG_STATE.C)this.pages[c].state=SITB_READER_PG_STATE.Q};SitbReader.Book.prototype.getPage=function(a){return this.pages[a]};SitbReader.Book.prototype.getLastTextPage=function(){return this.st+this.pt<=this.numPages?this.st+this.pt-1:this.numPages};
SitbReader.Book.prototype.inTextPages=function(a){return a>=this.st&&a<=this.getLastTextPage()};SitbReader.Book.prototype.getType=function(){return this.type};SitbReader.Book.prototype.isPrint=function(){return this.type==SITB_READER_BOOK_TYPE.PRINT};SitbReader.Book.prototype.isHTML=function(){return this.type==SITB_READER_BOOK_TYPE.HTML};SitbReader.Book.prototype.getOriginalType=function(){return this.originalBookType};
SitbReader.Book.prototype.isOriginalBookPrint=function(){return this.originalBookType==SITB_READER_BOOK_TYPE.PRINT};SitbReader.Book.prototype.isOriginalBookHTML=function(){return this.originalBookType==SITB_READER_BOOK_TYPE.HTML};SitbReader.Book.prototype.hasPrintAsin=function(){return!sitbReaderIsBlank(this.sitbAsin)};SitbReader.Book.prototype.hasKindleAsin=function(){return!sitbReaderIsBlank(this.kindleAsin)};
SitbReader.Book.prototype.getRelatedAsin=function(){if(this.buyingAsin&&this.asin!=this.buyingAsin||this.originalAsin)return this.originalAsin?this.originalAsin:this.asin};
SitbReader.BookPage=function(a,b,c,d,e,f){typeof c=="undefined"&&(d=c=null);typeof e=="undefined"&&(e=null);if(typeof f=="undefined")f=SITB_READER_PG_STATE.Q;this.pageNumber=a;this.divId="sitbReaderPage-"+a;this.largeUrl=c;this.jumboUrl=d;this.jumboImageHeight=this.jumboImageWidth=this.largeImageHeight=this.largeImageWidth=this.jumboImage=this.largeImage=null;this.loaded=!1;this.token=e;this.loadableToken=!1;this.state=f;this.highlights={};this.links=null;this.fetchingUrls=!1;this.isTOC=b.getBookmarkForPage(a)==
sitbReaderGetString("TOC");this.visibleStart=0};SitbReader.BookPage.prototype.getAspectRatio=function(){return typeof this.aspectRatio!="undefined"?this.aspectRatio:SitbReader.pageSequence.defaultAspectRatio};SitbReader.BookPage.prototype.isLoaded=function(a){if(this.isX())return!0;a=SitbReader.ZoomModel.isLargeImageZoomLevel(a)?this.largeImage:this.jumboImage;return a!=null&&a.width>=300};
SitbReader.BookPage.prototype.getScaledDimensions=function(){var a=SitbReader.ZoomModel.getPageWidth(),b=Math.round(a*this.getAspectRatio());return{width:a,height:b}};SitbReader.BookPage.prototype.getImageUrlSet=function(a){return SitbReader.ZoomModel.isLargeImageZoomLevel()^a?{image:this.largeImage,url:this.largeUrl}:{image:this.jumboImage,url:this.jumboUrl}};
SitbReader.BookPage.prototype.loadImage=function(){if(!this.isX()&&!(this.fetchingUrls||this.pageNumber!=1&&!jQuery("#sitbReaderPlaceholder").is(":visible"))){var a=this.getImageUrlSet().image,b=this.getImageUrlSet().url;if(b==null)this.fetchingUrls=!0,function(a){SitbReader.PageSequenceActions.loadPageUrls(a,function(){a.fetchingUrls=!1;a.render.call(a)})}(this);else if(a==null?a=SitbReader.ZoomModel.isLargeImageZoomLevel()?this.largeImage=new Image:this.jumboImage=new Image:SitbReader.currentSearch&&
SitbReader.currentSearch.numResults>0&&this.hasHighlights(SitbReader.currentSearch.currentQuery),a.width==0||a.width==28&&a.height==30){var c=this;a.onload=function(){if(c._shouldObfuscate())c.setState(SITB_READER_PG_STATE.X),c.largeImage=null,c.jumboImage=null,SitbReader.availability.irreversibleXPages[c.pageNumber]=!0;else{if(c.visibleStart>0){var a=(new Date).getTime()-c.visibleStart;c.visibleStart=0;SitbReader.metrics.recordTimer("wait",a)}this.onload=function(){};c.setAspectRatio(c,this);c.render();
c.pageNumber==1&&SitbReader.ZoomActions.updateFitToScreenZoomLevel(c)}};a.onerror=function(){SitbReader.availability.handlePageLoadError(c)};a.src=b}}};SitbReader.BookPage.prototype.render=function(){var a=jQuery("div#"+this.divId);if(a.size()==1){var b="<div class='imageOverlay' id='sitbReaderHighlights-"+this.pageNumber+"'></div>"+this.generateImageHtml(),c=this.getScaledDimensions();a.html(b).width(c.width).height(c.height).parent().width(c.width).height(c.height);SitbReader.ReaderWidget.renderPageOverlay(this.pageNumber)}};
SitbReader.BookPage.prototype.generateImageHtml=function(){if(this.isX()||this.isY())return"";var a=this.getImageUrlSet();if(a.url==null)return this.loadImage(),"";if(!this.isLoaded())if(this.loadImage(),this.canFaux())a=this.getImageUrlSet(!0);else return"";var b=this.getScaledDimensions();return'<img src="'+a.url+'" height="'+b.height+'" width="'+b.width+'"/>'};SitbReader.BookPage.prototype.setVisible=function(){if(!this.isLoaded()&&!this.canFaux()&&this.visibleStart==0)this.visibleStart=(new Date).getTime()};
SitbReader.BookPage.prototype.canFaux=function(){return this.aspectRatio!=null};SitbReader.BookPage.prototype.setAspectRatio=function(a,b){var c=b.width*this.getAspectRatio();this.aspectRatio=b.height/b.width;SitbReader.pageSequence.addAspectRatio(this.aspectRatio);Math.abs(b.height-c)>5&&SitbReader.PageSequenceWidget.requestRedraw()};SitbReader.BookPage.prototype.addUrls=function(a,b){this.fetchingUrls=!1;if(!this.largeUrl||this.largeUrl=="")this.largeUrl=a,this.jumboUrl=b};
SitbReader.BookPage.prototype.hasHighlights=function(a){if(this.highlights[a]==!1)return!1;if(typeof this.highlights[a]=="string")return!0;if(jQuery.inArray(this.pageNumber,SitbReader.currentSearch.resultPageNumbers)<0)return this.highlights[a]=!1;this.loadHighlights(a);return!1};
SitbReader.BookPage.prototype.loadHighlights=function(a){this.highlights[a]=!1;var b=this;sitbReaderAjaxCall({method:"getPositionData",asin:SitbReader.currentBook.asin,page:this.pageNumber,token:this.token,query:encodeURIComponent(a)},function(c){c.highlights&&c.highlights[b.pageNumber]&&(b.highlights[a]=SitbReader.SearchWidget.renderHighlights(c.highlights[b.pageNumber]),SitbReader.ReaderWidget.renderPageOverlay(b.pageNumber))},function(a,b){sitbReaderAjaxPageNavErrorMetricLog(b,SitbReader.RefTag.Timeout.loadHighlights)})};
SitbReader.BookPage.prototype.setState=function(a){if(a==this.state)return!1;if(this.state==SITB_READER_PG_STATE.X&&SitbReader.availability.irreversibleXPages[this.pageNumber])return!1;SitbReader.pageSequence.updateFirstOrLastAvailablePageNumber(this.pageNumber,this.state,a,!1);SitbReader.pageSequence.updateFirstOrLastAvailablePageNumber(this.pageNumber,this.state,a,!0);if(a==SITB_READER_PG_STATE.X)this.visibleStart=0;(a==SITB_READER_PG_STATE.X&&this.state!=SITB_READER_PG_STATE.Y||this.state==SITB_READER_PG_STATE.Y||
this.state==SITB_READER_PG_STATE.X)&&SitbReader.PageSequenceWidget.requestRedraw();this.state=a;a==SITB_READER_PG_STATE.X&&SitbReader.currentSearch&&SitbReader.currentSearch.numResults>0&&(a=jQuery.inArray(this.pageNumber,SitbReader.currentSearch.resultPageNumbers),a>=0&&jQuery("#sitbReaderSearch-result-"+a+" a").addClass("sitbReader-link-disabled"));return!0};SitbReader.BookPage.prototype._hasImages=function(){return!(this.largeImage==null&&this.jumboImage==null)};
SitbReader.BookPage.prototype._shouldObfuscate=function(){var a=SitbReader.availability;if(this._canBeObfuscated()){var b=this._getAdjacentPageCount(-1,!0),c=this._getAdjacentPageCount(1,!0);if(b==0&&c==0){if(b=this._getAdjacentPageCount(-1,!1),c=this._getAdjacentPageCount(1,!1),Math.min(b,c)<a.getSkipPagesNumber())return!0}else return b+c<=a.getConsecPagesNumber()-1?!1:!0;return!1}};
SitbReader.BookPage.prototype._getAdjacentPageCount=function(a,b){for(var c=SitbReader.currentBook.pages,d=SitbReader.availability,e=0,f=a>0?this.pageNumber+1:this.pageNumber-1;e<d.maxConsecPages+1&&(f<c.length&&a>0||f>0&&a<0);f+=a)if(b==c[f]._hasImages()&&c[f]._canBeObfuscated())e++;else break;return e};
SitbReader.BookPage.prototype._canBeObfuscated=function(){var a=SitbReader.availability,b=SitbReader.currentBook.bookmarks.getBookmarkInfo(this.pageNumber);return b!=null&&(b.name!=sitbReaderGetString("FIRST_PAGES")||b.name==sitbReaderGetString("FIRST_PAGES")&&b.index<a.minimumTextLitbPages)?!1:!0};SitbReader.BookPage.prototype.isC=function(){return this.state==SITB_READER_PG_STATE.C};SitbReader.BookPage.prototype.isQ=function(){return this.state==SITB_READER_PG_STATE.Q};
SitbReader.BookPage.prototype.isX=function(){return this.state==SITB_READER_PG_STATE.X};SitbReader.BookPage.prototype.isY=function(){return this.state==SITB_READER_PG_STATE.Y};
SitbReader.Bookmarks=function(a){this.list=[];this.allBookmarkPages=[];for(index in a){var b=new SitbReader.Section(a[index][0],a[index][1],a[index][2]);this.list[index]=b;for(var c=b.firstPageNumber;c<b.firstPageNumber+b.numPages;c++)this.allBookmarkPages[c]={name:b.name,index:c-b.firstPageNumber}}this.size=sitbReaderIsBlank(a)?0:a.length};SitbReader.Bookmarks.prototype.getName=function(a){return this.list[a].name};
SitbReader.Bookmarks.prototype.getNameById=function(a){for(i in this.list)if(a==this.list[i].name.toLowerCase().replace(/[^A-z_]/g,""))return this.list[i].name;return null};SitbReader.Bookmarks.prototype.getSize=function(){return this.size};SitbReader.Bookmarks.prototype.getFirstPageNumber=function(a){return this.list[a].firstPageNumber};
SitbReader.Bookmarks.prototype.getFirstAndLastPageNumberByName=function(a){for(var b=0;b<this.list.length;b++)if(this.list[b].name==a)return{first:this.list[b].firstPageNumber,last:this.list[b].firstPageNumber+this.list[b].numPages};return{first:null,last:null}};SitbReader.Bookmarks.prototype.getIndex=function(a){for(var b=0;b<this.size;b++){var c=this.list[b].firstPageNumber+this.list[b].numPages-1;if(a>=this.list[b].firstPageNumber&&a<=c)return b}return null};
SitbReader.Bookmarks.prototype.isInABookmark=function(a){return this.allBookmarkPages[a]!=null};SitbReader.Bookmarks.prototype.getBookmarkForPage=function(a){a=this.getIndex(a);return a==null?null:this.getName(a)};SitbReader.Bookmarks.prototype.getBookmarkInfo=function(a){return this.allBookmarkPages[a]};SitbReader.Section=function(a,b,c){this.name=a;this.firstPageNumber=b;this.numPages=c};
SitbReader.Excerpt=function(a){this.excerpt=a;this.boldAreas=[];this.backClear=this.frontClear=0;this.findBoldAreas();this.length=this.excerpt.length-this.boldAreas.length*7};
SitbReader.Excerpt.prototype.findBoldAreas=function(){for(var a=0,b,c;(b=this.excerpt.indexOf("<b>",a))!=-1;)a=b+3,c=this.excerpt.indexOf("</b>",a),this.boldAreas.push({start:b,end:c});this.boldAreas.length>0?(this.frontClear=this.boldAreas[0].start-1,this.backClear=this.excerpt.length-(this.boldAreas[this.boldAreas.length-1].end+4)):(this.frontClear=0,this.backClear=this.excerpt.length)};
SitbReader.Excerpt.prototype.removeChars=function(a){if(a<=this.backClear)return this.extractString(0,this.excerpt.length-a);else if(a<=this.backClear+this.frontClear){var b;for(b=0;a-b>this.backClear&&b>=0;b=this.excerpt.indexOf(" ",b)+1);return this.extractString(b,this.excerpt.length-(a-b))}else{var a=this.frontClear+(this.length-a),c=!1;for(b in this.boldAreas)if(b=parseInt(b),a>this.boldAreas[b].start)if(a+=3,a>this.boldAreas[b].end)a+=4;else{c=!0;break}else break;return this.extractString(this.frontClear,
a,c)}};SitbReader.Excerpt.prototype.extractString=function(a,b,c){this.excerpt[b+1]=="."&&b++;b=this.excerpt.substring(a,b);if(c||!SITB_READER_TRAILING_ELLIPSES_PATTERN.test(b))b=b+(c?"</b>":"")+"&#8230;";if(a>0&&!(b.substring(0,3).indexOf(".")!=-1||SITB_READER_TRAILING_ELLIPSES_PATTERN.test(this.excerpt.substring(0,a-1))))b="&#8230;"+b;return b};
SitbReader.Search=function(a){this.currentQuery=a;this.previousDisplayedResult=this.numDisplayedResults=this.numResults=0;this.resultsList=[];this.previousDisplayedResultIndex=this.currentDisplayedResultIndex=0;this.resultPageNumbers=[];this.currentResultsPage=0;this.totalResultsPages=-1;this.fetchNumber=SITB_READER_SEARCH_FETCH_NUMBER_NEXT};
SitbReader.Search.prototype.update=function(a){this.numResults=a.totalResults;this.previousDisplayedResult=this.numDisplayedResults;if(a=a.results){for(var b=0;b<a.length;b++){if(jQuery.inArray(a[b][0],this.resultPageNumbers)>=0)return;this.resultPageNumbers.push(a[b][0]);this.numDisplayedResults++;SitbReader.currentBook.pageLabels.hasLabels&&(a[b][1]=SitbReader.currentBook.pageLabels.getLabel(a[b][0],!0));a[b][2]=new SitbReader.Excerpt(a[b][2]);a[b][4]=!1;this.resultsList.push(a[b])}this.resultPageNumbers.sort(function(a,
b){return a-b})}};SitbReader.Search.prototype.setCurrentResultIndex=function(a){this.previousDisplayedResultIndex=this.currentDisplayedResultIndex;this.currentDisplayedResultIndex=a};SitbReader.Search.prototype.getPageNumber=function(a){return this.resultsList[a][0]};SitbReader.Search.prototype.getLongExcerpt=function(a){return this.resultsList[a][2].excerpt.replace(/\"/g,"&quot;")};SitbReader.Search.prototype.getExcerpt=function(a){return this.resultsList[a][2]};
SitbReader.Search.prototype.getToken=function(a){return this.resultsList[a][3]};SitbReader.Search.prototype.getPageTitle=function(a){return this.resultsList[a][1]};SitbReader.Search.prototype.setVisited=function(a){this.resultsList[a][4]=!0};SitbReader.Search.prototype.isVisited=function(a){return this.resultsList[a][4]};
SitbReader.Search.prototype.getFirstAvailablePageNumber=function(){for(var a=null,b=0;b<this.numDisplayedResults;b++)if(SitbReader.currentBook.pages[this.resultsList[b][0]].isC()||SitbReader.currentBook.pages[this.resultsList[b][0]].isQ()){a=this.resultsList[b][0];break}return a};SitbReader.Search.prototype.getIndex=function(a){for(var b=0;b<this.numDisplayedResults;b++)if(this.resultsList[b][0]==a)return b;return null};
SitbReader.Search.prototype.findNextResult=function(a,b,c){for(var d=a.length,e=-1,f;d-e>1;)a[f=d+e>>1]<b?e=f:d=f;c>0?((a[d]<=b||d<0)&&d++,d>=a.length&&(d=0)):((a[d]>=b||d>=a.length)&&d--,d<0&&(d=a.length-1));b=d;for(e=a.length;SitbReader.currentBook.pages[a[d]].isX();)if(d+=c,d+=e,d%=e,d==b)break;return a[d]};
SitbReader.ZoomModel={minZoomLevel:0,DEFAULT_ZOOM_FOR_LARGE_IMG:1,MAX_PAGE_WIDTH_FOR_PAGE_FIT:600,fitPageZoomLevel:0,userDefinedZoomLevel:!0,LARGE_IMAGE_MAX_ZOOM:1,zoomLevel:1,previousZoomLevel:1,ZOOM_WIDTHS:[-1,600,800,1E3,1200],ZOOM_FONTS:[10,18,26,34,42],ZOOM_FONT_WEIGHTS:[0.5,0.75,1,1.2,1.4,1.6,1.8],ZOOM_LINE_HEIGHT:[100,100,100,100,100],isFitPageZoomLevel:function(){return this.fitPageZoomLevel==this.zoomLevel},canZoomIn:function(){return SitbReader.currentBook.zoomable?this.zoomLevel<this.ZOOM_WIDTHS.length-
1:this.zoomLevel<this.LARGE_IMAGE_MAX_ZOOM},canZoomOut:function(){return this.zoomLevel>this.minZoomLevel},isValidZoomLevel:function(a){return a>=SitbReader.ZoomModel.minZoomLevel&&a<=SitbReader.ZoomModel.ZOOM_WIDTHS.length-1},isLargeImageZoomLevel:function(a){if(typeof a=="undefined")a=this.zoomLevel;return a<=this.LARGE_IMAGE_MAX_ZOOM},isFitToScreenZoomLevel:function(){return this.zoomLevel==this.minZoomLevel},getPageWidth:function(){if(SitbReader.currentBook.isPrint())return this.ZOOM_WIDTHS[this.zoomLevel];
else{var a=SitbReader.ReaderWidget;return 0.95*(jQuery("#sitbReaderPageContainer").width()-(SITB_READER_SCROLLBAR_WIDTH+2*(a.PAGE_TURNER_WIDTH+a.PAGE_TURNER_PAGE_SPACING+a.PAGE_TURNER_SPACING)))}},getFontSize:function(){return this.ZOOM_FONTS[this.zoomLevel]},getZoomFontSizes:function(){for(var a=this.getFontSize(),b="",c=1;c<8;c++)b+=".sitb-font-size-"+c+"{ font-size: "+a*this.ZOOM_FONT_WEIGHTS[c-1]+"px; }\n";return b},getLineHeight:function(){return this.ZOOM_LINE_HEIGHT[this.zoomLevel]},setNativeLargeZoomLevel:function(a){this.zoomLevel=
this.DEFAULT_ZOOM_FOR_LARGE_IMG;this.ZOOM_WIDTHS[this.zoomLevel]=a},setFitPageZoomLevel:function(a){this.ZOOM_WIDTHS[0]=Math.round(a)},updateMinZoomLevel:function(){this.minZoomLevel=this.ZOOM_WIDTHS[0]<this.ZOOM_WIDTHS[1]?0:1},setNativePageWidth:function(a){this.ZOOM_WIDTHS[DEFAULT_ZOOM_FOR_LARGE_IMG]=a},getNativePageWidth:function(){return this.ZOOM_WIDTHS[DEFAULT_ZOOM_FOR_LARGE_IMG]},isZoomLevelChanged:function(){return this.zoomLevel!=this.previousZoomLevel},updatePreviousZoomLevel:function(){this.previousZoomLevel=
this.zoomLevel}};
SitbReader.SBBookItem=function(a,b,c){this.thumbnailUrl=a.thumbnailImageURL.replace(/(.*)_SL75_(.*)/,"$1_SX35_$2");if(this.thumbnailUrl.match(/.*_SX35_.*/)==null&&this.thumbnailUrl.match(/.*_V\d+_.*/))this.thumbnailUrl=this.thumbnailUrl.replace(/(.*_V\d+_)(.*)/,"$1SX35_$2");this.fulltitle=a.title;this.title=sitbReaderTruncateToSpace(a.title,SITB_READER_SB_TITLE_CUT);this.authors=a.authorList;this.price=a.price;this.rating=a.rating;this.asin=a.asin;this.showSitbLink=a.isSITB;if(this.authors&&this.authors.length>
2)this.authors=this.authors.slice(0,2),this.authors.push("et al.");this.pane=b;this.index=parseInt(c)+1;this.getTitleUrl=function(a){return"/dp/"+this.asin+"/ref="+a+"_"+this.pane+"_"+this.index};this.getAuthorLine=function(){return this.authors?" "+sitbReaderGetString("BY",{AUTHORS:sitbReaderTruncateToSpace(this.authors.join(", "),SITB_READER_SB_AUTHOR_CUT)}):""};this.getReviewsSpan=function(){var a="";this.rating.starsImageTag&&this.rating.count&&(a+='<span class="review" onclick="window.location=\'/product-reviews/'+
this.asin+"/"+SitbReader.RefTag.Actions.sbReview+this.pane+"'\">"+this.rating.starsImageTag+' (<span id="count">'+this.rating.count+"</span>)</span>");return a}};
SitbReader.SBBookItem.prototype.render=function(a){var b=jQuery('<div class=book>   <div  title="'+sitbReaderGetString("TTIP_SB_TITLE",{TITLE:this.fulltitle})+'">       <a href="'+this.getTitleUrl(SitbReader.RefTag.Actions.sbPaneItem)+'">           <img class="sitbReaderBookThumbnail" title="'+sitbReaderGetString("TTIP_SB_TITLE",{TITLE:this.fulltitle})+'" alt="Thumbnail for '+this.title+'" src="'+this.thumbnailUrl+'" onload=\'var h=this.height;if(h>54)return;var b=6;if(h%1)b++;b+=Math.floor((54-h)/2);jQuery(this).css({"margin-top":Math.floor((54-h)/2),"margin-bottom":b})\'/>       </a>       <a href="'+
this.getTitleUrl(SitbReader.RefTag.Actions.sbTitle)+'">'+this.title+"       </a>   </div>"+this.getAuthorLine()+'   <div id="info">'+this.getReviewsSpan()+'      <span id="price">'+sitbReaderPriceString(this.price)+"</span>   </div>"+this.createBuyButton()+this.createLITBButton()+"</div>");a.append(b);return b};
SitbReader.SBBookItem.prototype.createBuyButton=function(){return this.showBuyButton?'<div id="buybutton"><form id="sitbReaderSBBuy-'+this.asin+'" action="/gp/legacy-handle-buy-box.html" method="post"><input type="hidden" value="1" name="asin.'+this.asin+'"/><input type="hidden" value="1" name="'+this.asin+'"/><input type="hidden" value="undefined" name="0"/><input type="hidden" value="books" name="store-name"/><input type="hidden" value="1" name="maw"/><div id="sitbReaderCartButton" onclick="jQuery(\'#sitbReaderSBBuy-'+
this.asin+"').submit();\"/></form></div>":""};SitbReader.SBBookItem.prototype.createLITBButton=function(){return this.showSitbLink?'<button id="litbbutton" title="'+SITB_READER_TTIP_SB_LITB_BUTTON+'" onclick="SitbReader.SerendipityBar.goToOtherReader(\''+this.asin+"','"+this.pane+"','"+this.index+"');\" />":""};
SitbReader.SerendipityBar={isOn:!0,historyBooks:[],recommendedBooks:[],dataLoaded:!1,loadBooksFromData:function(a){if(!SitbReader.SerendipityBar.dataloaded){SitbReader.metrics.startTimer("SBdraw");var b=a.history;typeof a.history_off!="undefined"&&a.history_off?SitbReader.SBWidget.historyLoadOff():typeof b=="undefined"?SitbReader.SBWidget.historyLoadEmpty():b.length>0&&SitbReader.SBWidget.historyLoadSuccess();for(var c in b)sitbReaderIsBlank(b[c].title)||SitbReader.SerendipityBar.historyBooks.push(new SitbReader.SBBookItem(b[c],
SitbReader.RefTag.SerendipityBar.history,c));a=a.recommendations;for(c in a)sitbReaderIsBlank(a[c].title)||SitbReader.SerendipityBar.recommendedBooks.push(new SitbReader.SBBookItem(a[c],SitbReader.RefTag.SerendipityBar.similarities,c));a?jQuery("#sitbReaderSB #simsinfo").hide():SitbReader.SBWidget.noSims();SitbReader.SerendipityBar.dataLoaded=!0;SitbReader.SBWidget.hideLoading();SitbReader.SBWidget.resize();SitbReader.metrics.endTimer("SBdraw");SitbReader.metrics.endTimer("SBshow")}},goToOtherReader:function(a,
b,c){window.location="/reader/"+a+"/ref="+SitbReader.RefTag.Actions.sbLookInside+"_"+b+"_"+c+"&state="+SitbReader.LightboxActions.getLightboxStateAttribute()}};SitbReader.ClickableTOC={hasPages:{},visitedPages:{},initialize:function(){SitbReader.ClickableTOC.hasPages={}},addPage:function(a,b){if(a){if(b!=null&&SitbReader.currentBook.pages[a])SitbReader.currentBook.pages[a].links=b;SitbReader.ClickableTOC.hasPages[a]=!0;SitbReader.PageSequenceActions.addTOCLinks(b)}}};
SitbReader.PageSequence=function(){this.lastPageVisited=null;this.lastAvailablePageNumber=this.currentPage=0;this.firstAvailablePageNumber=1;this.zoomLevel=null;this.displayScroll=[];this.scrollHeight=0;this.PARTIAL_DIVS_NUM=5;this.visibleElementIndices=[];this.viewedPages={};this.defaultAspectRatio=1.6;this.pageAspectsForDefault=[];this.visibleElementIndicesPointer=0;if(SitbReader.PageSequence.readingLocationCache===void 0)SitbReader.PageSequence.readingLocationCache=[]};
SitbReader.PageSequence.prototype.getCurrentBookmarkName=function(){var a=SitbReader.currentBook.bookmarks.getIndex(SitbReader.pageSequence.currentPage);return a!=null?SitbReader.currentBook.bookmarks.getName(a):null};SitbReader.PageSequence.prototype.getDisplayElement=function(a){return this.displayScroll[a]};SitbReader.PageSequence.prototype.pushDisplayElement=function(a){this.displayScroll.push(a)};
SitbReader.PageSequence.prototype.replaceDisplayElement=function(a,b){a>0&&a<this.displayScroll.length&&(this.displayScroll[a]=b)};SitbReader.PageSequence.prototype.getScrollLength=function(){return this.displayScroll.length};SitbReader.PageSequence.prototype.emptyScroll=function(){this.displayScroll=[];this.visibleElementIndices=[];this.visibleElementIndicesPointer=this.scrollHeight=0;this._cleanPartialDivs()};SitbReader.PageSequence.prototype.updateScrollHeight=function(a){this.scrollHeight+=a};
SitbReader.PageSequence.prototype.addAspectRatio=function(a){if(!(this.pageAspectsForDefault.length>=7)){this.pageAspectsForDefault.push(a);if(this.pageAspectsForDefault.length==1)this.defaultAspectRatio=a;if(!(this.pageAspectsForDefault.length<3))this.pageAspectsForDefault.sort(),this.defaultAspectRatio=this.pageAspectsForDefault[parseInt(this.pageAspectsForDefault.length/2)]}};
SitbReader.PageSequence.prototype.getPageDisplayIndex=function(a){for(var a=parseInt(a),b=this.displayScroll.length,c=-1,d=0;b-c>1;)if(d=b+c>>1,this.displayScroll[d].pageNumber==a)break;else this.displayScroll[d].pageNumber>a?b=d:c=d;return d};SitbReader.PageSequence.prototype.getPartialDivIndex=function(a){var a=this.getPageDisplayIndex(a),b;for(b in this.visibleElementIndices)if(this.visibleElementIndices[b]==a)return b;return null};
SitbReader.PageSequence.prototype.findVisibleElementIndices=function(a,b){for(var c=[],d=this.displayScroll.length,e=-1,f=0,g;d-e>1;)if(f=d+e>>1,g=this.displayScroll[f].visibleCompare(a,b),g==0)break;else g<0?d=f:e=f;for(;this.displayScroll[--f]&&this.displayScroll[f].visibleCompare(a,b)==0;);for(;this.displayScroll[++f]&&this.displayScroll[f].visibleCompare(a,b)==0;)c.push(f);return c};
SitbReader.PageSequence.prototype.setVisibleElements=function(a,b){for(var c=[],d=0;d<this.PARTIAL_DIVS_NUM;d++)c.push(null);for(d=0;d<a.length;d++)if(!(jQuery.inArray(a[d],this.visibleElementIndices)>=0))for(var e,f=0;f<this.PARTIAL_DIVS_NUM;f++,this.visibleElementIndicesPointer++)if(e=this.visibleElementIndicesPointer%this.PARTIAL_DIVS_NUM,this.visibleElementIndices[e]==null){this.visibleElementIndices[e]=a[d];c[e]=a[d];break}else if(jQuery.inArray(this.visibleElementIndices[e],b)<0){this.displayScroll[this.visibleElementIndices[e]].isDisplayed=
!1;this.displayScroll[this.visibleElementIndices[e]].containerObj=null;this.visibleElementIndices[e]=a[d];c[e]=a[d];break}for(d=0;d<this.PARTIAL_DIVS_NUM;d++)jQuery.inArray(this.visibleElementIndices[d],b)<0&&(this.visibleElementIndices[d]=null);for(d=0;d<c.length;d++)c[d]!=null&&this.displayScroll[c[d]].setOnPartialDiv(d);this._cleanPartialDivs()};
SitbReader.PageSequence.prototype._cleanPartialDivs=function(){for(var a=0;a<this.PARTIAL_DIVS_NUM;a++)this.visibleElementIndices[a]==null&&jQuery("#scrollElm-"+a).removeClass().css({height:"",top:"",width:""}).empty()};SitbReader.PageSequence.prototype.findElementsRangeToSet=function(a){for(var a=Math.max(Math.min(a-parseInt(this.PARTIAL_DIVS_NUM/2),this.displayScroll.length-this.PARTIAL_DIVS_NUM),0),b=[],c=a;c<a+this.PARTIAL_DIVS_NUM&&c<this.displayScroll.length;c++)b.push(c);return b};
SitbReader.PageSequence.prototype.findElementsToSet=function(a){if(a.length<1)return[];for(var b=a[a.length-1];b<this.displayScroll.length-1&&a.length<this.PARTIAL_DIVS_NUM;)if(a.push(++b),this.displayScroll[b].type==SITB_READER_DE_TYPE.PG)break;return a};
SitbReader.PageSequence.prototype.updateFirstOrLastAvailablePageNumber=function(a,b,c,d){var e=d?this.firstAvailablePageNumber:this.lastAvailablePageNumber;if(a==e&&c==SITB_READER_PG_STATE.X&&(b==SITB_READER_PG_STATE.Q||b==SITB_READER_PG_STATE.C))if(b=SitbReader.currentBook.pages,d)for(a+=1;a<=this.lastAvailablePageNumber;a++){if(b[a].state==SITB_READER_PG_STATE.C||b[a].state==SITB_READER_PG_STATE.Q){this.firstAvailablePageNumber=a;break}}else for(a-=1;a>=1;a--){if(b[a].state==SITB_READER_PG_STATE.C||
b[a].state==SITB_READER_PG_STATE.Q){this.lastAvailablePageNumber=a;break}}else if((d&&a<e||!d&&a>e)&&(c==SITB_READER_PG_STATE.C||c==SITB_READER_PG_STATE.Q)&&(b==SITB_READER_PG_STATE.X||b==SITB_READER_PG_STATE.Y))d?this.firstAvailablePageNumber=a:this.lastAvailablePageNumber=a};
SitbReader.PageSequence.prototype.selectCurrentPageNumber=function(a,b,c){if(a.length!=0){this.currentPage=this.displayScroll[a[0]].pageNumber;for(var d=0,e,f=0;f<a.length;f++)if(this.displayScroll[a[f]].type==SITB_READER_DE_TYPE.PG&&(e=this.displayScroll[a[f]].getViewportPercentage(b,c),e>d&&(d=e,this.currentPage=this.displayScroll[a[f]].pageNumber,d>0.5)))break;this.viewedPages[this.currentPage]=!0}};
SitbReader.PageSequence.prototype.collectPageMetrics=function(){var a=SitbReader.currentBook,b=a.st,c=a.pt,d=b+c,e=0,a=SitbReader.metrics;a.count("cs");a.count("level_"+SitbReader.availability.level);SitbReader.availability.isFPS&&a.count("fps");a.count("browser_"+sitbReaderBrowserCode());for(var f in this.viewedPages)b<=f&&f<d?(a.count("text"),e++):a.count("nontext");b=parseInt(e*100/c);a.recordTimer("pct",b);f=jQuery(window).height();c=jQuery(window).width();f>0&&c>0&&(a.recordTimer("height",parseInt(6E5/
f)),a.recordTimer("width",parseInt(1E6/c)));return"rdr_txt_"+b};SitbReader.PageSequence.prototype.getReadingLocation=function(a,b){var c=SitbReader.PageSequence.readingLocationCache[a];c===void 0&&b==SITB_READER_BOOK_TYPE.PRINT?c={lrl:1}:c===void 0&&b==SITB_READER_BOOK_TYPE.HTML&&(c={lrl:"srl"});return c.lrl};
SitbReader.PageSequence.prototype.updateAvailablePages=function(a){a=SitbReader.PageSequence.readingLocationCache[a];if(a!==void 0)this.firstAvailablePageNumber=a.fap,this.lastAvailablePageNumber=a.lap};SitbReader.PageSequence.prototype.putReadingLocation=function(a,b){SitbReader.PageSequence.readingLocationCache[a]={lrl:b,fap:this.firstAvailablePageNumber,lap:this.lastAvailablePageNumber}};
SitbReader.PageSequence.prototype.resetReadingLocationCache=function(){SitbReader.PageSequence.readingLocationCache=[]};SitbReader.DisplayElement=function(a,b,c,d,e,f){this.top=a;this.height=b;this.type=c;this.pageNumber=parseInt(d);if(c==SITB_READER_DE_TYPE.PG)this.page=SitbReader.currentBook.pages[this.pageNumber];this.htmlContent=e;this.msgType=f};
SitbReader.DisplayElement.prototype.setOnPartialDiv=function(a){var a=jQuery("#scrollElm-"+a),b=SitbReader.ZoomModel,c=b.getPageWidth();this.type==SITB_READER_DE_TYPE.PG?(a.removeClass().addClass("pageImage").html("<div id='"+this.page.divId+"'/>").css({height:this.height,top:this.top,width:c,"font-size":"","line-height":""}),this.page.render()):a.removeClass().addClass("scrollMessage").css({height:"","font-size":"","line-height":"",top:this.top,width:b.ZOOM_WIDTHS[b.zoomLevel]}).empty().html(this.htmlContent)};
SitbReader.DisplayElement.prototype.visibleCompare=function(a,b){var c=this.top+this.height;return a<=this.top&&this.top<=b||c>=a&&c<b||c>=b&&this.top<=a?0:this.top>b?-1:1};SitbReader.DisplayElement.prototype.getViewportPercentage=function(a,b){var c=b-a,d=this.top+this.height;return this.top>b||d<a?0:this.top<=a&&d>=a&&d<=b?(d-a)/c:this.top<=b&&this.top>=a&&d>=b?(b-this.top)/c:this.top<=a&&d>=b?1:this.top>=a&&d<=b?this.height/c:0};
SitbReader.Message={relatedEditionMessage:null,pictureSuppressed:null,randomPageLoginMessage:null,partialContentMessage:null,messagesDisplayed:!1,noPagesStdMsg:sitbReaderGetString("SOME_PAGES_OMITTED"),t2NonFPSMsg:sitbReaderGetString("PLEASE_USE_SURPRISE_OR_SITB"),priorityMap:{1:10,2:10,3:10,4:10,5:20},cleanupMessages:function(){this.partialContentMessage=this.randomPageLoginMessage=this.pictureSuppressed=this.relatedEditionMessage=null},haveMessagesToShow:function(){return!(sitbReaderIsBlank(this.relatedEditionMessage)&&
sitbReaderIsBlank(this.randomPageLoginMessage)&&sitbReaderIsBlank(this.pictureSuppressed)&&sitbReaderIsBlank(this.partialContentMessage))},getSkipMessageText:function(a,b){var c=SitbReader.currentBook.pageLabels;if(a>b)var d=a,a=b,b=d;d=c.getLabel(a).replace(/\D+/g,"");c=c.getLabel(b).replace(/\D+/g,"");c=SitbReader.currentBook.pageLabels.hasLabels?sitbReaderIsBlank(d)||sitbReaderIsBlank(c)?this.noPagesStdMsg:a==b?sitbReaderGetString("PAGE_NOT_INCLUDED",{LABEL_START:d}):sitbReaderGetString("PAGES_NOT_INCLUDED",
{LABEL_START:d,LABEL_END:c}):this.noPagesStdMsg;if(SitbReader.availability.numRemPages>0&&(SitbReader.availability.isT2NonFPS()||SitbReader.currentBook.pages[a].isY()))c=this.t2NonFPSMsg;return c},getSignInMessageText:function(a){return sitbReaderGetString("PLEASE_SIGN_IN",{ASIN:SitbReader.currentBook.buyingAsin,PAGE:a})},setRandomSignInMessageText:function(){this.randomPageLoginMessage=sitbReaderGetString("THIS_IS_A_RANDOM_PAGE",{ASIN:SitbReader.currentBook.buyingAsin})},getMessagePriority:function(a){return this.priorityMap[a]},
getHtmlBuyMessage:function(){txtEndOfPreview=sitbReaderGetString("END_OF_PREVIEW");txtBuy=sitbReaderGetString("END_OF_PREVIEW_BUY",{BUYING_ASIN:SitbReader.currentBook.buyingAsin,BUY_ACTION:"javascript:SitbReader.KindleContentActions.endOfSampleBuyLink()",REFTAG:SitbReader.RefTag.getFormatedRefTag(SitbReader.RefTag.Actions.exit,SitbReader.RefTag.ExitMethod.endOfSampleMoreDetail)});return htmlContent="<div class='sitb-buy-box' style='margin-top: 25px; margin-bottom: 25px'><hr />"+txtEndOfPreview+"<br />"+
txtBuy+"<hr /></div>"}};SitbReader.MessageBox=function(a,b){this.messageBoxType=a;switch(a){case SITB_Reader_MSG_BOX_TYPE.CUSTOMER_REQUEST:this.htmlContent=this.getCustomerRequestMessage(b);break;case SITB_Reader_MSG_BOX_TYPE.ERROR:this.htmlContent=this.getErrorMessage(b)}var c=jQuery(document.createElement("div"));c.attr("id","sitbReaderMessageBoxWrapper");c.html(this.htmlContent);this.fragment=document.createDocumentFragment();this.fragment.appendChild(c[0])};
SitbReader.MessageBox.prototype.getCustomerRequestMessage=function(a){htmlContent=this.getInputMessageBox();htmlContent+='<div id="sitbReaderMessageBoxInputHead">'+a.header+"</div>";htmlContent+='<div id="sitbReaderMessageBoxInputBody">'+a.text+"</div>";return htmlContent};
SitbReader.MessageBox.prototype.getErrorMessage=function(a){htmlContent=this.getPlainMessageBox();htmlContent+='<div id="sitbReaderMessageBoxInfoHead">'+a.header+"</div>";htmlContent+='<div id="sitbReaderMessageBoxInfoBody">'+a.text+"</div>";return htmlContent};
SitbReader.MessageBox.prototype.getPlainMessageBox=function(){htmlContent='<div id="sitbReaderMessageBoxInfoMessageIcon"></div>';htmlContent+='<div id="sitbReaderMessageBoxCloseButton"></div>';htmlContent+='<a id="sitbReaderMessageBoxCloseLink" class="sitbReaderClose">'+sitbReaderGetString("CLOSE")+"</a>";return htmlContent};
SitbReader.MessageBox.prototype.getInputMessageBox=function(){htmlContent='<div id="sitbReaderMessageBoxCloseButton"></div>';htmlContent+='<a id="sitbReaderMessageBoxCloseLink" class="sitbReaderClose">'+sitbReaderGetString("CLOSE")+"</a>";return htmlContent};
SitbReader.Pagelabel=function(a,b,c){this.labels=[];for(var d=0;d<b;d++){var e=c.getBookmarkForPage(d+1);e!=null?this.labels.push(e):this.labels.push(!1)}if(a==null)this.hasLabels=!1;else{this.hasLabels=!0;a=a.split("),");this.romans=",c,cc,ccc,cd,d,dc,dcc,dccc,cm,,x,xx,xxx,xl,l,lx,lxx,lxxx,xc,,i,ii,iii,iv,v,vi,vii,viii,ix".split(",");for(var f in a){a[f]=a[f].replace("(","");a[f]=a[f].replace(")","");c=a[f].split(",");e=parseInt(c[0]);for(d=e-1;d<b;d++)if(reg=RegExp("/"+sitbReaderGetString("FRONT_COVER")+
"|"+sitbReaderGetString("BACK_COVER")+"|"+sitbReaderGetString("FRONT_FLAP")+"|"+sitbReaderGetString("BACK_FLAP")+"/"),!this.labels[d]||!this.labels[d].match(reg))c[1]=="a"?this.labels[d]=sitbReaderGetString("PAGE",{PAGE:d-e+1+parseInt(c[2])}):c[1]=="r"?this.labels[d]=sitbReaderGetString("PAGE",{PAGE:this.toRoman(d-e+1+parseInt(c[2]))}):c[1]=="i"&&(this.labels[d]=sitbReaderGetString("INSERT"))}}};
SitbReader.Pagelabel.prototype.getLabel=function(a,b){var c=this.labels[a-1];c==!1&&(c=b?a>SitbReader.currentBook.numPages/2?sitbReaderGetString("BACK_MATTER"):sitbReaderGetString("FRONT_MATTER"):"");return c};SitbReader.Pagelabel.prototype.toRoman=function(a){for(var a=String(parseInt(a)).split(""),b="",c=3;c--;)b=(this.romans[parseInt(a.pop())+c*10]||"")+b;return b};
SitbReader.HistoryActions={useBack:!0,loadTagged:!1,suppressClosing:!1,userInitiatedClose:!1,initialized:!1,initialize:function(){if(!SitbReader.HistoryActions.initialized&&!jQuery.browser.safari)SitbReader.HistoryActions.initialized=!0,amznJQ.available("AmazonHistory",function(){amznJQ.history.change("reader",function(a,b){SitbReader.HistoryActions.onHistoryChange(a+"_"+b)})})},onHistoryChange:function(a){if(SitbReader.HistoryActions.suppressClosing==!0)SitbReader.HistoryActions.suppressClosing=
!1,window.location.replace("#reader_"+SitbReader.currentBook.buyingAsin);else if(a.substr(0,6)=="reader"){if(SitbReader.LightboxActions.openMutex==0&&(a=a.substr(7),/^\w{10}$/.test(a)))Vellum.o(a),SitbReader.HistoryActions.loadTagged=!0}else SitbReader.LightboxActions.openMutex==1&&SitbReader.HistoryActions.loadTagged==!1?(SitbReader.HistoryActions.loadTagged=!0,amznJQ.history.create("reader",SitbReader.currentBook.buyingAsin)):SitbReader.LightboxActions.openMutex==1&&(SitbReader.HistoryActions.userInitiatedClose||
SitbReader.RefTag.post(SitbReader.RefTag.Actions.exit,SitbReader.RefTag.ExitMethod.backbutton),SitbReader.LightboxActions.close())},automaticOpen:function(a){jQuery.browser.safari?SitbReader.HistoryActions.useBack=!1:(SitbReader.HistoryActions.useBack=!1,SitbReader.HistoryActions.suppressClosing=a,SitbReader.HistoryActions.loadTagged=!0)}};
SitbReader.LightboxActions={oldScrollYPos:-1E8,oldScrollXPos:-1E8,openMutex:0,resizeTimeout:null,didLod:!1,currentAsin:null,openTime:0,switchTime:0,readerReady:!1,bookCache:[],resetState:function(){var a=SitbReader.SBWidget.isOpened;SitbReader.SBWidget.isOpened=null;SitbReader.SBActions.isLoading=!1;SitbReader.SerendipityBar.dataLoaded=!1;SitbReader.SerendipityBar.recommendedBooks=[];SitbReader.SerendipityBar.historyBooks=[];SitbReader.Message.messagesDisplayed=!1;SitbReader.MessageWidget.supressMessages=
!1;SitbReader.PageSequenceActions.reset();SitbReader.SearchWidget.clearResults();a&&SitbReader.SBWidget.show(!0)},initialize:function(a){var b=a.ASIN;if(b!=this.currentAsin){this.resetState();if(Vellum.ao)SitbReader.HistoryActions.automaticOpen(!0),Vellum.ao=!1;if(!SitbReader.metrics)SitbReader.metrics=new SitbReader.Metrics;window.sitbLodStart||SitbReader.metrics.startTimer("initialize");this.setInitialLightboxState(window.sitbState);this.bookCache[b]||(this.bookCache[b]={book:void 0,availability:void 0});
if(!this.bookCache[b].availability)this.bookCache[b].availability=new SitbReader.Availability(a);SitbReader.availability=this.bookCache[b].availability;SitbReader.pageSequence=new SitbReader.PageSequence;SitbReader.pageSequence.updateAvailablePages(a.buyingAsin);if(!this.bookCache[b].book)this.bookCache[b].book=new SitbReader.Book(a);SitbReader.currentBook=this.bookCache[b].book;SitbReader.currentSearch=new SitbReader.Search;SitbReader.Message.pictureSuppressed=a.pictureSuppressed?sitbReaderGetString("PIC_SUPP_MSG"):
null;SitbReader.Message.partialContentMessage=a.partialContent?sitbReaderGetString("PARTIAL_CONTENT_MSG"):null;SitbReader.LightboxActions.load();SitbReader.currentBook.isPrint()&&(b=SitbReader.currentBook.bookmarks.getFirstPageNumber(0),(b=SitbReader.currentBook.getPage(b))&&b.loadImage(1));window.sitbLodStart?(SitbReader.metrics.count("lodload"),SitbReader.LightboxActions.didLod=!0,SitbReader.metrics.recordTimer("initialize",(new Date).getTime()-window.sitbLodStart)):SitbReader.metrics.endTimer("initialize");
this.currentAsin=a.ASIN;SitbReader.encodingProperties=getEncodingProperties(a.intlField);sitbReaderGetScrollbarWidth()}},openReader:function(a){Vellum.o(sitbAsin,a);return!1},openReaderToRandomPage:function(a){Vellum.r(sitbAsin,a);return!1},openReaderToSearchResults:function(a,b){Vellum.q(sitbAsin,a,b);return!1},openReaderToPage:function(a,b,c){Vellum.p(sitbAsin,a,b,c);return!1},_openReader:function(a){openReaderCallback=function(){SitbReader.currentBook.isPrint()&&SitbReader.PageSequenceActions.goTo(1)};
SitbReader.LightboxActions.openReaderHelper(a,openReaderCallback)||SitbReader.LightboxActions.reloadReaderHelper(openReaderCallback)},_openReaderToRandomPage:function(a){openReaderToRandomPageCallback=function(){SitbReader.currentBook.isPrint()&&SitbReader.PageSequenceActions.goToRandomPage()};SitbReader.LightboxActions.openReaderHelper(a,openReaderToRandomPageCallback)||SitbReader.LightboxActions.reloadReaderHelper(openReaderToRandomPageCallback)},_openReaderToSearchResults:function(a,b){openReaderToSearchResultsCallback=
function(){a!=""?SitbReader.SearchActions.search(a):SitbReader.currentBook.isPrint()&&SitbReader.PageSequenceActions.goTo(1)};SitbReader.LightboxActions.openReaderHelper(b,openReaderToSearchResultsCallback)||SitbReader.LightboxActions.reloadReaderHelper(openReaderToSearchResultsCallback);return!1},_openReaderToPage:function(a,b,c){b&&SitbReader.PageSequenceActions.installToken(a,b);openReaderToPageCallback=function(){SitbReader.currentBook.isPrint()&&SitbReader.PageSequenceActions.goTo(a)};SitbReader.LightboxActions.openReaderHelper(c,
openReaderToPageCallback)||SitbReader.LightboxActions.reloadReaderHelper(openReaderToPageCallback)},openReaderHelper:function(a,b){if(SitbReader.LightboxActions.openMutex==0){if(SitbReader.LightboxActions.openMutex++,SitbReader.LightboxActions.openMutex>1)return SitbReader.LightboxActions.openMutex--,!1}else return!1;SitbReader.metrics.start();var c=SitbReader.currentBook;sitbReaderBrowserCode()=="ie6"?jQuery(window).unbind("beforeunload.sitbreader").bind("beforeunload.sitbreader",SitbReader.LightboxActions.unload):
jQuery(window).unbind("unload.sitbreader").bind("unload.sitbreader",SitbReader.LightboxActions.unload);!SitbReader.LightboxActions.didLod&&!SitbReader.sitbReaderOpenStart&&(c.isPrint()?(SitbReader.metrics.startTimer("show_print"),SitbReader.metrics.startTimer("show_print_other")):(SitbReader.metrics.startTimer("show_kindle"),SitbReader.metrics.startTimer("show_kindle_other")));SitbReader.MessageActions.getRelatedEditionMessage();jQuery(window).bind("scroll.sitbreader",function(a){sitbReaderStopEvent(a)});
jQuery("body").css("overflow","hidden");SitbReader.LightboxWidget.dimTheLights();SitbReader.metrics.startTimer("showDelay");setTimeout(function(){SitbReader.LightboxActions.openTime=(new Date).getTime();SitbReader.metrics.endTimer("showDelay");SitbReader.metrics.startTimer("showRenderLightbox");SitbReader.LightboxActions.load(!1);SitbReader.LightboxActions.show();b();SitbReader.LightboxActions.readerReady=c.isPrint();SitbReader.metrics.endTimer("showRenderLightbox");SitbReader.LightboxActions.didLod?
(SitbReader.metrics.recordTimer(c.isPrint()?"show_print":"show_kindle",(new Date).getTime()-window.sitbLodStart),SitbReader.metrics.recordTimer(c.isPrint()?"show_print_LoD":"show_kindle_LoD",(new Date).getTime()-window.sitbLodStart),window.sitbLodStart=!1,SitbReader.LightboxActions.didLod=!1):SitbReader.sitbReaderOpenStart?(SitbReader.metrics.recordTimer(c.isPrint()?"show_print":"show_kindle",(new Date).getTime()-SitbReader.sitbReaderOpenStart),SitbReader.metrics.recordTimer(c.isPrint()?"show_print_normal":
"show_kindle_normal",(new Date).getTime()-SitbReader.sitbReaderOpenStart),SitbReader.sitbReaderOpenStart=!1):(SitbReader.metrics.endTimer(c.isPrint()?"show_print":"show_kindle"),SitbReader.metrics.endTimer(c.isPrint()?"show_print_other":"show_kindle_other"));setTimeout(function(){c.isOriginalBookPrint()?SitbReader.RefTag.httpGet(SitbReader.RefTag.Application.print_dp):SitbReader.RefTag.httpGet(SitbReader.RefTag.Application.kindle_dp);c.isPrint()?SitbReader.RefTag.httpGet(SitbReader.RefTag.Application.print_show):
SitbReader.RefTag.httpGet(SitbReader.RefTag.Application.kindle_show);if(amznJQ.history&&window.location.hash.substring(0,7)!="#reader")SitbReader.HistoryActions.loadTagged=!0,amznJQ.history.create("reader",SitbReader.currentBook.buyingAsin)},0);SITB_READER_IS_TOUCH_SUPPORTED&&setTimeout(function(){var a=void 0;switch(SITB_READER_TOUCH_DEVICE){case SITB_READER_TOUCH_DEVICE_TYPES.ios:a=SitbReader.RefTag.Touch.ios;break;case SITB_READER_TOUCH_DEVICE_TYPES.android_2_x:a=SitbReader.RefTag.Touch.android2;
break;case SITB_READER_TOUCH_DEVICE_TYPES.android_3_x:a=SitbReader.RefTag.Touch.android3;break;case SITB_READER_TOUCH_DEVICE_TYPES.android_4_x:a=SitbReader.RefTag.Touch.android4;break;case SITB_READER_TOUCH_DEVICE_TYPES.kindle_fire:a=SitbReader.RefTag.Touch.fire;break;case SITB_READER_TOUCH_DEVICE_TYPES.other:a=SitbReader.RefTag.Touch.other}SitbReader.RefTag.post(SitbReader.RefTag.Actions.touch,a)},0)},SITB_READER_OPEN_DELAY);return!0},reloadReaderHelper:function(a){SitbReader.LightboxActions.readerReady=
!1;SitbReader.LightboxActions.switchTime=(new Date).getTime();SitbReader.metrics.startTimer("reload_pageSequenceWidget_show");SitbReader.PageSequenceWidget.show(!1);SitbReader.metrics.endTimer("reload_pageSequenceWidget_show");setTimeout(function(){SitbReader.MessageActions.getRelatedEditionMessage();SitbReader.MessageWidget.show();SitbReader.currentBook.searchable&&(SitbReader.SearchWidget.load(),SitbReader.SearchWidget.show(),SitbReader.BookmarksWidget.show());SitbReader.currentBook.isPrint()?(SitbReader.PageSequenceWidget.redrawCallback=
function(){SitbReader.PageSequenceWidget.redrawCallback=void 0;a.call();SitbReader.LightboxActions.readerReady=!0},SitbReader.PageSequenceWidget.redraw()):(SitbReader.LightboxActions.handleResize(),a.call(),SitbReader.LightboxActions.readerReady=!0)},0);jQuery("#vellumLdgIco").hide()},show:function(){jQuery("#bookpopover").hide();sitbReaderIsIE6&&SitbReader.LightboxWidget.toggleSelextBoxes(!1);jQuery("#sitbReaderPlaceholder").show();SitbReader.ErrorMessageWidget.hide();SitbReader.ReaderKeyboardActions.load();
SitbReader.metrics.startTimer("show_lightboxwidget_show");SitbReader.LightboxWidget.show(!0);SitbReader.metrics.endTimer("show_lightboxwidget_show");SitbReader.metrics.startTimer("show_pageSequenceWidget_show");SitbReader.PageSequenceWidget.show(!0);SitbReader.metrics.endTimer("show_pageSequenceWidget_show");SitbReader.ReaderWidget.show();SitbReader.ZoomWidget.show();SitbReader.SearchWidget.show();SitbReader.BookmarksWidget.show();SitbReader.LeftPaneWidget.show();SitbReader.SBWidget.show(!0);SitbReader.MessageWidget.show();
SitbReader.BottomButtonWidget.show();this._registerResizeHandler();SitbReader.pageSequence.resetReadingLocationCache();jQuery("#vellumLdgIco").hide()},handleResize:function(){SitbReader.metrics.startTimer("resize");SitbReader.LightboxWidget.resizeShade();SitbReader.LightboxWidget.show();SitbReader.ReaderWidget.updateOnResize();SitbReader.SearchWidget.setResultsHeight();SitbReader.BookmarksWidget.updateHeight();SitbReader.ErrorMessageWidget.resize();SitbReader.BottomButtonWidget.handleResize();SitbReader.MessageBoxWidget.resize();
SitbReader.metrics.startTimer("SBresize");SitbReader.SBWidget.resize();SitbReader.metrics.endTimer("SBresize");jQuery("#vellumLdgIco").hide();SitbReader.metrics.endTimer("resize")},load:function(){if(SitbReader.loadedBook!=SitbReader.currentBook){SitbReader.HistoryActions.initialize();var a=jQuery("#sitbReaderPlaceholder");sitbReaderIsBlank(a.html())&&a.html(getSitbLightboxHTML());SitbReader.BookmarksWidget.load(SitbReader.currentBook.bookmarks);SitbReader.LightboxWidget.load(SitbReader.currentBook.title);
SitbReader.BuyWidget.load(SitbReader.currentBook);SitbReader.SearchWidget.load();SitbReader.FeedbackWidget.load();SitbReader.HelpWidget.load();SitbReader.ModeSwitchWidget.load();SitbReader.BottomButtonWidget.load();SitbReader.CustomerRequestWidget.load();SitbReader.loadedBook=SitbReader.currentBook;SitbReader.ClickableTOC.hasPages=[]}},close:function(){jQuery(window).unbind(".sitbreader").unbind("orientationchange");SitbReader.ReaderKeyboardActions.tearDown();jQuery("#sitbReaderPageContainer").unbind();
SitbReader.PageSequenceActions.reset();sitbReaderIsIE6?jQuery(window).unbind("beforeunload.sitbreader"):jQuery(window).unbind("unload.sitbreader");SitbReader.ReaderWidget.setPageTurnersDisplay(!1);SitbReader.ReaderWidget.setSearchTurnersDisplay(!1);SitbReader.ErrorMessageWidget.hide();SitbReader.MessageWidget.close();SitbReader.BookmarksWidget.slideDown();jQuery("#sitbReaderHelpMenu").hide();jQuery("#sitbReaderMessageContainer").hide();jQuery("#sitbReaderPlaceholder").hide();jQuery("#vellumMsg").hide();
SitbReader.SearchActions.closeCurrentSearch();SitbReader.SearchWidget.slideDown();SitbReader.LightboxWidget.documentIsReady=!0;SitbReader.LightboxWidget.toggleSelextBoxes(!0);SitbReader.LightboxWidget.removeOverlay();jQuery("body").css("overflow","auto");if(jQuery.browser.safari){var a=jQuery(window).scrollTop();jQuery(window).scrollTop(a+1);jQuery(window).scrollTop(a)}SitbReader.metrics.end();SitbReader.LightboxActions.openMutex=0;SitbReader.LightboxActions.lightboxOpened=!1;SitbReader.HistoryActions.userInitiatedClose=
!1},unload:function(){SitbReader.metrics.count("unanounced");SitbReader.metrics.end()},back:function(a,b){if(b)SitbReader.HistoryActions.userInitiatedClose=!0;SitbReader.RefTag.post(SitbReader.RefTag.Actions.exit,a);amznJQ.history&&SitbReader.HistoryActions.useBack&&!jQuery.browser.safari&&amznJQ.history.back();SitbReader.LightboxActions.close()},setInitialLightboxState:function(a){if(/^[0|1]{4}[0-9]$/.test(a)){SitbReader.LightboxWidget.isFullscreen=a.charAt(0)=="1";SitbReader.LeftPaneWidget.isOpened=
a.charAt(1)=="1";SitbReader.SBWidget.isOpened=a.charAt(2)=="1";var b=SitbReader.ZoomModel;b.userDefinedZoomLevel=a.charAt(3)=="1";a=parseInt(a.charAt(4));if(a!=0&&b.userDefinedZoomLevel&&b.isValidZoomLevel(a))b.zoomLevel=a}},getLightboxStateAttribute:function(){return sitbReaderGetStateBoolean(SitbReader.LightboxWidget.isFullscreen)+sitbReaderGetStateBoolean(SitbReader.LeftPaneWidget.isOpened)+sitbReaderGetStateBoolean(SitbReader.SBWidget.isOpened)+sitbReaderGetStateBoolean(SitbReader.ZoomModel.userDefinedZoomLevel)+
SitbReader.ZoomModel.zoomLevel},_registerResizeHandler:function(){SITB_READER_IS_TOUCH_SUPPORTED&&jQuery(window).bind("orientationchange",function(){SITB_READER_MAX_WIDTH=jQuery(document).width()-2*SITB_READER_LB_LEFT;SitbReader.LightboxActions.handleResize()});jQuery(window).unbind("resize.sitbreader").bind("resize.sitbreader",function(){SitbReader.LightboxActions.resizeTimeout&&clearTimeout(SitbReader.LightboxActions.resizeTimeout);SitbReader.LightboxActions.resizeTimeout=setTimeout(function(){SitbReader.LightboxActions._realHandleResize()},
250)})},_realHandleResize:function(){this.resizeTimeout=null;this.handleResize()}};SitbReader.BuyActions={goToDetailPageFromTitle:function(){SitbReader.LightboxActions.back(SitbReader.RefTag.ExitMethod.title,!0)},goToDetailPageFromThumbnail:function(){SitbReader.LightboxActions.back(SitbReader.RefTag.ExitMethod.thumbnail,!0)},oneClickOrder:function(){}};
SitbReader.BookmarksActions={goToBookmark:function(a){if(SitbReader.currentBook.isHTML())switch(a){case "cvr":SitbReader.KindleContentActions.goToCover();break;case "srl":SitbReader.KindleContentActions.goToSRL();break;default:SitbReader.KindleContentActions.goToLocation(a,"name")}else{var b=SitbReader.currentBook.bookmarks.getFirstAndLastPageNumberByName(a).first;SitbReader.PageSequenceActions.goTo(b);SitbReader.RefTag.post(SitbReader.RefTag.Actions.section,SitbReader.RefTag.tokenizeLandingPage(a));
SitbReader.metrics.count("bookmark")}},update:function(){var a=SitbReader.currentBook.bookmarks.getIndex(SitbReader.pageSequence.currentPage);SitbReader.BookmarksWidget.unselect();a!=null&&SitbReader.BookmarksWidget.select(a)},toggleBookmarksPane:function(){jQuery("#sitbReaderBookmarks-pages").is(":hidden")?(SitbReader.BookmarksWidget.slideDown(),SitbReader.RefTag.post(SitbReader.RefTag.Actions.panel,SitbReader.RefTag.PanelAction.openSections)):(SitbReader.BookmarksWidget.slideUp(),SitbReader.RefTag.post(SitbReader.RefTag.Actions.panel,
SitbReader.RefTag.PanelAction.closeSections))}};
SitbReader.SearchActions={search:function(a,b){if(SitbReader.currentBook.searchable&&!sitbReaderIsBlank(a)){SitbReader.metrics.startTimer("search");SitbReader.currentSearch=new SitbReader.Search(a);SitbReader.currentSearch.fetchNumber=SITB_READER_SEARCH_FETCH_NUMBER_FIRST;SitbReader.SearchWidget.showLoading(!0);SitbReader.SearchActions.searchCall(SitbReader.SearchActions.loadFirstQueryResults);if(b==void 0)b=SitbReader.RefTag.Actions.searchExecuted;SitbReader.RefTag.post(b)}},goToSearchResult:function(a){SitbReader.PageSequenceActions.goTo(SitbReader.currentSearch.resultPageNumbers[a])},
goToNextResult:function(){SitbReader.PageSequenceActions.goTo(SitbReader.currentSearch.findNextResult(SitbReader.currentSearch.resultPageNumbers,SitbReader.pageSequence.currentPage,1));SitbReader.RefTag.post(SitbReader.RefTag.Actions.nextSearchResult,SitbReader.RefTag.LandingPage.excerpt)},goToPrevResult:function(){SitbReader.PageSequenceActions.goTo(SitbReader.currentSearch.findNextResult(SitbReader.currentSearch.resultPageNumbers,SitbReader.pageSequence.currentPage,-1));SitbReader.RefTag.post(SitbReader.RefTag.Actions.previousSearchResult,
SitbReader.RefTag.LandingPage.excerpt)},canFetchMoreResults:function(){return SitbReader.currentBook.searchable&&SitbReader.currentSearch.numDisplayedResults!=SitbReader.currentSearch.numResults},fetchMoreResults:function(){if(this.canFetchMoreResults())SitbReader.metrics.startTimer("moreSearch"),SitbReader.SearchWidget.showLoading(!1),SitbReader.currentSearch.fetchNumber=SITB_READER_SEARCH_FETCH_NUMBER_NEXT,SitbReader.SearchActions.searchCall(SitbReader.SearchActions.loadMoreQueryResults,SitbReader.RefTag.Actions.moreSearchResults)},
toggleSearchPane:function(){jQuery("#sitbReaderSearch-contents").is(":hidden")?(SitbReader.SearchWidget.slideDown(),SitbReader.RefTag.post(SitbReader.RefTag.Actions.panel,SitbReader.RefTag.PanelAction.openSearch)):(SitbReader.SearchWidget.slideUp(),SitbReader.RefTag.post(SitbReader.RefTag.Actions.panel,SitbReader.RefTag.PanelAction.closeSearch))},closeCurrentSearch:function(){SitbReader.currentSearch=new SitbReader.Search;SitbReader.SearchWidget.clearResults();SitbReader.ReaderWidget.setSearchTurnersDisplay(!1);
SitbReader.SearchWidget.showSampleSearches();SitbReader.PageSequenceWidget.redraw()},loadFirstQueryResults:function(a){if(a&&a!={}){if(SitbReader.currentSearch.update(a),SitbReader.SearchActions.loadSearchResults(a),SitbReader.currentSearch.totalResultsPages=Math.ceil(SitbReader.currentSearch.numResults/SITB_READER_SEARCH_FETCH_NUMBER_NEXT),SitbReader.currentSearch.currentResultsPage=SITB_READER_SEARCH_FETCH_NUMBER_FIRST/SITB_READER_SEARCH_FETCH_NUMBER_NEXT,SitbReader.ReaderWidget.setSearchTurnersDisplay(SitbReader.currentSearch.numResults>
0),SitbReader.PageSequenceWidget.redraw(),SitbReader.BookmarksWidget.slideUp(),SitbReader.SearchWidget.hideSampleSearches(),SitbReader.SearchWidget.showResults(!0),SitbReader.SearchWidget.addMoreResultsLink(),SitbReader.SearchWidget.hookTooltips(),SitbReader.currentSearch.numResults==0){SitbReader.SearchWidget.showSampleSearches();return}}else SitbReader.SearchWidget.hideLoading();a=SitbReader.currentSearch.getFirstAvailablePageNumber();a!=null&&SitbReader.PageSequenceActions.goTo(a);SitbReader.ReaderWidget.updateSearchTurnersState();
SitbReader.metrics.endTimer("search")},loadSearchResults:function(a){var b=SitbReader.PageSequenceActions,c;for(c in a.results)b.installToken(a.results[c][0],a.results[c][3]);b.setPageUrls(a)},loadMoreQueryResults:function(a){a.results&&a.results.length>0&&(SitbReader.currentSearch.currentResultsPage++,SitbReader.currentSearch.update(a),SitbReader.SearchActions.loadSearchResults(a),SitbReader.SearchWidget.showResults(!1),SitbReader.SearchWidget.addMoreResultsLink(),SitbReader.SearchWidget.hookTooltips());
SitbReader.metrics.endTimer("moreSearch")},searchCall:function(a,b){sitbReaderAjaxCall({method:"getSearchResults",asin:SitbReader.currentBook.asin,buyingAsin:SitbReader.currentBook.buyingAsin,query:encodeURIComponent(SitbReader.currentSearch.currentQuery),pageSize:SitbReader.currentSearch.fetchNumber,pageNumber:SitbReader.currentSearch.currentResultsPage+1},a,SitbReader.SearchActions.searchErrorCallback,b)},searchErrorCallback:function(a,b){SitbReader.metrics.count("ajaxerrors","searchajaxerrors");
b=="timeout"&&SitbReader.metrics.count("ajaxtimeouts","searchajaxtimeouts");SitbReader.SearchWidget.hideLoading();SitbReader.ReaderActions.showAjaxErrorMessage();SitbReader.RefTag.post(SitbReader.RefTag.Actions.timeout,SitbReader.RefTag.Timeout.search)}};
SitbReader.ReaderActions={oldMouseX:-1,oldMouseY:-1,currentScrollX:-1,currentScrollY:-1,nextPageUrl:"",LIGHTBOX_CLEAR_SPACE:30,isPanningSet:!1,setPageTurners:function(){SitbReader.ReaderWidget.setPageTurnersDisplay(!0);SitbReader.ReaderWidget.updatePageTurnersState();SitbReader.ReaderWidget.updateSearchTurnersState()},goToNextPage:function(){SitbReader.PageSequenceActions.next();SitbReader.RefTag.post(SitbReader.RefTag.Actions.next,SitbReader.RefTag.tokenizeLandingPage(SitbReader.pageSequence.getCurrentBookmarkName()));
SitbReader.metrics.count("next")},goToPrevPage:function(){SitbReader.PageSequenceActions.prev();SitbReader.RefTag.post(SitbReader.RefTag.Actions.previous,SitbReader.RefTag.tokenizeLandingPage(SitbReader.pageSequence.getCurrentBookmarkName()));SitbReader.metrics.count("prev")},updatePageImageOnResize:function(){SitbReader.ZoomModel.isFitPageZoomLevel()&&this.showPageImage(SitbReader.currentBook.pages[SitbReader.pageSequence.currentPage])},enablePanningControl:function(){if(!SitbReader.ReaderActions.isPanningSet)jQuery("#sitbReaderPageScroll").unbind("mousedown").mouseover(function(){jQuery("#sitbReaderPageScroll").css("cursor",
"url("+SITB_READER_PANNING_HAND_OPEN+"), default")}).mouseout(function(){jQuery("#sitbReaderPageScroll").css("cursor","default").unbind("mousemove")}).mousedown(function(a){jQuery(document).css("cursor","url("+SITB_READER_PANNING_HAND_CLOSED+"), default");jQuery("#sitbReaderPageScroll").css("cursor","url("+SITB_READER_PANNING_HAND_CLOSED+"), default");sitbReaderStopEvent(a);var b=SitbReader.ReaderActions;b.oldMouseX=a.pageX;b.oldMouseY=a.pageY;b.currentScrollX=jQuery("#sitbReaderPageContainer").scrollLeft();
b.currentScrollY=jQuery("#sitbReaderPageContainer").scrollTop();jQuery("#sitbReaderPageScroll").css("cursor","url("+SITB_READER_PANNING_HAND_CLOSED+"), default");jQuery(this).mousemove(function(a){SitbReader.metrics.startTimer("panning");sitbReaderStopEvent(a);var b=SitbReader.ReaderActions,e=b.currentScrollX-(a.pageX-b.oldMouseX),a=b.currentScrollY-(a.pageY-b.oldMouseY);jQuery("#sitbReaderPageContainer").scrollLeft(Math.max(0,e));jQuery("#sitbReaderPageContainer").scrollTop(Math.max(0,a));SitbReader.metrics.endTimer("panning");
jQuery(document).css("cursor","default");return!1}).mouseup(function(){jQuery("#sitbReaderPageScroll").unbind("mousemove").css("cursor","url("+SITB_READER_PANNING_HAND_OPEN+"), default")})}),SitbReader.ReaderActions.isPanningSet=!0},disablePanningControl:function(){if(SitbReader.ReaderActions.isPanningSet)jQuery("body").css("cursor","default"),jQuery("#sitbReaderPageScroll").unbind(),SitbReader.ReaderActions.isPanningSet=!1},setPanning:function(){var a=jQuery("#sitbReaderPageScroll").width(),b=jQuery("#sitbReaderPageContainer").width(),
c=jQuery("#sitbReaderPageScroll").height(),d=jQuery("#sitbReaderPageContainer").height();a>b-SITB_READER_SCROLLBAR_WIDTH||c>d?this.enablePanningControl():(this.disablePanningControl(),jQuery("#sitbReaderPageScroll").unbind("mousedown"),jQuery("#sitbReaderPageScroll").mousedown(function(a){sitbReaderStopEvent(a)}))},checkAndHandleError:function(a){if(a=={}||a.error){if(!a.error)a.error={};SitbReader.ErrorMessageWidget.show(sitbReadDhandlerMsg(a.error.title),sitbReadDhandlerMsg(a.error.text));SitbReader.RefTag.httpGet(a.error.reftag);
return!0}else return!1},checkForError:function(a){if(a=={}||a.error){if(!a.error)a.error={};SitbReader.RefTag.httpGet(a.error.reftag);return!0}else return!1},showAjaxErrorMessage:function(a,b){a||(a=SITB_READER_DEFAULT_ERROR_MSG_HEADER);b||(b=SITB_READER_DEFAULT_ERROR_MSG_TEXT);SitbReader.ErrorMessageWidget.show(a,b);SitbReader.SearchWidget.hideLoading()}};
SitbReader.ReaderKeyboardActions={SINGLE_ACTIONS:[SITB_READER_KEY_CODES.END,SITB_READER_KEY_CODES.PLUS1,SITB_READER_KEY_CODES.PLUS2,SITB_READER_KEY_CODES.PLUS3,SITB_READER_KEY_CODES.MINUS1,SITB_READER_KEY_CODES.MINUS2,SITB_READER_KEY_CODES.MINUS3,SITB_READER_KEY_CODES.ZERO,SITB_READER_KEY_CODES.ZERO_NUM,SITB_READER_KEY_CODES.HOME],REPEATED_ACTIONS:[SITB_READER_KEY_CODES.SPACE,SITB_READER_KEY_CODES.LEFT,SITB_READER_KEY_CODES.RIGHT,SITB_READER_KEY_CODES.UP,SITB_READER_KEY_CODES.DOWN,SITB_READER_KEY_CODES.PGUP,
SITB_READER_KEY_CODES.PGDOWN],SCROLL_LINE_HEIGHT:function(){return SitbReader.currentBook.isPrint()?20:SitbReader.ZoomModel.getLineHeight()/2},TIMER_TICK:80,_activeTimers:[],isKeyHandler:!0,_handleKeyPress:function(a){var b=SitbReader.ReaderKeyboardActions,c=a.which==0?a.keyCode:a.which;jQuery.inArray(c,SITB_READER_SUPPORTED_KEY_CODE_VALUES)>=0&&b.isKeyHandler&&(sitbReaderStopEvent(a),jQuery.inArray(c,b.REPEATED_ACTIONS)>=0&&sitbReaderIsFF&&(SitbReader.metrics.count("keystroke"),b._getRepeatedAction(c).call()))},
_handleKeyDown:function(a){var b=SitbReader.ReaderKeyboardActions,c=a.which==0?a.keyCode:a.which;jQuery.inArray(c,SITB_READER_SUPPORTED_KEY_CODE_VALUES)>=0&&b.isKeyHandler&&(sitbReaderStopEvent(a),jQuery.inArray(c,b.REPEATED_ACTIONS)>=0&&sitbReaderIsIE&&!b._activeTimers["timer_"+c]&&(b._activeTimers["timer_"+c]=setInterval(b._getRepeatedAction(c),b.TIMER_TICK)))},_handleKeyUp:function(a){var b=SitbReader.ReaderKeyboardActions,c=a.which==0?a.keyCode:a.which;jQuery.inArray(c,SITB_READER_SUPPORTED_KEY_CODE_VALUES)>=
0&&b.isKeyHandler&&(sitbReaderStopEvent(a),jQuery.inArray(c,b.REPEATED_ACTIONS)>=0&&!sitbReaderIsFF&&!sitbReaderIsIE&&b._getRepeatedAction(c).call(),jQuery.inArray(c,b.REPEATED_ACTIONS)>=0&&sitbReaderIsIE?(clearInterval(b._activeTimers["timer_"+c]),delete b._activeTimers["timer_"+c]):jQuery.inArray(c,b.SINGLE_ACTIONS)>=0&&b._handleSingleAction(c,a.ctrlKey))},_handleSingleAction:function(a,b){switch(a){case SITB_READER_KEY_CODES.HOME:SitbReader.currentBook.isPrint()?SitbReader.PageSequenceActions.goTo(1):
SitbReader.KindleContentActions.goToSRL();break;case SITB_READER_KEY_CODES.END:jQuery("#sitbReaderPageContainer").scrollTop(SitbReader.pageSequence.scrollHeight);break;case SITB_READER_KEY_CODES.PLUS1:case SITB_READER_KEY_CODES.PLUS2:case SITB_READER_KEY_CODES.PLUS3:b&&SitbReader.ZoomActions.zoomIn();break;case SITB_READER_KEY_CODES.MINUS1:case SITB_READER_KEY_CODES.MINUS2:case SITB_READER_KEY_CODES.MINUS3:b&&!sitbReaderIsIE&&SitbReader.ZoomActions.zoomOut();break;case SITB_READER_KEY_CODES.ZERO:case SITB_READER_KEY_CODES.ZERO_NUM:b&&
!sitbReaderIsIE&&(SitbReader.ZoomActions.setZoom(SitbReader.ZoomModel.DEFAULT_ZOOM_FOR_LARGE_IMG),SitbReader.ZoomWidget.setZoomControls())}},_getRepeatedAction:function(a){var b=void 0;switch(a){case SITB_READER_KEY_CODES.SPACE:b=function(){SitbReader.PageSequenceActions.next()};break;case SITB_READER_KEY_CODES.RIGHT:b=function(){SitbReader.PageSequenceActions.next()};break;case SITB_READER_KEY_CODES.LEFT:b=function(){SitbReader.PageSequenceActions.prev()};break;case SITB_READER_KEY_CODES.UP:b=function(){SitbReader.ReaderKeyboardActions._scrollByArrow(-1)};
break;case SITB_READER_KEY_CODES.DOWN:b=function(){SitbReader.ReaderKeyboardActions._scrollByArrow(1)};break;case SITB_READER_KEY_CODES.PGUP:b=function(){SitbReader.PageSequenceActions.prev()};break;case SITB_READER_KEY_CODES.PGDOWN:b=function(){SitbReader.PageSequenceActions.next()}}return b},_scrollByArrow:function(a){var b=jQuery("#sitbReaderPageContainer"),c=b.scrollTop(),d=SitbReader.ReaderKeyboardActions.SCROLL_LINE_HEIGHT(),e=SitbReader.pageSequence.scrollHeight;a<0&&(c==0||c-d<0)?b.scrollTop(0):
a>0&&(c==e||c+d>e)?b.scrollTop(e):b.scrollTop(c+d*a)},load:function(){SITB_READER_IS_TOUCH_SUPPORTED||(jQuery(document).unbind("keydown").keydown(this._handleKeyDown),jQuery(document).unbind("keyup").keyup(this._handleKeyUp),jQuery(document).unbind("keypress").keypress(this._handleKeyPress))},tearDown:function(){jQuery(document).unbind("keydown");jQuery(document).unbind("keyup");jQuery(document).unbind("keypress")}};
SitbReader.ZoomActions={getPageImageForZoomLevel:function(a){var b=SitbReader.ZoomModel,b=b.isLargeImageZoomLevel(b.zoomLevel)?a.largeImage:a.jumboImage,b=jQuery(b);b.css({width:a.getScaledDimensions().width,height:a.getScaledDimensions().height});return b},updateFitToScreenZoomLevel:function(a){this.updateFitToScreenByDimension(a.getScaledDimensions())},updateFitToScreenByDimension:function(a){var b=SitbReader.ZoomModel,c=SitbReader.ReaderWidget.getImageHeight();if(c<a.height)var d=c/a.height,d=
Math.min(c/a.height,1),a=a.width*d;else a=a.width;c=jQuery("#sitbReaderPageContainer").width()-SITB_READER_SCROLLBAR_WIDTH;c=Math.min(c,b.MAX_PAGE_WIDTH_FOR_PAGE_FIT);a=Math.min(a,c);b.setFitPageZoomLevel(a);b.updateMinZoomLevel()},isFitToHeightPage:function(a){a=SitbReader.currentBook.bookmarks.getIndex(a);return a!=null?(a=SitbReader.currentBook.bookmarks.getName(a),a.indexOf(sitbReaderGetString("BACK_COVER"))>-1||a.indexOf(sitbReaderGetString("FRONT_COVER"))>-1||a.indexOf(sitbReaderGetString("BACK_FLAP"))>
-1||a.indexOf(sitbReaderGetString("FRONT_FLAP"))>-1):!1},zoomIn:function(){var a=SitbReader.ZoomModel.zoomLevel+1,b=SitbReader.ZoomModel.zoomLevel;SitbReader.ZoomActions._doSetZoom(a);SitbReader.ZoomWidget.setZoomControls();SitbReader.ZoomModel.zoomLevel!=b&&SitbReader.RefTag.post(SitbReader.RefTag.Actions.zoomIn,a);SitbReader.ReaderWidget.setWidth()},zoomOut:function(){var a=SitbReader.ZoomModel.zoomLevel-1,b=SitbReader.ZoomModel.zoomLevel;SitbReader.ZoomActions._doSetZoom(a);SitbReader.ZoomWidget.setZoomControls();
SitbReader.ZoomModel.zoomLevel!=b&&SitbReader.RefTag.post(SitbReader.RefTag.Actions.zoomOut,a);SitbReader.MessageWidget.resize();SitbReader.ReaderWidget.setWidth()},setZoom:function(a){SitbReader.ZoomActions._doSetZoom(a);SitbReader.RefTag.post(SitbReader.RefTag.Actions.zoom,a)},_doSetZoom:function(a){var b=SitbReader.ZoomModel;if(b.isValidZoomLevel(a))b.userDefinedZoomLevel=!0,b.updatePreviousZoomLevel(),b.zoomLevel=a,SitbReader.currentBook.isPrint()?SitbReader.PageSequenceActions.zoom(a):SitbReader.KindleContentActions.zoom();
SitbReader.ReaderWidget.updateVerticalScroller()}};
SitbReader.FeedbackActions={submitFeedback:function(){jQuery(".sitbReaderFeedbackMenu-loading").show();SitbReader.FeedbackWidget.disableFeedbackButtons();sitbReaderAjaxCall({method:"sendFeedback",asin:SitbReader.currentBook.asin,feedback:this.getFormattedFeedbackString()},SitbReader.FeedbackActions.submitFeedbackCallback)},submitFeedbackCallback:function(a){jQuery(".sitbReaderFeedbackMenu-loading").hide();SitbReader.ReaderActions.checkAndHandleError(a)||(jQuery(".sitbReaderFeedbackMenu-thanks").show(),
setTimeout("SitbReader.FeedbackWidget.resetForm();",2E3))},getFormattedFeedbackString:function(){var a="BROWSER RESOLUTION: "+jQuery(window).height()+"H x "+jQuery(window).width()+"W\nPAGE SEQ#: "+getCurrentPageSequenceNumber()+" ("+SitbReader.pageSequence.currentPage+")\n";a+="---------------\n";var b=jQuery("#sitbReaderFeedbackMenu-recommendations").val();a+="LIKELY TO RECOMMEND: ["+(b==0?"N/A":SitbReader.FeedbackWidget.recommendationOptions[b])+"]\n";a+="FEEDBACK TYPE: ["+jQuery("#sitbReaderFeedbackMenu-type").val()+
"]\n";a+="---------------\n";b=jQuery(".sitbReaderFeedbackMenu-textarea").val().substring(0,SitbReader.FeedbackWidget.textAreaMaxLength);if(sitbReaderIsBlank(b)||b==SitbReader.FeedbackWidget.textAreaDefaultText)b="N/A";a+="COMMENTS: ["+b+"]\n";return a}};
SitbReader.MessageActions={sendReftag:function(a,b){a&&!SitbReader.MessageWidget.reftagsFired[b]&&(SitbReader.RefTag.post(SitbReader.RefTag.Actions.message,b),SitbReader.MessageWidget.reftagsFired[b]=!0)},getRelatedEditionMessage:function(){var a=SitbReader.currentBook,b=a.getRelatedAsin();b&&sitbReaderAjaxCall({method:"getRelatedEdition",asin:a.originalAsin?a.buyingAsin:b,buyingAsin:a.originalAsin?b:a.buyingAsin,xref:a.originalAsin?1:0},SitbReader.MessageActions.getRelEdMsgCallBack,function(b,d){sitbReaderAjaxErrorMetricLog(d,
SitbReader.RefTag.Timeout.relatedEdition);if(a.originalAsin)if(a.originalAsin&&a.isPrint())SitbReader.Message.relatedEditionMessage=SITB_READER_DEFAULT_RELATED_EDITION_XREF_PRINT_MSG;else{if(a.originalAsin&&a.isHTML())SitbReader.Message.relatedEditionMessage=SITB_READER_DEFAULT_RELATED_EDITION_XREF_KINDLE_MSG}else SitbReader.Message.relatedEditionMessage=SITB_READER_DEFAULT_RELATED_EDITION_MSG;SitbReader.MessageWidget.calledShow&&SitbReader.MessageWidget.show()})},getRelEdMsgCallBack:function(a){a=
a.relatedEditionMessage;if(a.key&&a.args){var b={};b.RELATED_YEAR_DISP=sitbReaderIsBlank(a.args.RELATED_YEAR)?"":" ("+a.args.RELATED_YEAR+")";b.RELATED_LINK_TEXT=sitbReaderIsBlank(a.args.RELATED_NAME)?sitbReaderGetString("RELATED_EDITION"):sitbReaderGetString("EDITION_NAME",{NAME:a.args.RELATED_NAME.replace(sitbReaderGetString("EDITION"),"").replace(/^\s+|\s+$/g,"")});b.RELATED_PUB_DISP=sitbReaderIsBlank(a.args.RELATED_PUB)?"":sitbReaderGetString("PUB_NAME",{NAME:a.args.RELATED_PUB});b.AUTHORITY_YEAR_DISP=
sitbReaderIsBlank(a.args.AUTHORITY_YEAR)?"":" ("+a.args.AUTHORITY_YEAR+")";b.AUTHORITY_LINK_TEXT=sitbReaderIsBlank(a.args.AUTHORITY_NAME)?sitbReaderGetString("AUTHORITY_EDITION"):sitbReaderGetString("EDITION_NAME",{NAME:a.args.AUTHORITY_NAME.replace(sitbReaderGetString("EDITION"),"").replace(/^\s+|\s+$/g,"")});b.AUTHORITY_PUB_DISP=sitbReaderIsBlank(a.args.AUTHORITY_PUB)?"":sitbReaderGetString("PUB_NAME",{NAME:a.args.AUTHORITY_PUB});b.AUTHORITY_LINK=a.args.AUTHORITY_LINK.replace("#{AUTHORITY_LINK_TEXT}",
b.AUTHORITY_LINK_TEXT);b.RELATED_LINK=a.args.RELATED_LINK.replace("#{RELATED_LINK_TEXT}",b.RELATED_LINK_TEXT);a.key+=SitbReader.currentBook.isPrint()?"_PRINT":"_KINDLE";SitbReader.Message.relatedEditionMessage=sitbReaderGetString(a.key,b);SitbReader.MessageWidget.calledShow&&SitbReader.MessageWidget.show()}}};
SitbReader.MessageBoxActions={toggleMessageBox:function(a,b){if(SitbReader.MessageBoxWidget.messageBoxDisplayed.messageBoxType!=a){SitbReader.MessageBoxWidget.close();var c=new SitbReader.MessageBox(a,b);SitbReader.MessageBoxWidget.show(c,b)}else SitbReader.MessageBoxWidget.close()}};
SitbReader.SBActions={isLoading:!1,loadSBDataCall:function(a,b){if(!SitbReader.SBActions.isLoading)SitbReader.SBActions.isLoading=!0,SitbReader.SerendipityBar.historyBooks.length||sitbReaderAjaxCall({method:"getSBData",asin:SitbReader.currentBook.buyingAsin,type:SitbReader.currentBook.type},a,SitbReader.SBActions.errorCallback,b)},errorCallback:function(a,b){sitbReaderAjaxErrorMetricLog(b,SitbReader.RefTag.Timeout.serendipityBar);SitbReader.SBWidget.hideLoading();SitbReader.SBWidget.historyLoadFailure();
SitbReader.SBWidget.noSims();jQuery("#sitbReaderSB #historyholder").height(8);SitbReader.metrics.endTimer("SBshow")},toggleHistoryPane:function(){SitbReader.metrics.startTimer("SBtogglehistory");jQuery("#sitbReaderSB-history-content").is(":hidden")?SitbReader.SBWidget.historySlideDown():SitbReader.SBWidget.historySlideUp();SitbReader.metrics.endTimer("SBtogglehistory")},toggleRecsPane:function(){SitbReader.metrics.startTimer("SBtogglesims");jQuery("#sitbReaderSB-recs-content").is(":hidden")?SitbReader.SBWidget.recsSlideDown():
SitbReader.SBWidget.recsSlideUp();SitbReader.metrics.endTimer("SBtogglesims")}};
SitbReader.PageSequenceActions={reset:function(){var a=SitbReader.pageSequence;if(typeof a!="undefined")a.emptyScroll(),a.scrollHeight=0,a.visibleElementIndices=[]},setPageUrls:function(a){var b=SitbReader.currentBook.pages;if(a.largeImageUrls&&a.jumboImageUrls)for(var c in a.largeImageUrls)c>0&&c<=b.length-1&&(b[c].addUrls(a.largeImageUrls[c],a.jumboImageUrls[c]),b[c].setState(SITB_READER_PG_STATE.C)&&SitbReader.availability.handleNumRemPages(c))},next:function(){if(SitbReader.currentBook.isPrint())this.goTo(SitbReader.availability.getNextAvailablePageNumber(SitbReader.pageSequence.currentPage,
1),1);else{var a=jQuery("#sitbReaderPageContainer"),b=SitbReader.ZoomModel.getLineHeight(),b=Math.min(parseInt(a.scrollTop()+a.height()-b),SitbReader.pageSequence.scrollHeight);a.scrollTop(b)}},prev:function(){if(SitbReader.currentBook.isPrint())this.goTo(SitbReader.availability.getNextAvailablePageNumber(SitbReader.pageSequence.currentPage,-1),-1);else{var a=jQuery("#sitbReaderPageContainer"),b=SitbReader.ZoomModel.getLineHeight(),b=Math.max(a.scrollTop()-a.height()+b,0);a.scrollTop(b)}},goTo:function(a,
b){var c=SitbReader.PageSequenceWidget;c.goToStartTime=c.goToStartTime==-1?0:(new Date).getTime();c.immediateScroll=!0;c.scrollToPageTop(a,b)},zoom:function(){var a=SitbReader.pageSequence.currentPage;SitbReader.PageSequenceWidget.redraw();this.goTo(a)},loadPageUrls:function(a,b){SitbReader.availability.canRequestImages(a.pageNumber)&&sitbReaderAjaxCall({method:"goToPage",asin:SitbReader.currentBook.asin,buyingAsin:SitbReader.currentBook.buyingAsin,page:a.pageNumber,token:a.token},function(c){if(SitbReader.currentBook.isPrint())c.error?
SitbReader.availability.handlePageLoadError(a):(SitbReader.PageSequenceActions.urlCallback(c,b),SitbReader.availability.pageErrorCount=0),SitbReader.availability.updatePageStates()},function(b,d){sitbReaderAjaxPageNavErrorMetricLog(d,SitbReader.RefTag.Timeout.pageUrls);SitbReader.availability.handlePageLoadError(a)})},urlCallback:function(a,b){this.setPageUrls(a);b.call()},addTOCLinks:function(a){for(var b in a)this.installToken(a[b].dest,a[b].token)},installToken:function(a,b){if(SitbReader.availability.level<
1||SitbReader.availability.numRemPages<=0)return!1;for(var c=SitbReader.currentBook.pages,d=!1,a=parseInt(a),e=Math.max(a-2,1);e<=Math.min(a+2,SitbReader.currentBook.numPages);e++)c[e].token=b,c[e].state!=SITB_READER_PG_STATE.C&&(d|=c[e].setState(SITB_READER_PG_STATE.Q));return d},getRandomAvailablePageNumber:function(){for(var a=SitbReader.currentBook.pages,b=1,c=0,d=1;d<=SitbReader.currentBook.numPages;d++)a[d].isC()&&(c++,Math.random()<1/c&&(b=d));return b},goToRandomPage:function(a){!SitbReader.currentBook.searchable||
a||SitbReader.availability.level!=2||SitbReader.availability.numRemPages<=0?(this.goTo(this.getRandomAvailablePageNumber()),!SitbReader.currentBook.hasFullAccess&&SitbReader.availability.level==0&&SitbReader.MessageWidget.displayRandomPageLoginMessage(),SitbReader.RefTag.post(SitbReader.RefTag.Actions.samplePage,SitbReader.RefTag.LandingPage.excerpt)):sitbReaderAjaxCall({method:"getRandomPage",asin:SitbReader.currentBook.asin,buyingAsin:SitbReader.currentBook.buyingAsin},this.goToRandomPageCallBack,
function(){SitbReader.PageSequenceActions.goToRandomPage(!0)})},goToRandomPageCallBack:function(a){a.error?SitbReader.PageSequenceActions.goToRandomPage(!0):(SitbReader.PageSequenceActions.setPageUrls(a),SitbReader.PageSequenceActions.installToken(a.pageNumber,a.token),SitbReader.PageSequenceActions.goTo(a.pageNumber))}};
SitbReader.ClickableTOCActions={loadTOCallMade:{},loadTOCDataCall:function(a,b,c){this.loadTOCallMade[a]||(this.loadTOCallMade[a]=!0,sitbReaderAjaxCall({method:"getTOCLinks",asin:SitbReader.currentBook.asin,page:a},b,SitbReader.ClickableTOCActions.errorCallback,c))},errorCallback:function(a,b){SitbReader.metrics&&sitbReaderAjaxErrorMetricLog(b,SitbReader.RefTag.Timeout.toc)},preCachePage:function(a){SitbReader.ClickableTOCActions.loadTOCDataCall(a,SitbReader.ClickableTOCActions.storePageFromData)},
storePageFromData:function(a){a!=null&&SitbReader.ClickableTOC.addPage(a.page,a.links)},storeAndShow:function(a){a!=null&&(SitbReader.ClickableTOC.addPage(a.page,a.links),SitbReader.ReaderWidget.renderPageOverlay(a.page))},goToPage:function(a){SitbReader.ClickableTOC.visitedPages[a]=!0;SitbReader.PageSequenceActions.goTo(a);SitbReader.RefTag.post(SitbReader.RefTag.Actions.clickToc)}};
SitbReader.Availability=function(a){this.level=a.level;this.numRemPages=a.numRemPages?a.numRemPages:0;this.pageErrorCount=0;this.isFPS=a.isFPS=="1";this.maxConsecPages=5;this.PAGE_ERROR_COUNT_THRESHOLD=3;this.skipPagesProbabilities={1:60,2:20,3:20};this.consecPagesProbabilities={4:20,5:80};this.minimumTextLitbPages=6;this.irreversibleXPages=[]};
SitbReader.Availability.prototype.getNextAvailablePageNumber=function(a,b,c){typeof c=="undefined"&&(c=!1);var d=SitbReader.currentBook.pages,e=a;do if(b>0?e++:e--,e>SitbReader.currentBook.numPages&&(e=1),e<=0)e=SitbReader.currentBook.numPages;while((c?!d[e].isC():d[e].isX()||d[e].isY())&&e!=a);return e};
SitbReader.Availability.prototype.updatePageStates=function(){if(!(this.level<2||this.isT2NonFPS())){var a=SitbReader.currentBook,b=SitbReader.pageSequence.currentPage;if(a.inTextPages(b)&&!a.bookmarks.isInABookmark(b)){for(var c=b;c>a.st&&a.pages[c].isC();)c--;for(c-1>=1&&c-1>=a.st&&c--;b<=a.getLastTextPage()&&a.pages[b].isC();)b++;b+1<=a.getLastTextPage()&&b++;b=Math.min(b,a.pages.length-1);return b-c<=this.maxConsecPages?void 0:this.updatePageStatesHelper(c,b,1)|this.updatePageStatesHelper(b,c,
-1)}}};SitbReader.Availability.prototype.updatePageStatesHelper=function(a,b,c){if(!(a>b&&c>0||a<b&&c<0||c==0)){for(var d=SitbReader.currentBook,e=0,f=!1;a<=b&&c>0||a>b&&c<0;a+=c)!d.pages[a].isC()||d.bookmarks.isInABookmark(a)?e=0:(e++,e>=this.maxConsecPages&&(d.pages[a+c]&&!d.pages[a+c].isX()&&(d.pages[a+c].setState(SITB_READER_PG_STATE.X),f=!0),e=0));return f}};
SitbReader.Availability.prototype.handlePageLoadError=function(a){this.pageErrorCount++;a.setState(SITB_READER_PG_STATE.X);if(this.pageErrorCount>=this.PAGE_ERROR_COUNT_THRESHOLD)SitbReader.metrics.count("page_error_threshold"),this.collapseNonCPages(a.pageNumber),this.pageErrorCount=0};
SitbReader.Availability.prototype.collapseNonCPages=function(a){for(var b=SitbReader.currentBook,c=b.pages,d=a;d>=1&&!c[d].isC();)c[d--].setState(SITB_READER_PG_STATE.X);for(d=a;d>=1&&d<=b.numPages&&!c[d].isC();)c[d++].setState(SITB_READER_PG_STATE.X);return d};SitbReader.Availability.prototype.collapseAllNonCPages=function(){for(var a=SitbReader.currentBook.pages,b=!1,c=1;c<a.length;c++)a[c].isC()||(b|=a[c].setState(SITB_READER_PG_STATE.X));return b};
SitbReader.Availability.prototype.isT2NonFPS=function(){return this.level==2&&!this.isFPS};SitbReader.Availability.prototype.handleNumRemPages=function(a){var a=parseInt(a),b=SitbReader.currentBook;this.numRemPages<=0||this.level<1||!b.inTextPages(a)||jQuery.inArray(a,b.litbPages)>=0||(this.numRemPages--,this.numRemPages<=0&&this.collapseAllNonCPages())};
SitbReader.Availability.prototype.canRequestImages=function(a){var b=SitbReader.currentBook.pages[a];return b.isC()&&(sitbReaderIsBlank(b.largeUrl)||sitbReaderIsBlank(b.jumboUrl))||b.isQ()&&(this.isFPS||!SitbReader.currentBook.inTextPages(a)||!sitbReaderIsBlank(b.token))};SitbReader.Availability.prototype.getSkipPagesNumber=function(){return sitbReaderGetWeightedNumber(this.skipPagesProbabilities)};SitbReader.Availability.prototype.getConsecPagesNumber=function(){return sitbReaderGetWeightedNumber(this.consecPagesProbabilities)};
SitbReader.ModeSwitchActions={pathCache:[],_storePath:function(a,b){this.pathCache[a]=b},switchMode:function(a,b){var c=SitbReader.currentBook,d=SitbReader.pageSequence;b!=c.type&&(b==SITB_READER_BOOK_TYPE.PRINT?SitbReader.metrics.startTimer("ModeSwitchToPrint"):SitbReader.metrics.startTimer("ModeSwitchToKindle"),SitbReader.ReaderWidget.setPageTurnersDisplay(!1),SitbReader.ReaderWidget.setSearchTurnersDisplay(!1),SitbReader.MessageWidget.close(),SitbReader.LightboxWidget.showLoadingLightboxMessage(),
SitbReader.BookmarksWidget.slideDown(),c.type==SITB_READER_BOOK_TYPE.PRINT?d.putReadingLocation(c.buyingAsin,d.currentPage):d.putReadingLocation(c.buyingAsin,jQuery("#sitbReaderPageContainer").scrollTop()),this._storePath(a,c.buyingAsin),Vellum.p(a,d.getReadingLocation(a,b)),b==SITB_READER_BOOK_TYPE.PRINT?SitbReader.metrics.endTimer("ModeSwitchToPrint"):SitbReader.metrics.endTimer("ModeSwitchToKindle"),SitbReader.RefTag.post(SitbReader.RefTag.Actions.mode,b==SITB_READER_BOOK_TYPE.PRINT?"print":"kindle"))},
getPath:function(a){return this.pathCache[a]},hasPath:function(a){return!sitbReaderIsBlank(this.pathCache[a])}};SitbReader.BottomButtonActions={moveNextPage:function(){SitbReader.RefTag.post(SitbReader.RefTag.Actions.bottomButton);SitbReader.metrics.count("bottom_button");SitbReader.ReaderActions.goToNextPage()}};
SitbReader.KindleContentActions={_contentCache:{},_contentWidget:void 0,_contentHolder:void 0,_fetchKindleContent:function(a){if(this._contentCache[a]){var b=SitbReader.KindleContentActions;b._contentWidget.updateContent(this._contentCache[a].sample);b._contentHolder=b._contentWidget.jQContentHolder;b.zoom()}else SitbReader.metrics.startTimer("load_html_sample"),jQuery.ajax({url:SITB_READER_AJAX_URL,async:!0,type:"POST",data:{method:"getKindleSample",asin:SitbReader.currentBook.asin},cache:!1,dataType:"json",
timeout:SITB_READER_KINDLE_CONTENT_AJAX_TIMEOUT,error:SitbReader.KindleContentActions._fetchErrorCallback,success:SitbReader.KindleContentActions._fetchCallback})},_fetchCallback:function(a){a.error?(SitbReader.metrics.count("rc_failed"),SitbReader.ErrorMessageWidget.show(sitbReadDhandlerMsg(a.error.title),sitbReadDhandlerMsg(a.error.text)),a.sample="",a.stylesheet=""):a.sample?a.stylesheet?a.sample.length<SITB_READER_MINIMUM_KINDLE_SAMPLE_LENGTH&&(SitbReader.RefTag.post(SitbReader.RefTag.Actions.error,
SitbReader.RefTag.Error.empty_sample),SitbReader.metrics.count("empty_sample")):(a.stylesheet="",SitbReader.metrics.count("stylesheet_undefined")):(a.sample="",SitbReader.metrics.count("sample_undefined"));var b=document.createDocumentFragment(),c="<style id='sitbKindleFontStyle' type='text/css'>"+SitbReader.ZoomModel.getZoomFontSizes()+"</style>",d=jQuery(document.createElement("div"));d.attr("id","sitbReaderKindleSample");d.css("visibility","hidden");d[0].innerHTML=c+a.stylesheet+a.sample;c=jQuery(".sitb-k4w-sample-links",
d);c.size()>0?jQuery.each(c,function(a,b){var c=jQuery(b),d=c.attr("onclick").toString();d.indexOf("buyNow")!=-1?d="javascript:SitbReader.KindleContentActions.endOfSampleBuyLink()":d.indexOf("showDetails")!=-1&&(d="/kindle/dp/"+SitbReader.currentBook.buyingAsin+"/"+SitbReader.RefTag.getFormatedRefTag(SitbReader.RefTag.Actions.exit,SitbReader.RefTag.ExitMethod.endOfSampleMoreDetail));c.attr({"class":"sitb-buy-box",href:d,target:null}).removeAttr("onclick");c.parent().css("text-indent","0px")}):d.append(SitbReader.Message.getHtmlBuyMessage());
d.append("<div id='sitbReaderEndOfSample' />");b.appendChild(d[0]);SitbReader.metrics.endTimer("load_html_sample");d=SitbReader.KindleContentActions;d._cache(b,a.srl);d._contentWidget.updateContent(b);d._contentHolder=d._contentWidget.jQContentHolder},_fetchErrorCallback:function(a,b){sitbReaderAjaxErrorMetricLog(b,SitbReader.RefTag.Timeout.kindleSample);jQuery("#vellumMsgTxt").html(sitbReaderGetString("INFORMATION_UNAVAILABLE"));jQuery("#vellumMsgHdr").html(sitbReaderGetString("SERVER_TIMEOUT"));
centerJQueryObjectInWindow(jQuery("#vellumMsg")).show()},_cache:function(a,b){this._contentCache[SitbReader.currentBook.asin]={sample:a,toc:void 0,srl:b}},_registerSampleTOC:function(){var a=jQuery("a",this._contentHolder);jQuery.each(a,function(a,c){if(c.className.indexOf("sitb-filepos_src")!=-1){var d=c.href.split("#")[1],e=jQuery(c);c.href="javascript:void(0)";e.unbind("click").bind("click",{anchor:d},function(a){SitbReader.KindleContentActions.goToLocation(a.data.anchor,"name",!1)||jQuery("#sitbReaderPageContainer").scrollTop(SitbReader.KindleContentActions._contentHolder.height())})}else if((sitbReaderStartsWith(c.href,
"http:")||sitbReaderStartsWith(c.href,"https:"))&&c.className!=="sitb-buy-box")c.target="_new"})},initialize:function(a){this._contentWidget=a;this._fetchKindleContent(SitbReader.currentBook.asin)},registerEvents:function(){this._registerSampleTOC()},handleResize:function(){this._contentWidget.resize()},goToLocation:function(a,b,c){var c=void 0==c||null==c?!0:c,d=void 0;sitbReaderIsBlank(b)||b=="class"?d=jQuery("."+a):b=="name"&&(d=jQuery("a[name='"+a+"']"));if(d.length!=0)return a=jQuery("#sitbReaderPageContainer"),
a.scrollTop(jQuery(d[0]).position().top),!0;else if(d.length==0&&(a=="sitb-srl"||a=="sitb-cover")&&c)a=jQuery("#sitbReaderPageContainer"),a.scrollTop(0);return!1},goToSRL:function(){(!this._contentCache[SitbReader.currentBook.asin].srl||!this.goToLocation(this._contentCache[SitbReader.currentBook.asin].srl,"name",!1))&&this.goToLocation("sitb-srl","class",!0)},goToCover:function(){this.goToLocation("sitb-cover","class")},goToLRL:function(){var a=SitbReader.pageSequence.getReadingLocation(SitbReader.currentBook.buyingAsin,
SITB_READER_BOOK_TYPE.HTML);a=="srl"?this.goToSRL():jQuery("#sitbReaderPageContainer").scrollTop(parseInt(a));SitbReader.LightboxActions.readerReady=!0},zoom:function(){this._contentWidget.resize(!0)},endOfSampleBuyLink:function(){var a=jQuery("#sitbReaderCart-form");a.attr("action",SitbReader.currentBook.kindleBuyItURL+"/ref="+SitbReader.RefTag.getFormatedRefTag(SitbReader.RefTag.Actions.exit,SitbReader.RefTag.ExitMethod.endOfSampleBuyLink));a.submit()}};
SitbReader.CustomerRequestActions={sendRequest:function(){this._sendRequestLoadingIcon();var a="/gp/digital/fiona/detail/request-kindle-edition/ref="+SitbReader.RefTag.getFormatedRefTag(SitbReader.RefTag.Actions.sendCustomerRequest)+"?a="+SitbReader.currentBook.asin;jQuery.ajax({url:a,async:!0,type:"POST",data:null,cache:!1,timeout:SITB_READER_AJAX_TIMEOUT,error:SitbReader.CustomerRequestActions._sendRequestErrorCallback,success:SitbReader.CustomerRequestActions._sendRequestCallback})},_sendRequestErrorCallback:function(){jQuery("#sitbReaderCustomerRequestContent").html(sitbReaderGetString("SEND_CUSTOMER_REQUEST_ERROR"))},
_sendRequestCallback:function(){jQuery("#sitbReaderCustomerRequestContent").html(sitbReaderGetString("SEND_CUSTOMER_REQUEST_SUCCESS",{ASIN:SitbReader.currentBook.asin,TITLE:SitbReader.currentBook.title}))},_sendRequestLoadingIcon:function(){jQuery("#sitbReaderCustomerRequestContent").html('<div id="sitbReaderCustomerRequest-loading"></div>')}};
SitbReader.LightboxWidget={documentIsReady:!1,isFullscreen:!1,load:function(){this.lbBorders={};this.lbBorders.r=new SitbReader.BorderElement(SITB_READER_HORZ_SPRITE_URL,SITB_READER_BORDER_R,41,0,34,1,{right:16});this.lbBorders.l=new SitbReader.BorderElement(SITB_READER_HORZ_SPRITE_URL,SITB_READER_BORDER_L,6,0,34,1,{left:16});this.lbBorders.t=new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,SITB_READER_BORDER_T,0,140,1,34,{right:16,left:16});this.lbBorders.b=new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,
SITB_READER_BORDER_B,0,175,1,34,{right:16,left:16});this.lbBorders.tr=new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,SITB_READER_BORDER_TR,0,35,34,34,{right:16});this.lbBorders.tl=new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,SITB_READER_BORDER_TL,0,0,34,34,{left:16});this.lbBorders.br=new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,SITB_READER_BORDER_BR,0,105,34,34,{right:16});this.lbBorders.bl=new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,SITB_READER_BORDER_BL,
0,70,34,34,{left:16});jQuery("#sitbLBHeader,#sitbLBHeaderLC,#sitbLBHeaderRC").css("background-image","url("+SITB_READER_VERT_SPRITE_URL+")")},show:function(a){if(a&&this._isSmallScreen())this.isFullscreen=!0;this.setFullscreenText();a=this.getLightboxHeight();jQuery("#sitbLightbox").css({position:"absolute",top:this.getLightboxTop()+jQuery(window).scrollTop(),left:this.getLightboxLeft(),width:this.getLightboxWidth(),height:a});jQuery("#sitbReaderPageContainer").height(a+8);this.updateBorder()},toggleFullscreen:function(){this.isFullscreen=
!this.isFullscreen;SITB_READER_MAX_WIDTH=jQuery(document).width()-2*this.getLightboxLeft()-15;SitbReader.LightboxActions.handleResize();this.setFullscreenText();this.isFullscreen?SitbReader.RefTag.post(SitbReader.RefTag.Actions.fullscreenView):SitbReader.RefTag.post(SitbReader.RefTag.Actions.standardView)},setFullscreenText:function(){var a=this.isFullscreen?SITB_READER_IN_FULLSCREEN_TEXT:SITB_READER_IN_STANDARDVIEW_TEXT;jQuery("#sitbReaderFullscreenLink").text(a)},setWidth:function(){var a=jQuery("#sitbLightbox").width(),
b=this.getLightboxWidth();b!=a&&(jQuery("#sitbLightbox").width(b),this.updateBorder());SitbReader.ReaderWidget.setWidth()},updateBorder:function(){SitbReader.Border.applyBorderSet("#sitbLightbox","slbborder",this.lbBorders)},toggleSelextBoxes:function(a){if(sitbReaderIsIE6)for(var b=document.documentElement.getElementsByTagName("select"),a=a?"visible":"hidden",c=0;c<b.length;c++)b[c].style.visibility=a},resizeShade:function(){var a=SITB_READER_IS_TOUCH_SUPPORTED?jQuery(document):jQuery(window);jQuery("#vellumShade").css({display:"block",
left:0,top:a.scrollTop(),height:a.height(),width:a.width()})},dimTheLights:function(){SitbReader.LightboxWidget.resizeShade();SitbReader.LightboxWidget.showLoadingLightboxMessage()},removeOverlay:function(){jQuery("#vellumShade").hide()},handleMouseScroll:function(a){window.scrollBy(0,a.detail*12)},centerDiv:function(a,b){var c=jQuery(a),d=jQuery(b),e=parseInt(d.css("left"));e-=SITB_READER_SCROLLBAR_WIDTH;e=d.width()/2-c.width()/2+e;d=d.height()/2-c.height()/2;c.css("left",e);c.css("top",d)},showLoadingLightboxMessage:function(){centerJQueryObjectInWindow(jQuery("#vellumLdgIco")).show()},
_isSmallScreen:function(){return jQuery(window).height()<=SITB_READER_SMALLSCREEN_MAX_HEIGHT},getLightboxTop:function(){return this.isFullscreen?SITB_READER_LB_TOP_FULL:SITB_READER_LB_TOP},getLightboxLeft:function(){return this.isFullscreen?sitbReaderIsIE?SITB_READER_LB_LEFT_FULL_IE:SITB_READER_LB_LEFT_FULL:SITB_READER_LB_LEFT},getLightboxWidth:function(){return SITB_READER_IS_TOUCH_SUPPORTED?Math.min(SITB_READER_MAX_WIDTH,jQuery(document).width()-this.getLightboxLeft()*2):jQuery(window).width()-
this.getLightboxLeft()*2},getLightboxHeight:function(){var a=this.isFullscreen?SITB_READER_LB_HEIGHT_ADJ_FULL:SITB_READER_LB_HEIGHT_ADJ;return jQuery(window).height()-this.getLightboxTop()-a}};
SitbReader.BuyWidget={load:function(a){var b=SitbReader.RefTag;jQuery("#sitbReaderBookTitle a").html(sitbReaderTrimString(a.title,45));jQuery("#sitbReaderBookTitle a").attr({title:sitbReaderGetString("GO_TO_BOOK_PAGE",{BOOK_TITLE:a.title})});var c=a.thumbnailImage.replace(/\.(...)$/,"._SX35_.$1"),d=jQuery("#sitbReaderBookThumbnailHolder"),e=new Image;e.onload=function(){var a=this.height;if(!(a>54)){var b=6;a%1&&b++;b+=Math.floor((54-a)/2);d.css({"margin-top":Math.floor((54-a)/2),"margin-bottom":b})}};
e.title=e.alt=sitbReaderGetString("GO_TO_BOOK_PAGE",{BOOK_TITLE:a.title});e.src=c;e.setAttribute("id","sitbReaderBookThumbnail");d.html(e);SitbReader.currentBook.buyingAsin?(c=b.getFormatedRefTag(b.Actions.exit,b.ExitMethod.thumbnail),jQuery("#sitbReaderBuyContent a").attr({href:"/dp/"+SitbReader.currentBook.buyingAsin+"/ref="+c})):jQuery("#sitbReaderBuyContent a").click(function(){SitbReader.BuyActions.goToDetailPageFromThumbnail();return!1});if(a.authorNameList){for(var c=[],e=b.getFormatedRefTag(b.Actions.exit,
b.ExitMethod.author),f=0;f<a.authorNameList.length;f++)c[f]='<a href="/s/ref='+e+"?_encoding=UTF8&index=books&field-author="+encodeURIComponent(a.authorNameList[f])+'">'+a.authorNameList[f]+"</a>";jQuery("#sitbReaderAuthorBlock").html(sitbReaderGetString("BY",{AUTHORS:c.join(", ")}))}a.binding&&jQuery("#sitbReaderBinding").html("("+a.binding+")");c="";a.reviewStarsImageTag&&(c='<span id="sitbReaderCustomerReviews">'+a.reviewStarsImageTag+"</span><br/>");f=e="";if(a.buyingPrice||a.buyingPrice===0){e+=
'<a href="/dp/'+SitbReader.currentBook.buyingAsin+'">';e+=a.binding;e+="</a> ";e+='<span class="sitbReaderPrice">'+sitbReaderPriceString(a.buyingPrice)+"</span>";e+='<div id="sitbReaderCartDiv">';if(a.isHTML()){var g=b.getFormatedRefTag(b.Actions.exit,b.ExitMethod.oneClickBuy),b=b.getFormatedRefTag(b.Actions.exit,b.ExitMethod.sendSample);e+='<form id="sitbReaderCart-form" method="post" action="'+a.kindleBuyItURL+"/ref="+g+'">  <input type="hidden" name="ASIN.0" value="'+a.buyingAsin+'" />  <input type="hidden" name="kc.0" value="'+
a.merchantID+'" />  <input type="hidden" name="subtype.0" value="STANDARD" />  <input type="hidden" name="t" value="fiona" />  <input type="hidden" name="itemCount" value="1" />  <input type="hidden" name="offerListingID.0" value="'+a.offerListingID+'" />';e+='<input type="button" id="sitbKindleReaderCartButton" onclick="jQuery(\'#sitbReaderCart-form\').submit();" />';a.kindleDevices!=""&&(e+='<div id="sitbKindleReaderDeliverToText">'+sitbReaderGetString("DELIVER_TO")+"</div>"+a.kindleDevices);e+=
"</form>";a.asin==a.buyingAsin&&(f+='<div id="sitbKindleReaderSendSampleText">'+sitbReaderGetString("SEND_SAMPLE")+"</div>",f+='<div id="sitbReaderSendSampleDiv"><form id="sitbReaderSendSample-form" method="post" action="'+a.kindleBuyItURL+"/ref="+b+'">  <input type="hidden" name="ASIN.0" value="'+a.buyingAsin+'" />  <input type="hidden" name="kc.0" value="'+a.merchantID+'" />  <input type="hidden" name="subtype.0" value="FREE_CHAPTER" />  <input type="hidden" name="t" value="fiona" />  <input type="hidden" name="itemCount" value="1" />  <input type="hidden" name="offerListingID.0" value="'+
a.offerListingID+'" />  <input type="hidden" id="sitbReaderDeviceID" name="target-fiona.0" value="" /></div>',f+="<input type=\"button\" id=\"sitbKindleReaderSendSampleButton\" onclick=\"jQuery('#sitbReaderDeviceID').val(jQuery('#sitbReaderDeviceSelect').val()); jQuery('#sitbReaderSendSample-form').submit();\" /></form><br/>")}else b.getFormatedRefTag(b.Actions.exit,b.ExitMethod.oneClickBuy),e+='  <form id="sitbReaderCart-form" method="post" action="/gp/legacy-handle-buy-box.html/ref=rdr_ext_atc">    <input type="hidden" name="asin.'+
a.buyingAsin+'" value="1" />    <input type="hidden" name="'+a.buyingAsin+'" value="1" />    <input type="hidden" name="session-id" value="'+a.sessionId+'" />    <input type="hidden" name="store-name" value="books" />    <input type="hidden" name="maw" value="1" />    <input type="button" id="sitbReaderCartButton" onclick="jQuery(\'#sitbReaderCart-form\').submit();" />  </form>';e+="</div>"}jQuery("#sitbReaderPriceBlock").html(c+e+f);a.isPrint()&&a.usedAndNewCount&&(a.usedAndNewCount>1||a.usedAndNewCount==
1&&!a.isAmazonOffer)?jQuery("#sitbReaderUsedDiv").html(sitbReaderGetString("USED_AND_NEW_FROM",{ASIN:a.buyingAsin,COUNT:a.usedAndNewCount,PRICE:sitbReaderPriceString(a.usedAndNewLowestPrice)})).show():jQuery("#sitbReaderUsedDiv").hide()}};SitbReader.PaneTitleWidget=function(a,b,c){this.title=a;this.idPrefix=b;this.toggleActionString=c};
SitbReader.PaneTitleWidget.prototype.getHtml=function(){return'<div id="'+this.idPrefix+'-title" class="sitbReader-pane-title" onclick="'+this.toggleActionString+'">\n    <div class="sitbReader-horizontal-white-border"></div>\n    <div id="'+this.idPrefix+'-toggle" class="sitbReader-toggle-opened"></div>\n    <div id="'+this.idPrefix+'-title-text" class="sitbReader-pane-title-text">'+this.title+'</div>\n    <div id="'+this.idPrefix+'-white-border-btm" class="sitbReader-horizontal-white-border-bottom"></div>\n</div>\n'};
SitbReader.PaneTitleWidget.prototype.slideUp=function(){jQuery("#"+this.idPrefix+"-toggle").removeClass("sitbReader-toggle-opened").addClass("sitbReader-toggle-closed")};SitbReader.PaneTitleWidget.prototype.slideDown=function(){jQuery("#"+this.idPrefix+"-toggle").removeClass("sitbReader-toggle-closed").addClass("sitbReader-toggle-opened")};SitbReader.PaneTitleWidget.prototype.patchCSS=function(){};
SitbReader.BookmarksWidget={numBookmarks:0,paneTitleWidget:new SitbReader.PaneTitleWidget(sitbReaderGetString("BOOK_SECTIONS"),"sitbReaderBookmarks","SitbReader.BookmarksActions.toggleBookmarksPane()"),load:function(a){var b=[];if(SitbReader.currentBook.isHTML())b.push('<a class="sitbReader-bookmark" href="javascript:void(0)"'),b.push("   onclick=\"SitbReader.BookmarksActions.goToBookmark('cvr')\">"),b.push(sitbReaderGetString("KINDLE_COVER")+"</a><br>"),b.push('<a class="sitbReader-bookmark" href="javascript:void(0)"'),
b.push("   onclick=\"SitbReader.BookmarksActions.goToBookmark('srl')\">"),b.push(sitbReaderGetString("KINDLE_START_READING_LOCATION")+"</a><br>"),this.numBookmarks=2;else{for(var c=0;c<a.getSize();c++)jQuery.inArray(a.getFirstPageNumber(c),SitbReader.currentBook.xPages)>=0?(b.push('<span class="sitbReader-bookmark-disabled">'),b.push(a.getName(c)+"</span><br>")):(b.push('<a class="sitbReader-bookmark" href="javascript:void(0)"'),b.push("   onclick=\"SitbReader.BookmarksActions.goToBookmark('"+a.getName(c)+
"')\">"),b.push(a.getName(c)+"</a><br>"));b.push('<a class="sitbReader-bookmark-surprise" href="javascript:void(0)"');b.push('onclick="SitbReader.PageSequenceActions.goToRandomPage()">');b.push("   "+sitbReaderGetString("SURPRISE_ME")+"</a><br>");this.numBookmarks=a.getSize()}jQuery("#sitbReaderBookmarks-pages").html(b.join(""))},select:function(a){a=jQuery("a.sitbReader-bookmark").eq(a);a.addClass("sitbReader-link-visited");a.addClass("sitbReader-link-selected")},unselect:function(){jQuery("a.sitbReader-bookmark").removeClass("sitbReader-link-selected")},
slideUp:function(){jQuery("#sitbReaderBookmarks-pages").is(":hidden")||(jQuery("#sitbReaderBookmarks-pages").height(),jQuery("#sitbReaderBookmarks-pages").slideUp("slow",function(){SitbReader.SearchWidget.setResultsHeight()}),this.paneTitleWidget.slideUp())},slideDown:function(){if(jQuery("#sitbReaderBookmarks-pages").is(":hidden")){var a=SitbReader.SearchWidget.calculateSearchResultSpace();jQuery("#sitbReaderSearch-all-results").height(a);SitbReader.SearchWidget.resultsHeight=a;SitbReader.SearchWidget.setResultsHeight(300);
jQuery("#sitbReaderBookmarks-pages").slideDown("slow",function(){SitbReader.SearchWidget.setResultsHeight()});this.paneTitleWidget.slideDown()}},show:function(){SitbReader.BookmarksWidget.updateHeight();this.paneTitleWidget.patchCSS()},updateHeight:function(){var a=SitbReader.BookmarksWidget.getFullHeight(),b=jQuery("#sitbReaderLeftPane").height()-jQuery("#sitbReaderBuyContent").outerHeight()-jQuery("#sitbReaderBookmarks-title").outerHeight()-jQuery("#sitbReaderSearch-title").outerHeight()-jQuery("#sitbReaderSearch-input").outerHeight(),
c=jQuery("#sitbReaderBookmarks-pages");b-=c.outerHeight()-c.height();b<SITB_READER_BOOKMARK_MIN_HEIGHT?b=SITB_READER_BOOKMARK_MIN_HEIGHT:b>a&&(b=a);this.setHeight(b)},getFullHeight:function(){return(this.numBookmarks+1)*parseInt(jQuery("#sitbReaderBookmarks-pages").css("line-height"))},setHeight:function(a){jQuery("#sitbReaderBookmarks-pages").height(a)}};
SitbReader.SearchWidget={resultsHeight:0,headerHeight:0,highlightOpacity:jQuery.browser.msie?"filter:alpha(opacity=50)":"opacity:0.5",paneTitleWidget:new SitbReader.PaneTitleWidget(sitbReaderGetString("SEARCH_INSIDE_THIS_BOOK"),"sitbReaderSearch","SitbReader.SearchActions.toggleSearchPane()"),load:function(){jQuery("#sitbReaderSearch-title");SitbReader.currentBook.searchable?(jQuery("#sitbReaderSearch").show(),jQuery("#sitbReaderSearch-form").submit(function(){SitbReader.SearchWidget.submitSearch();
return!1}),this.showSampleSearches(),this.headerHeight=jQuery("#sitbReaderSearch-headerheight").height()):jQuery("#sitbReaderSearch").hide()},show:function(){this.showSampleSearches();this.setResultsHeight()},submitSearch:function(){var a=jQuery(".sitbReaderSearch-inputbox").attr("value");SitbReader.SearchActions.search(a)},showSampleSearches:function(){var a=SitbReader.currentBook.sips,b=jQuery("#sitbReaderSearch-sips");if(b.html()!="")b.show();else if(a&&a.length){var c=[];c.push(sitbReaderGetString("SAMPLE_SEARCHES")+
"<br>");for(var d=0;d<a.length;d++)c.push('<a class="sitbReader-sips" href="javascript:void(0)" '),c.push("onclick=\"SitbReader.SearchActions.search('"+a[d]+"',SitbReader.RefTag.Actions.sampleSearchExecuted);\">"),c.push(a[d]+"</a><br>");b.html(c.join(""))}},hideSampleSearches:function(){jQuery("#sitbReaderSearch-sips").css("display","none")},clearResults:function(){jQuery("#sitbReaderSearch-count").hide();jQuery("#sitbReaderSearch-count-text").empty();jQuery("#sitbReaderSearch-all-results").empty();
jQuery(".sitbReaderSearch-inputbox").val("")},calculateSearchResultSpace:function(){return jQuery("#sitbReaderLeftPane").height()+jQuery("#sitbReaderLeftPane").offset().top-jQuery("#sitbReaderSearch-all-results").offset().top-2},showResults:function(a){SitbReader.metrics.startTimer("searchDisplay");SitbReader.SearchWidget.hideLoading();if(a){SitbReader.SearchWidget.clearResults();var b=SitbReader.currentBook.buyingAsin,c="";!SitbReader.currentBook.hasFullAccess&&SitbReader.availability.level==0&&
SitbReader.currentSearch.numResults>0&&(c="<br><b>"+sitbReaderGetString("SIGN_IN_TO_VIEW",{ASIN:b,QUERY:SitbReader.currentSearch.currentQuery})+"</b>");jQuery("#sitbReaderSearch-count").show();jQuery("#sitbReaderSearch-count-text").append(SitbReader.currentSearch.numResults!=1?sitbReaderGetString("RESULTS_FOR",{HTML_REPLACE:sitbReaderReplaceHtmlEntities(SitbReader.currentSearch.currentQuery),RESULT_NUM:SitbReader.currentSearch.numResults,SIGN_IN_MSG:c}):sitbReaderGetString("RESULT_FOR",{HTML_REPLACE:sitbReaderReplaceHtmlEntities(SitbReader.currentSearch.currentQuery),
RESULT_NUM:SitbReader.currentSearch.numResults,SIGN_IN_MSG:c}))}this.setResultsHeight();b=jQuery("#sitbReaderSearch-all-results");if(SitbReader.currentSearch.numResults>0)for(var d=c="",e=SitbReader.currentSearch.previousDisplayedResult;e<SitbReader.currentSearch.numDisplayedResults;e++)SitbReader.currentBook.pages[SitbReader.currentSearch.resultPageNumbers[e]].isX()?(c='""',d='"sitbReader-result-link sitbReader-link-disabled"'):(c='"SitbReader.RefTag.post(SitbReader.RefTag.Actions.searchResult,SitbReader.RefTag.LandingPage.excerpt); SitbReader.SearchActions.goToSearchResult('+
e+')"',d='"sitbReader-result-link"'),b.append('<div id="sitbReaderSearch-result-'+e+'" class="sitbReaderSearch-result"><a class='+d+'   href="javascript:void(0)"    onclick= '+c+'   title="'+sitbReaderReplaceHtmlEntities(SitbReader.currentSearch.getLongExcerpt(e))+'"></a><div>'),this.fillDiv(SitbReader.currentSearch.getExcerpt(e),"<span class='sitbReaderSearch-result-page'>"+SitbReader.currentSearch.getPageTitle(e)+"</span> ","#sitbReaderSearch-result-"+e+" a",45);a&&b.scrollTop(0);SitbReader.SearchWidget.headerHeight=
jQuery("#sitbReaderSearch-headerheight").height();SitbReader.SearchWidget.resultsHeight=jQuery("#sitbReaderSearch-all-results").height();SitbReader.metrics.endTimer("searchDisplay")},addMoreResultsLink:function(){var a=SitbReader.currentSearch.numResults-SITB_READER_SEARCH_FETCH_NUMBER_NEXT*SitbReader.currentSearch.currentResultsPage;SitbReader.currentSearch.totalResultsPages-SitbReader.currentSearch.currentResultsPage>0&&a>0&&(a=Math.min(SitbReader.currentSearch.numResults-SITB_READER_SEARCH_FETCH_NUMBER_NEXT*
SitbReader.currentSearch.currentResultsPage,SITB_READER_SEARCH_FETCH_NUMBER_NEXT),jQuery("#sitbReaderSearch-all-results").append('<div class="sitbReaderSearch-more-results"><a href="javascript:void(0)">'+(a>1?sitbReaderGetString("SHOW_MORE_RESULTS",{RESULTS_TO_LOAD:a}):sitbReaderGetString("SHOW_MORE_RESULT",{RESULT_TO_LOAD:a})+"</a></div>")),jQuery(".sitbReaderSearch-more-results").attr("title",SITB_READER_TTIP_MORE_RESULTS),jQuery(".sitbReaderSearch-more-results").unbind("click"),jQuery(".sitbReaderSearch-more-results").click(function(){SitbReader.SearchActions.fetchMoreResults()}))},
hookTooltips:function(){jQuery(document).ready(function(){jQuery(".sitbReader-result-link").each(function(){jQuery(this).tooltip({track:!0,delay:0,showURL:!1})})})},fillDiv:function(a,b,c,d){for(var e=0,f=a.length;e<f&&f-e>4;){var g=Math.ceil(e+(f-e)/2);jQuery(c).html(b+a.removeChars(a.length-g));jQuery(c).height()<=d?e=g:f=g}if(a.length-e<=4&&(jQuery(c).html(b+a.excerpt),jQuery(c).height()<d))return a.length;jQuery(c).html(b+a.removeChars(a.length-e));return e},select:function(a){jQuery("a.sitbReader-result-link").removeClass("sitbReader-link-selected");
a>-1&&(jQuery("a.sitbReader-result-link").eq(a).addClass("sitbReader-link-visited"),jQuery("a.sitbReader-result-link").eq(a).addClass("sitbReader-link-selected"))},unselect:function(a){jQuery("a.sitbReader-result-link").eq(a).removeClass("sitbReader-link-selected");SitbReader.currentSearch.isVisited(a)?jQuery("a.sitbReader-result-link").eq(a).addClass("sitbReader-link-visited"):jQuery("a.sitbReader-result-link").eq(a).addClass("sitbReader-link-unselected")},slideUp:function(){jQuery("#sitbReaderSearch-contents").is(":hidden")||
(jQuery("#sitbReaderSearch-contents").slideUp("slow"),this.paneTitleWidget.slideUp())},slideDown:function(){jQuery("#sitbReaderSearch-contents").is(":hidden")&&(jQuery("#sitbReaderSearch-contents").slideDown("slow",function(){SitbReader.SearchWidget.setResultsHeight()}),this.paneTitleWidget.slideDown())},setResultsHeight:function(a){var b=SitbReader.SearchWidget.calculateSearchResultSpace();a!=null&&(b-=a);SitbReader.currentSearch.numResults>0&&jQuery("#sitbReaderSearch-all-results").height(b);SitbReader.SearchWidget.resultsHeight=
b},showLoading:function(a){a?(SitbReader.SearchWidget.hideSampleSearches(),SitbReader.SearchWidget.clearResults(),a=0,a=jQuery(window).height()+jQuery(window).scrollTop()>jQuery("#sitbLightbox").offset().top+jQuery("#sitbLightbox").height()?jQuery("#sitbLightbox").offset().top+jQuery("#sitbLightbox").height():jQuery(window).height()+jQuery(window).scrollTop(),a=Math.round((a+jQuery("#sitbReaderSearch-headerheight").height()-jQuery("#sitbReaderSearch-headerheight").offset().top+14)/2),a<65&&(a=65),
jQuery("#sitbReaderSearch-loading").css("top",a),jQuery("#sitbReaderSearch-loading").show()):(jQuery(".sitbReaderSearch-more-results").html(""),jQuery(".sitbReaderSearch-more-results").addClass("sitbReaderSearch-more-results-loading"))},hideLoading:function(){jQuery("#sitbReaderSearch-loading").hide();jQuery(".sitbReaderSearch-more-results").hide();jQuery(".sitbReaderSearch-more-results").remove()},adjustScrollBar:function(a){if(!(a<0||a>SitbReader.currentSearch.numDisplayedResults)){var b=jQuery("#sitbReaderSearch-all-results").offset().top,
a=jQuery("#sitbReaderSearch-result-"+a).offset().top,c=jQuery("#sitbReaderSearch-all-results").scrollTop(),d=b+jQuery("#sitbReaderSearch-all-results").height()<a+25;a<b&&jQuery("#sitbReaderSearch-all-results").scrollTop(c-(b-a));d&&jQuery("#sitbReaderSearch-all-results").scrollTop(a-b+c)}},renderHighlights:function(a){if(a&&a.length>0){for(var b=[],c,d,e,f,g=0;g<a.length;g++)c=a[g][0]*0.09765625,d=a[g][1]*0.09765625,e=a[g][2]*0.09765625,f=a[g][3]*0.09765625,b.push("<div id='sitbReaderSearch-highlight' style='"+
this.highlightOpacity+";left:"+c+"%;top:"+d+"%;width:"+e+"%;height:"+f+"%'/>");return b.join("")}else return""}};
SitbReader.ReaderWidget={immediateMode:!0,pageImageWidth:0,imageWidth:0,imageHeight:0,vsTop:-1E4,vsBottom:-1E4,PAGE_WIDTH_DELTA:55,PAGE_TURNER_WIDTH:14,PAGE_TURNER_SPACING:12,PAGE_TURNER_PAGE_SPACING:20,PAGE_TURNER_HOVER_OPACITY:0.95,PAGE_TURNER_INVISIBLE_OPACITY:0.01,divid:"#sitbReaderPageContainer",lastScroll:Number.MIN_VALUE,vsObjects:{},turners:{n:{divid:"#sitbReaderRightPageTurner",enabledOffsets:"0 -3625px",disabledOffsets:"0 -3625px",hoverOffsets:"0 -3625px",action:SitbReader.ReaderActions.goToNextPage,
top:0,state:null,visibility:!0},p:{divid:"#sitbReaderLeftPageTurner",enabledOffsets:"0 -3596px",disabledOffsets:"0 -3596px",hoverOffsets:"0 -3596px",action:SitbReader.ReaderActions.goToPrevPage,top:0,state:null,visibility:!0},ns:{divid:"#sitbReaderRightSearchNav",enabledOffsets:"0 -1315px",disabledOffsets:"0 -471px",hoverOffsets:"0 -1804px",action:SitbReader.SearchActions.goToNextResult,top:-120,state:null},ps:{divid:"#sitbReaderLeftSearchNav",enabledOffsets:"0 -1037px",disabledOffsets:"0 -376px",
hoverOffsets:"0 -1723px",action:SitbReader.SearchActions.goToPrevResult,top:-120,state:null}},pageBorders:{r:new SitbReader.BorderElement(SITB_READER_HORZ_SPRITE_URL,SITB_READER_BASE_IMG_URL+"bookImg_dshadow_side._V1_.png",0,0,5,1,{right:2,top:4,bottom:2}),tr:new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,SITB_READER_BASE_IMG_URL+"bookImg_dshadow_RTopSide._V1_.png",0,240,5,4,{top:4,right:2}),br:new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,SITB_READER_BASE_IMG_URL+"bookImg_dshadow_RBtmCorner._V1_.png",
0,235,5,4,{right:2,bottom:2}),bl:new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,SITB_READER_BASE_IMG_URL+"bookImg_dshadow_LBtm._V1_.png",0,230,4,4,{left:2,bottom:2}),b:new SitbReader.BorderElement(SITB_READER_VERT_SPRITE_URL,SITB_READER_BASE_IMG_URL+"bookImg_dshadow_bottom._V1_.png",0,225,1,4,{left:2,right:2,bottom:2})},show:function(){var a=jQuery(window),b=a.scrollTop(),a=a.height(),c=jQuery("#sitbReaderPageContainer").offset().top;jQuery("#sitbReaderPageContainerVerticalScroller").css("top",
(a+b-c)/2);this.calculateVerticalDimensions();this.centerVerticalScrollerOnPage();this.vsObjects[this.turners.n.divid]=!0;this.vsObjects[this.turners.p.divid]=!0;jQuery(this.turners.ns.divid).attr("title",SITB_READER_TTIP_NEXT_RESULT);jQuery(this.turners.ps.divid).attr("title",SITB_READER_TTIP_PREV_RESULT);this.setWidth();this.centerPageImage();SitbReader.ZoomWidget.centerToolbarButtons();SitbReader.currentBook.isPrint()?SitbReader.ZoomActions.updateFitToScreenZoomLevel(SitbReader.currentBook.pages[1]):
SitbReader.PageSequenceWidget.redraw();setTimeout(function(){SitbReader.ReaderWidget.updateOnResize()},0)},disableTurner:function(a){var b=jQuery(this.turners[a].divid);if(sitbReaderIsBlank(b.css("background"))||this.turners[a].state!=!1)b.unbind("click").unbind("mouseover").unbind("mouseout").css("cursor","auto").css("background","url("+SITB_READER_SPRITES_URL+") "+this.turners[a].disabledOffsets),this.turners[a].state=!1},enableTurner:function(a){if(this.turners[a].state!=!0){var b=this.turners[a].action,
c=this.turners[a];jQuery(this.turners[a].divid).unbind("click").unbind("mouseover").unbind("mouseout").bind("click",b).css("cursor","pointer").css("background","url("+SITB_READER_SPRITES_URL+") "+this.turners[a].enabledOffsets).bind("mouseover",function(){jQuery(c.divid).css("background","url("+SITB_READER_SPRITES_URL+") "+c.hoverOffsets)}).bind("mouseout",function(){jQuery(c.divid).css("background","url("+SITB_READER_SPRITES_URL+") "+c.enabledOffsets)});this.turners[a].state=!0}},disableNextPageButton:function(){this.disableTurner("n")},
disablePrevPageButton:function(){this.disableTurner("p")},enableNextPageButton:function(){this.enableTurner("n")},enablePrevPageButton:function(){this.enableTurner("p")},enableNextSearchButton:function(){this.enableTurner("ns")},enablePrevSearchButton:function(){this.enableTurner("ps")},disableNextSearchButton:function(){jQuery(this.turners.ns.divid).hide();this.disableTurner("ns")},disablePrevSearchButton:function(){jQuery(this.turners.ps.divid).hide();this.disableTurner("ps")},hideSearchTurners:function(){jQuery(this.turners.ns.divid).hide();
jQuery(this.turners.ps.divid).hide()},updatePageTurnersState:function(){var a=SitbReader.pageSequence.currentPage,b=jQuery("#sitbReaderPageContainer"),c=SitbReader.currentBook.isPrint()?a>SitbReader.pageSequence.firstAvailablePageNumber:b.scrollTop()!=0;(a=SitbReader.currentBook.isPrint()?a<SitbReader.pageSequence.lastAvailablePageNumber:b.scrollTop()<jQuery("#sitbReaderPageScroll").height()-b.height())?this.enableNextPageButton():this.disableNextPageButton();c?this.enablePrevPageButton():this.disablePrevPageButton();
SitbReader.BottomButtonWidget.setEnabled(a)},updateSearchTurnersState:function(){this.disableNextSearchButton();this.disablePrevSearchButton();if(SitbReader.currentSearch.numResults>0){(SitbReader.pageSequence.currentPage<SitbReader.currentSearch.resultPageNumbers[SitbReader.currentSearch.resultPageNumbers.length-1]||SitbReader.currentSearch.numDisplayedResults<SitbReader.currentSearch.numResults)&&this.enableNextSearchButton();var a=SitbReader.currentSearch.getFirstAvailablePageNumber();a!=null&&
SitbReader.pageSequence.currentPage>a&&this.enablePrevSearchButton()}},setPageTurnersDisplay:function(a){a?(jQuery("#sitbReaderRightPageTurner").show(),jQuery("#sitbReaderLeftPageTurner").show()):(jQuery("#sitbReaderRightPageTurner").hide(),jQuery("#sitbReaderLeftPageTurner").hide())},setSearchTurnersDisplay:function(a){a?(SitbReader.ReaderWidget.addToVerticalScroller("#sitbReaderRightSearchNav"),SitbReader.ReaderWidget.addToVerticalScroller("#sitbReaderLeftSearchNav")):(SitbReader.ReaderWidget.removeFromVerticalScroller("#sitbReaderRightSearchNav"),
SitbReader.ReaderWidget.removeFromVerticalScroller("#sitbReaderLeftSearchNav"))},updateOnResize:function(){this.setWidth();SitbReader.currentBook.isHTML()&&(jQuery("#sitbReaderPageScroll").width(SitbReader.ZoomModel.getPageWidth()),SitbReader.KindleContentActions.handleResize());var a=jQuery("#sitbReaderPageScroll").height();this.centerPageImage(jQuery("#sitbReaderPageScroll").width(),a);SitbReader.ZoomWidget.centerToolbarButtons();this.updateVerticalScroller();SitbReader.PagelabelWidget.update();
SitbReader.MessageWidget.resize();SitbReader.ReaderActions.setPanning();SitbReader.BottomButtonWidget.handleResize();SitbReader.ReaderActions.setPageTurners();this.setContainerTurnerEvents();centerJQueryObjectInWindow(jQuery("#vellumMsg"))},updateVerticalScroller:function(){this.centerVerticalScrollerOnPage();this.setVerticalScrollerWidth()},getTopSpace:function(){return jQuery(this.divid).offset().top},getHeight:function(){return jQuery(this.divid).height()},getLeftSpace:function(){return jQuery(this.divid).offset().left},
getWidth:function(){return jQuery(this.divid).width()},centerVerticalScrollerOnPage:function(){var a=jQuery("#sitbReaderPageContainer").height()/2;jQuery("#sitbReaderPageContainerVerticalScroller").css("top",a)},setVerticalScrollerWidth:function(){jQuery(window).scrollLeft();jQuery(window).width();var a=parseInt(jQuery("#sitbReaderPageScroll").css("left")),b=jQuery("#sitbReaderPageScroll").width(),c=jQuery("#sitbReaderPageContainer").width(),d=0,e=0,e=SitbReader.LeftPaneWidget.getWidth();this.isSmallReader(c,
b)?(d=c-this.PAGE_TURNER_SPACING,e+=this.PAGE_TURNER_SPACING,d-=SITB_READER_SCROLLBAR_WIDTH):(d=b+2*this.PAGE_TURNER_WIDTH+2*this.PAGE_TURNER_PAGE_SPACING,e=a+e-this.PAGE_TURNER_WIDTH-this.PAGE_TURNER_PAGE_SPACING-2);jQuery("#sitbReaderPageContainerVerticalScroller").width(d);jQuery("#sitbReaderPageContainerVerticalScroller").css("left",e)},centerPageImage:function(a,b){var c=jQuery("#sitbReaderPageScroll");typeof a=="undefined"&&(a=c.width());typeof b=="undefined"&&c.height();var d=jQuery("#sitbReaderPageContainer").width();
a<d?c.css("left",(d-a)/2):c.css("left","0px")},updatePageShadow:function(){this.drawPageShadow()},drawPageShadow:function(){SitbReader.Border.applyBorderSet("#sitbReaderPage","spborder",this.pageBorders)},addToVerticalScroller:function(a){this.vsObjects[a]||(jQuery("#sitbReaderPageContainerVerticalScroller").append('<div id="'+a.substring(1)+'"></div>'),this.calculateVerticalDimensions(),this.centerVerticalScrollerOnPage(),this.vsObjects[a]=!0)},removeFromVerticalScroller:function(a){this.vsObjects[a]&&
delete this.vsObjects[a];jQuery("#sitbReaderPageContainerVerticalScroller "+a).remove();this.calculateVerticalDimensions()},calculateVerticalDimensions:function(){this.vsTop=this.vsBottom=-1E4;jQuery("#sitbReaderPageContainerVerticalScroller div").each(function(){var a=jQuery(this),b=parseInt(a.height()),a=parseInt(a.css("top"));if(b+a>this.vsBottom)SitbReader.ReaderWidget.vsBottom=b+a;if(-1*a>SitbReader.ReaderWidget.vsTop)SitbReader.ReaderWidget.vsTop=-1*a})},setWidth:function(){jQuery("#sitbReaderPageContainer").width(this.getContainerWidth())},
getImageHeight:function(){return jQuery("#sitbReaderPageContainer").height()-SITB_READER_PAGE_PADDING*2},getContainerWidth:function(){var a=SitbReader.LightboxWidget.getLightboxWidth()-SITB_READER_SB_OPENER_WIDTH;a-=SitbReader.LeftPaneWidget.isOpened?SITB_READER_LEFT_PANEL_WIDTH_OPN:SITB_READER_LEFT_PANEL_WIDTH_CLD;SitbReader.SBWidget.isOpened&&(a-=SITB_READER_SB_WIDTH);return a},renderPageOverlay:function(a){var b=SitbReader.currentBook.pages[a],c=jQuery("#sitbReaderHighlights-"+a),d=SitbReader.currentSearch.currentQuery;
c.size()==1&&(c.empty(),SitbReader.currentSearch.numResults>0&&b.hasHighlights(d)&&c.append(b.highlights[d]),b.isTOC&&SitbReader.ClickableTOCWidget.show(a))},isSmallReader:function(a,b){return a-2*(this.PAGE_TURNER_WIDTH+this.PAGE_TURNER_PAGE_SPACING+SITB_READER_SCROLLBAR_WIDTH)<b},setContainerTurnerEvents:function(){var a=jQuery("#sitbReaderPageContainer"),b=jQuery("#sitbReaderPageScroll"),c=SitbReader.ReaderWidget.turners.p,d=SitbReader.ReaderWidget.turners.n;this.isSmallReader(a.width(),b.width())?
(a.unbind("mousemove"),jQuery(c.divid).fadeTo(250,this.PAGE_TURNER_HOVER_OPACITY),jQuery(d.divid).fadeTo(250,this.PAGE_TURNER_HOVER_OPACITY),c.visibility=d.visibility=!0):a.unbind("mousemove").mousemove(function(a){if((a=SitbReader.ReaderWidget.getPageTurnerByPosition(a.pageX))&&!a.visibility)jQuery(a.divid).fadeTo(150,SitbReader.ReaderWidget.PAGE_TURNER_HOVER_OPACITY),a.visibility=!0;else if(!a&&(c.visibility||d.visibility))jQuery(c.divid).fadeTo(500,SitbReader.ReaderWidget.PAGE_TURNER_INVISIBLE_OPACITY),
jQuery(d.divid).fadeTo(500,SitbReader.ReaderWidget.PAGE_TURNER_INVISIBLE_OPACITY),c.visibility=d.visibility=!1}).click(function(a){if((new Date).getTime()-SitbReader.ReaderWidget.lastScroll>200)(a=SitbReader.ReaderWidget.getPageTurnerByPosition(a.pageX))&&jQuery(a.divid).trigger("click"),SitbReader.ReaderWidget.lastScroll=(new Date).getTime()})},getPageTurnerByPosition:function(a){var b=jQuery("#sitbReaderPageScroll"),c=b.offset(),b=c.left+b.width();return a<c.left?SitbReader.ReaderWidget.turners.p:
a>b?SitbReader.ReaderWidget.turners.n:null}};
SitbReader.ZoomWidget={show:function(){this.setZoomControls()},setZoomControls:function(){var a=SitbReader.ZoomModel;a.canZoomIn()?this.enableZoomIn():this.disableZoomIn();a.canZoomOut()?this.enableZoomOut():this.disableZoomOut()},centerToolbarButtons:function(){var a=jQuery("#sitbReaderZoomToolbar"),b=jQuery("#sitbReaderTBLinks"),c=jQuery("#sitbReaderPageContainer").width()/2+SitbReader.LeftPaneWidget.getWidth(),d=SitbReader.LightboxWidget.isFullscreen?SITB_READER_ZOOM_PADDING_FULL:SITB_READER_ZOOM_PADDING_STD;
b.offset().left>c+SITB_READER_ZOOM_IN_WIDTH+d+SITB_READER_MIN_ZOOM_LINKS_PADDING?a.css("left",c):(b=b.offset().left-(c+SITB_READER_ZOOM_IN_WIDTH+d),a.css("left",c+b-SITB_READER_MIN_ZOOM_LINKS_PADDING))},enableZoomInHoverEffect:function(){jQuery("#sitbReaderTitlebarZoomIn").bind("mouseover",function(){jQuery("#sitbReaderTitlebarZoomIn").css("background-position","0 -2031px")}).bind("mouseout",function(){jQuery("#sitbReaderTitlebarZoomIn").css("background-position","0 -2013px")})},enableZoomOutHoverEffect:function(){jQuery("#sitbReaderTitlebarZoomOut").bind("mouseover",
function(){jQuery("#sitbReaderTitlebarZoomOut").css("background-position","0 -1977px")}).bind("mouseout",function(){jQuery("#sitbReaderTitlebarZoomOut").css("background-position","0 -1959px")})},disableZoomInHoverEffect:function(){jQuery("#sitbReaderTitlebarZoomIn").unbind("mouseout").unbind("mouseover")},disableZoomOutHoverEffect:function(){jQuery("#sitbReaderTitlebarZoomOut").unbind("mouseout").unbind("mouseover")},disableZoomIn:function(){jQuery("#sitbReaderTitlebarZoomIn").unbind("click").css("background",
"url("+SITB_READER_SPRITES_URL+") 0 -2049px");this.disableZoomInHoverEffect()},disableZoomOut:function(){jQuery("#sitbReaderTitlebarZoomOut").unbind("click").css("background","url("+SITB_READER_SPRITES_URL+") 0 -1995px");this.disableZoomOutHoverEffect()},enableZoomIn:function(){jQuery("#sitbReaderTitlebarZoomIn").unbind("click").bind("click",SitbReader.ZoomActions.zoomIn).css("background","url("+SITB_READER_SPRITES_URL+") 0 -2013px");this.enableZoomInHoverEffect()},enableZoomOut:function(){jQuery("#sitbReaderTitlebarZoomOut").unbind("click").bind("click",
SitbReader.ZoomActions.zoomOut).css("background","url("+SITB_READER_SPRITES_URL+") 0 -1959px");this.enableZoomOutHoverEffect()}};
SitbReader.ErrorMessageWidget={divid:"#sitbReaderErrorMessageContainer",containingDivid:"#sitbReaderPageContainer",msgDisplayed:!1,show:function(a,b){var c=jQuery(this.divid);jQuery("#sitbReaderErrorMessageHeader").html(a?a:SITB_READER_DEFAULT_ERROR_MSG_HEADER);jQuery("#sitbReaderErrorMessageText").html(b?b:SITB_READER_DEFAULT_ERROR_MSG_TEXT);SitbReader.LightboxWidget.centerDiv(this.divid,this.containingDivid);c.show();jQuery("#sitbReaderErrorMessageClose").unbind("click");jQuery("#sitbReaderErrorMessageClose").click(function(){SitbReader.ErrorMessageWidget.hide()});
this.msgDisplayed=!0},resize:function(){this.msgDisplayed&&(SitbReader.LightboxWidget.centerDiv(this.divid,this.containingDivid),jQuery(this.divid).show())},hide:function(){jQuery(this.divid).hide();this.msgDisplayed=!1}};
SitbReader.MessageWidget={calledShow:!1,reftagsFired:{},randomSignInMsgFirst:!1,load:function(){},close:function(a){this.calledShow=!1;if(SitbReader.Message.messagesDisplayed)if(this.randomSignInMsgFirst)this.randomSignInMsgFirst=!1;else{jQuery("#sitbReaderMessageContainer").fadeOut("normal");SitbReader.Message.cleanupMessages();if(a)for(var b in this.reftagsFired)SitbReader.RefTag.post(SitbReader.RefTag.Actions.closeMessage,b);this.reftagsFired={};SitbReader.Message.messagesDisplayed=!1}},show:function(){this.calledShow=
!0;if(SitbReader.Message.haveMessagesToShow())SitbReader.Message.messagesDisplayed=!0,jQuery("#sitbReaderMessageContainer").hide(),jQuery("#sitbReaderMessageList").children().remove(),this.addAllMessages(),this.resize(),jQuery("#sitbReaderMessageContainer").stop(),jQuery("#sitbReaderMessageContainer").show()},displayRandomPageLoginMessage:function(){SitbReader.Message.setRandomSignInMessageText();if(this.calledShow)this.randomSignInMsgFirst=!0,this.show()},addMessage:function(a,b){if(!sitbReaderIsBlank(a)){SitbReader.MessageActions.sendReftag(a,
b);var c=document.createElement("li");jQuery(c).html(a);jQuery("#sitbReaderMessageList").append(c)}},addAllMessages:function(){this.addMessage(SitbReader.Message.relatedEditionMessage,SitbReader.RefTag.MessageType.relatedEditions);this.addMessage(SitbReader.Message.pictureSuppressed,SitbReader.RefTag.MessageType.pictureSupression);this.addMessage(SitbReader.Message.randomPageLoginMessage,SitbReader.RefTag.MessageType.notLoggedIn);this.addMessage(SitbReader.Message.partialContentMessage,SitbReader.RefTag.MessageType.partialContent)},
resize:function(){if(SitbReader.Message.messagesDisplayed){var a=jQuery("#sitbReaderPageContainer").width()-SITB_READER_SCROLLBAR_WIDTH,b=SitbReader.LeftPaneWidget.getWidth();jQuery("#sitbReaderMessageContainer").width(a).css("left",b+1)}},getTop:function(a){a=jQuery(a).css("top");return typeof a=="undefined"?0:a=parseInt(a.substring(0,a.length-2))},getDisplayElementMessage:function(a,b){var c=SitbReader.ZoomModel.ZOOM_WIDTHS[SitbReader.ZoomModel.zoomLevel],d,e=40;switch(a){case SITB_READER_DE_MSG_TYPE.SIGNIN1:d=
SitbReader.Message.getSignInMessageText(b.pageNumber-1);c=(c-SITB_MESSAGE_LEFT_SPACE_SIGNIN1)/2;c<15&&(c=15,e+=15);d="<div style='height:"+(e-15)+"px'>    <div class='sitbReaderScrollInfoMessageIcon' style='left:"+c+"px'/>    <div class='sitbReaderScrollInfoMessageText' style='left:"+(c+22)+"px'>"+d+"</div>  </div>";break;case SITB_READER_DE_MSG_TYPE.SIGNIN2:e=90;d=SitbReader.Message.getSignInMessageText(b.pageNumber-1);c=(c-SITB_MESSAGE_LEFT_SPACE_SIGNIN2)/2;c<15&&(c=15,e+=15);d="<div style='height:"+
(e-20)+"px'>    <div class='sitbReaderScrollInfoMessageIcon' style='left:"+c+"px;margin-top:24px'/>    <div class='sitbReaderScrollInfoMessageText' style='left:"+(c+22)+"px;padding-top:24px'>"+d+"</div>  </div>";break;case SITB_READER_DE_MSG_TYPE.SKIP:d=SitbReader.Message.getSkipMessageText(b.skipStart,b.skipEnd);c=(c-SITB_MESSAGE_LEFT_SPACE_SKIP)/2;c<15&&(c=15,e+=15);d="<div style='height:"+(e-15)+"px'>    <div class='sitbReaderScrollInfoMessageIcon' style='left:"+c+"px;'/>    <div class='sitbReaderScrollInfoMessageText' style='left:"+
(c+22)+"px;'>"+d+"</div>  </div>";break;case SITB_READER_DE_MSG_TYPE.SKIP_T2NONFPS:d=SitbReader.Message.getSkipMessageText(b.skipStart,b.skipEnd);c=(c-SITB_MESSAGE_LEFT_SPACE_SKIPNONFPS)/2;c<0&&(c=15,e+=15);d="<div style='height:"+(e-15)+"px;'>    <div class='sitbReaderScrollInfoMessageIcon' style='left:"+c+"px'/>    <div class='sitbReaderScrollInfoMessageText' style='left:"+(c+22)+"px'>"+d+"</div>  </div>";break;case SITB_READER_DE_MSG_TYPE.PREVIEW:d=sitbReaderGetString("THIS_IS_A_PREVIEW"),c=(c-
SITB_MESSAGE_LEFT_SPACE_PREVIEW)/2,c<0&&(c=15,e+=15),d="<div style='height:"+(e-15)+"px;'>    <div class='sitbReaderScrollInfoMessageIcon' style='left:"+c+"px'/>    <div class='sitbReaderScrollInfoMessageText' style='left:"+(c+22)+"px'>"+d+"</div>  </div>"}return new SitbReader.DisplayElement(b.top,e,SITB_READER_DE_TYPE.MSG,b.pageNumber,d,a)}};
SitbReader.MessageBoxWidget={messageBoxDisplayed:!1,load:function(){},show:function(a){var b=jQuery("#sitbReaderMessageBoxContainer");b.hide().empty().append(!sitbReaderIsIE?a.fragment.cloneNode(!0):a.fragment.firstChild.cloneNode(!0));this.messageBoxDisplayed=a;this.resize();jQuery("#sitbReaderMessageBoxCloseLink").bind("click",function(){SitbReader.MessageBoxWidget.close()});jQuery("#sitbReaderMessageBoxCloseButton").bind("click",function(){SitbReader.MessageBoxWidget.close()});b.show()},close:function(){jQuery("#sitbReaderMessageBoxContainer").hide();
this.messageBoxDisplayed=!1},resize:function(){this.messageBoxDisplayed&&SitbReader.LightboxWidget.centerDiv("#sitbReaderMessageBoxContainer","#sitbReaderPageContainer")}};
SitbReader.FeedbackWidget={textAreaMaxLength:1500,inputMaxLength:150,recommendationOptions:[sitbReaderGetString("PLEASE_SELECT"),sitbReaderGetString("1_VERY_UNLIKELY"),sitbReaderGetString("2_UNLIKELY"),sitbReaderGetString("3_NEITHER"),sitbReaderGetString("4_LIKELY"),sitbReaderGetString("5_VERY_LIKELY")],textAreaDefaultText:"",load:function(){jQuery("#sitbReaderFeedbackLink").menufy(sitbReaderGetString("FEEDBACK"),this._getMenuHtml(),this.menufyCallback,SITB_FEEDBACK_TEXT_LENGTH)},menufyCallback:function(){SitbReader.RefTag.post(SitbReader.RefTag.Actions.feedback);
var a=jQuery(".sitbReaderFeedbackMenu-textarea"),b=jQuery("#sitbReaderFeedbackMenu-type"),a=jQuery(".sitbReaderMenu-content-center").width()-(b.offset().left-a.offset().left);b.width(a)},show:function(){},disableFeedbackButtons:function(){jQuery("#sitbReaderFeedbackMenu-submit").css({opacity:".60",filter:"alpha(opacity=60)",cursor:"default"});jQuery("#sitbReaderFeedbackMenu-submit").removeAttr("onclick");jQuery("#sitbReaderFeedbackMenu-submit").unbind("click")},enableFeedbackButtons:function(){jQuery("#sitbReaderFeedbackMenu-submit").css({opacity:"1.00",
filter:"alpha(opacity=100)",cursor:"default"});jQuery("#sitbReaderFeedbackMenu-submit").bind("click",function(){SitbReader.FeedbackActions.submitFeedback()})},resetForm:function(){jQuery("#sitbReaderHelpMenu").hide();jQuery(".sitbReaderFeedbackMenu-thanks").hide();jQuery("#sitbReader-fb-reset").click();jQuery(".sitbReaderFeedbackMenu-textarea").css("color","gray");jQuery(".sitbReaderFeedbackMenu-other-input").css("color","gray");jQuery("#sitbReader-fb-other").attr("checked",!1);this.enableFeedbackButtons()},
_getMenuHtml:function(){var a='<option value="Feature: Your Browsing History">'+sitbReaderGetString("FEATURE_BROWSING_HISTORY")+"</option>";return'<form id="sitbReaderFeedbackMenu-form">   <div id="sitbReaderFeedbackMenu-pdiv">'+sitbReaderGetString("SHARING_YOUR_THOUGHT")+'   </div>   <div id="sitbReaderFeedbackMenu-typediv">       <b>'+sitbReaderGetString("FEEDBACK_TYPE")+'</b>&nbsp;<select id="sitbReaderFeedbackMenu-type"           onblur="SitbReader.ReaderKeyboardActions.isKeyHandler = true;"           onfocus="SitbReader.ReaderKeyboardActions.isKeyHandler = false;">           <option value="N/A">'+
sitbReaderGetString("PLEASE_SELECT")+'</option>           <option value="Suggestion">'+sitbReaderGetString("SUGGESTION")+'</option>           <option value="Comment About the Book">'+sitbReaderGetString("COMMENT_ABOUT")+'</option>           <option value="Technical Problem">'+sitbReaderGetString("TECHNICAL_PROBLEM")+'</option>           <option value="Praise">'+sitbReaderGetString("PRAISE")+'</option>           <option value="Complaint">'+sitbReaderGetString("COMPLAINT")+"</option>"+a+'           <option value="Other">'+
sitbReaderGetString("OTHER")+'</option>       </select>   </div>   <div id="sitbReaderFeedbackMenu-comdiv">       <b>'+sitbReaderGetString("YOUR_COMMENTS")+'</b> <span class="sitbReaderFeedbackMenu-char">'+sitbReaderGetString("1500_MAXIMUM")+'</span>   </div>   <div id="sitbReaderFeedbackMenu-txtadiv">       <textarea class="sitbReaderFeedbackMenu-textarea"onkeypress="SitbReader.FeedbackWidget._textAreaOnkeypressEvent(this);" onfocus="SitbReader.FeedbackWidget._textAreaOnFocusEvent(this);" onblur="SitbReader.ReaderKeyboardActions.isKeyHandler = true;">'+
this.textAreaDefaultText+'</textarea>   </div>   <div id="sitbReaderFeedbackMenu-recomdiv">       <b>'+sitbReaderGetString("HOW_LIKELY")+'</b>   </div>   <div>       <select id="sitbReaderFeedbackMenu-recommendations"               onblur="SitbReader.ReaderKeyboardActions.isKeyHandler = true;"               onfocus="SitbReader.ReaderKeyboardActions.isKeyHandler = false;">'+this._getRecommendationOptionsHtml()+'       </select>   </div>   <div><input id="sitbReader-fb-reset" type="Reset" value="reset"></div></form><div class="sitbReaderFeedbackMenu-wrap">   <div class="sitbReaderFeedbackMenu-loading"></div>   <div class="sitbReaderFeedbackMenu-thanks">'+
sitbReaderGetString("THANK_YOU_FOR_FEEDBACK")+'</div></div><div id="sitbReaderFeedbackMenu-submit" class="sitbReaderFeedbackMenu-submit" onclick="SitbReader.FeedbackActions.submitFeedback();"></div><div class="sitbReaderFeedbackMenu-cancel" onclick="jQuery(\'#sitbReaderHelpMenu\').hide();"></div>'},_getRecommendationOptionsHtml:function(){for(var a="",b=this.recommendationOptions.length,c=b;c>0;c--)a+='        <option value="'+c%b+'">'+this.recommendationOptions[c%b];return a},_textAreaOnkeypressEvent:function(a){if(a.value.length>
this.textAreaMaxLength)a.value=a.value.substring(0,this.textAreaMaxLength)},_textAreaOnFocusEvent:function(a){SitbReader.ReaderKeyboardActions.isKeyHandler=!1;if(a.value==this.textAreaDefaultText)a.value="";jQuery(".sitbReaderFeedbackMenu-textarea").css("color","black")}};
SitbReader.HelpWidget={activeAnswer:-1,load:function(){jQuery("#sitbReaderHelpMenu").html(getSitbLightboxMenuHTML());jQuery("#sitbReaderHelpLink").menufy(sitbReaderGetString("HELP"),SitbReader.HelpWidget._getHelpContentsHtml(),this.menufyCallback,SITB_HELP_TEXT_LENGTH)},menufyCallback:function(){SitbReader.RefTag.post(SitbReader.RefTag.Actions.help)},getHelpContentsQuestions:function(){var a=[];a.push(sitbReaderGetString("NEED_TO_SIGN_IN"));a.push(sitbReaderGetString("MY_PRIOR_PURCHASE"));a.push(sitbReaderGetString("SLIGHTLY_DIFFERENT_CONTENT"));
a.push(sitbReaderGetString("ADJUST_SIZE_TEXT"));SitbReader.currentBook.searchable&&a.push(sitbReaderGetString("SEARCH_MORE_EFFECTIVELY"));a.push(sitbReaderGetString("PROVIDE_FEEDBACK"));a.push(sitbReaderGetString("WHAT_IS_BROWSING_HISTORY"));return a},getHelpContentsAnswers:function(){var a=[];a.push(sitbReaderGetString("NEED_TO_SIGN_IN_ANSWER"));a.push(sitbReaderGetString("MY_PRIOR_PURCHASE_ANSWER"));a.push(sitbReaderGetString("SLIGHTLY_DIFFERENT_CONTENT_ANSWER"));a.push(sitbReaderGetString("ADJUST_SIZE_TEXT_ANSWER"));
SitbReader.currentBook.searchable&&a.push(sitbReaderGetString("SEARCH_MORE_EFFECTIVELY_ANSWER"));a.push(sitbReaderGetString("PROVIDE_FEEDBACK_ANSWER"));a.push(sitbReaderGetString("WHAT_IS_BROWSING_HISTORY_ANSWER"));return a},toggleHelpAnswer:function(a){var b="#sitbReaderHelpQuestion"+a,c="#sitbReaderHelpQuestionIcon"+a,d="#sitbReaderHelpAnswer"+a,e="#sitbReaderHelpQuestion"+SitbReader.HelpWidget.activeAnswer,f="#sitbReaderHelpQuestionIcon"+SitbReader.HelpWidget.activeAnswer,g="#sitbReaderHelpAnswer"+
SitbReader.HelpWidget.activeAnswer;jQuery(e).removeClass("sitbReaderHelpQuestionActive");jQuery(e).addClass("sitbReaderHelpQuestionInactive");jQuery(f).removeClass("sitbReaderHelpQuestionIconActive");jQuery(f).addClass("sitbReaderHelpQuestionIconInactive");SitbReader.HelpWidget.activeAnswer!=a?(jQuery(g).hide(),jQuery(d).show(),jQuery(b).removeClass("sitbReaderHelpQuestionInactive"),jQuery(b).addClass("sitbReaderHelpQuestionActive"),jQuery(c).removeClass("sitbReaderHelpQuestionIconInactive"),jQuery(c).addClass("sitbReaderHelpQuestionIconActive"),
SitbReader.HelpWidget.activeAnswer=a):(jQuery(d).hide(),SitbReader.HelpWidget.activeAnswer=-1);sitbRedrawMenuBorder()},_navigateToHelpPage:function(){window.open(sitbReaderGetString("HELP_PAGE"));return!1},_getHelpContentsHtml:function(){var a=[];a.push(sitbReaderIsIE?"<div class='sitbReaderHelpTable'>":"<table class='sitbReaderHelpTable'><tr><td>");a.push("<div class='sitbReaderFaqHeader'>"+sitbReaderGetString("FAQ")+"</div><br>");for(var b=this.getHelpContentsQuestions(),c=this.getHelpContentsAnswers(),
d=0;d<b.length;d++)a.push("<div class='sitbReaderHelpTableRow'>"),a.push("<div class='sitbReaderHelpTableCol1'><div class='sitbReaderHelpQuestionIcon sitbReaderHelpQuestionIconInactive' id='sitbReaderHelpQuestionIcon"+d+"' "),a.push("onclick='javascript:SitbReader.HelpWidget.toggleHelpAnswer("+d+");' ></div></div>"),a.push("<div class='sitbReaderHelpTableCol2'>"),a.push("<div id='sitbReaderHelpQuestion"+d+"' class='sitbReaderHelpQuestionText' onclick='javascript:SitbReader.HelpWidget.toggleHelpAnswer("+
d+");'>"),a.push(b[d]),a.push("</div>"),a.push("<div class='sitbReaderHelpAnswer' id='sitbReaderHelpAnswer"+d+"'>"+c[d]+"</div></div>"),a.push("</div>");a.push("<div class='sitbReaderHelpTableRow'>");a.push("<div class='sitbReaderHelpTableCol1 sitbReaderHelpYellowBullet'>&#0155;</div>");a.push("<div class='sitbReaderHelpTableCol3'>");a.push("<div class='sitbReaderHelpQuestionText' id='sitbReaderHelpLearnMore' onclick='SitbReader.HelpWidget._navigateToHelpPage();'>"+sitbReaderGetString("LEARN_MORE_LITB")+
"</div>");a.push("</div></div>");a.push(sitbReaderIsIE?"</div>":"</td></tr></table>");return a.join("")}};
SitbReader.LeftPaneWidget={isOpened:!0,buyBoxHeight:130,show:function(){var a=jQuery("#sitbReaderBuyContent").height();if(a>0)this.buyBoxHeight=a;a=this.buyBoxHeight+SITB_READER_LEFT_PANE_COLLAPSER_TOP_ADJ;jQuery("#sitbReaderCollapser").css("top",a+"px");this.isOpened||this.close()},toggle:function(){SitbReader.metrics.startTimer("leftpanetoggle");jQuery("#sitbReaderLeftPane").is(":hidden")?(SitbReader.RefTag.post(SitbReader.RefTag.Actions.leftSeperator,SitbReader.RefTag.PanelAction.open),this.open()):
(SitbReader.RefTag.post(SitbReader.RefTag.Actions.leftSeperator,SitbReader.RefTag.PanelAction.close),this.close());SitbReader.currentBook.isHTML()&&SitbReader.ReaderWidget.updateOnResize();SitbReader.metrics.endTimer("leftpanetoggle")},open:function(){this.isOpened=!1;this._animate("open");jQuery("#sitbReaderCollapser").css({"background-position":"0 -3140px",width:"16px"}).attr("title","");var a={background:"url("+SITB_READER_HORZ_SPRITE_URL+")","background-position":"-90px 0",width:"6px"};jQuery("#sitbReaderSplitter").css(a);
jQuery("#sitbReaderSplitter_bottom").css(a)},close:function(){this.isOpened=!1;this._animate("close");jQuery("#sitbReaderCollapser").css({"background-position":"0 -3234px",width:"22px"}).attr("title",SITB_READER_TTIP_LP_TAB);var a={background:"url("+SITB_READER_HORZ_SPRITE_URL+")","background-position":"-97px 0",width:"12px"};jQuery("#sitbReaderSplitter").css(a);jQuery("#sitbReaderSplitter_bottom").css(a)},getWidth:function(){return this.isOpened?SITB_READER_LEFT_PANEL_WIDTH_OPN:SITB_READER_LEFT_PANEL_WIDTH_CLD},
splitterOnMouseHelper:function(a){var b=jQuery("#sitbReaderCollapser"),c=jQuery(".sitbReaderSplitter");a=="onMouseOver"?this.isOpened?(b.css("background-position","0 -3187px"),c.css({"background-position":"-110px 0",width:"6px"})):(b.css("background-position","0 -3281px"),c.css({"background-position":"-117px 0",width:"12px"})):this.isOpened?(b.css("background-position","0 -3140px"),c.css({"background-position":"-90px 0",width:"6px"})):(b.css("background-position","0 -3234px"),c.css({"background-position":"-97px 0",
width:"12px"}))},_animate:function(a){a=(this.isOpened=a=="open"?!0:!1)?SITB_READER_LEFT_PANEL_WIDTH:0;this.isOpened?jQuery("#sitbReaderLeftPane").css("display","inline"):jQuery("#sitbReaderLeftPane").css("display","none");jQuery("#sitbReaderSplitter").css("left",a);jQuery("#sitbReaderSplitter_bottom").css("left",a);jQuery("#sitbReaderCollapser").css("left",a);a=SitbReader.ReaderWidget;a.setWidth();a.centerPageImage();jQuery("#sitbReaderPageContainer").css("left",this.getWidth());a.updateVerticalScroller();
SitbReader.ZoomWidget.centerToolbarButtons();SitbReader.MessageWidget.resize();SitbReader.ErrorMessageWidget.resize();SitbReader.PagelabelWidget.update()}};
SitbReader.SBWidget={containerPageOffsets:[],recDivId:"#sitbReaderSB #recs",histDivId:"#sitbReaderSB #history",JQO:{},recMargin:0,recHeight:0,recHolderHeight:0,hideCount:0,isOpened:null,curBookTarget:[],hidden:{"#sitbReaderSB #recs":!1,"#sitbReaderSB #history":!1},navHolder:{"#sitbReaderSB #recs":"#sitbReaderSB-recs","#sitbReaderSB #history":"#sitbReaderSB-history"},paneRefTag:{"#sitbReaderSB #recs":SitbReader.RefTag.SerendipityBar.similarities,"#sitbReaderSB #history":SitbReader.RefTag.SerendipityBar.history},
books:{"#sitbReaderSB #history":function(){return SitbReader.SerendipityBar.historyBooks},"#sitbReaderSB #recs":function(){return SitbReader.SerendipityBar.recommendedBooks}},historyPaneWidget:new SitbReader.PaneTitleWidget(sitbReaderGetString("BROWSING_HISTORY"),"sitbReaderSB-history","SitbReader.SBActions.toggleHistoryPane()"),recsPaneWidget:new SitbReader.PaneTitleWidget(sitbReaderGetString("CUSTOMER_ALSO_BOUGHT"),"sitbReaderSB-recs","SitbReader.SBActions.toggleRecsPane()"),pageCounts:[],curPage:[],
_shouldOpen:function(){return this.isOpened!=null?this.isOpened:this.isOpened=jQuery(window).width()>=SITB_READER_MIN_DEFAULT_WIDTH},setIsOpened:function(a){this.isOpened=a},show:function(a){this.resize();a&&this._shouldOpen()?(SitbReader.metrics.startTimer("SBshow"),this.open(),setTimeout(function(){SitbReader.SBActions.loadSBDataCall(SitbReader.SerendipityBar.loadBooksFromData,"")},SITB_SB_LOAD_DELAY_MILLISECONDS),SitbReader.currentBook.isHTML()&&SitbReader.ReaderWidget.updateOnResize()):jQuery("#sitbReaderSBOpener").css("background-position",
"0 -2613px").attr("title",SITB_READER_TTIP_SB_PANE_CLD)},resize:function(){var a=SitbReader.LeftPaneWidget.buyBoxHeight-SITB_READER_SB_OPENER_TOP_ADJ;jQuery("#sitbReaderSBOpener").css("top",a+"px");SitbReader.SerendipityBar.dataLoaded&&(this.hidden[this.histDivId]==!1&&this.historyHandleResize(),this.hidden[this.recDivId]==!1&&this.books[this.recDivId]().length&&this.recHandleResize())},toggle:function(){jQuery("#sitbReaderSB").width()==0?(SitbReader.RefTag.post(SitbReader.RefTag.Actions.sbSeperator,
SitbReader.RefTag.PanelAction.open),this.open()):(SitbReader.RefTag.post(SitbReader.RefTag.Actions.sbSeperator,SitbReader.RefTag.PanelAction.close),this.close());SitbReader.currentBook.isHTML()&&SitbReader.ReaderWidget.updateOnResize()},open:function(){this.setIsOpened(!0);SitbReader.metrics.startTimer("SBopen");SitbReader.SerendipityBar.dataLoaded||setTimeout(function(){SitbReader.SBActions.loadSBDataCall(SitbReader.SerendipityBar.loadBooksFromData,"")},SITB_SB_LOAD_DELAY_MILLISECONDS);this._animate("open");
jQuery("#sitbReaderSBOpener").css("background-position","0 -2086px").unbind().attr("title",SITB_READER_TTIP_SB_PANE_OPN);SitbReader.metrics.endTimer("SBopen")},close:function(){this.setIsOpened(!1);SitbReader.metrics.startTimer("SBclose");this._animate("close");jQuery("#sitbReaderSBOpener").css("background-position","0 -2613px").unbind().attr("title",SITB_READER_TTIP_SB_PANE_CLD);SitbReader.metrics.endTimer("SBclose")},hideLoading:function(){jQuery(".sitbReaderSB-content").css("background","none");
jQuery(".hideforloading").css("display","block")},getAvailHeightForRecs:function(){return jQuery("#sitbReaderSB").height()-(jQuery("#sitbReaderSB-recs-title").offset().top-jQuery("#sitbReaderSB").offset().top)-38},getAvailHeightForHistory:function(){return this.getSBContentHeight()-jQuery("#sitbReaderSB-history #nav").height()-jQuery("#sitbReaderSB #historyinfo").height()-jQuery("#sitbReaderSB-history-title").height()-13},_animate:function(a){isOpen=a=="open"?!0:!1;this.setIsOpened(isOpen);a=isOpen?
SITB_READER_SB_WIDTH:0;jQuery("#sitbReaderSB").width(a);jQuery("#sitbReaderSBSplitter").css("right",a);jQuery("#sitbReaderSBSplitter_bottom").css("right",a);jQuery("#sitbReaderSBOpener").css("right",a);a=SitbReader.ReaderWidget;a.setWidth();a.centerPageImage();a.updateVerticalScroller();SitbReader.ZoomWidget.centerToolbarButtons();SitbReader.MessageWidget.resize();SitbReader.ErrorMessageWidget.resize();SitbReader.PagelabelWidget.update()},drawBook:function(a,b,c){var d=jQuery(b),e=jQuery("<div class=pager></div>");
d.append(e);var f=1;typeof this.curBookTarget[b]=="undefined"&&(this.curBookTarget[b]=0);this.containerPageOffsets[b]=[];this.containerPageOffsets[b][0]=0;this.curPage[b]=0;for(var g in a){var k=a[g].render(e);e.height()>c&&(k.remove(),e=jQuery("<div class=pager></div>"),d.append(e),e.append(k),this.containerPageOffsets[b][f]=parseInt(g),f++)}f<2&&b==this.histDivId&&jQuery("#sitbReaderSB #historyholder").height(e.height());d.width(f*SITB_READER_SB_WIDTH);this.pageCounts[b]=f},findBestPage:function(a,
b){for(var c=this.containerPageOffsets[b],d=c.length,e=-1,f;d-e>1;)c[f=d+e>>1]>a?d=f:e=f;return e},showNextRecs:function(){this.panePageTransition(this.recDivId,1)},showPrevRecs:function(){this.panePageTransition(this.recDivId,-1)},showNextHist:function(){this.panePageTransition(this.histDivId,1)},showPrevHist:function(){this.panePageTransition(this.histDivId,-1)},panePageTransition:function(a,b){if(this.curPage[a]+b>=0&&this.curPage[a]+b<this.pageCounts[a]){var c=a==this.recDivId?"SBpagetransitionsims":
"SBpagetransitionhistory";SitbReader.metrics.startTimer(c);this.curPage[a]+=b;this.JQO[a].animate({marginLeft:this.curPage[a]*SITB_READER_SB_WIDTH*-1},"normal");this.curBookTarget[a]=this.containerPageOffsets[a][this.curPage[a]];this.updateNavInfo(a,this.navHolder[a]);SitbReader.RefTag.post(SitbReader.RefTag.Actions.sbPage,this.paneRefTag[a]);SitbReader.metrics.endTimer(c)}},recHandleResize:function(){var a=this.getAvailHeightForRecs();jQuery("#sitbReaderSB #recholder").height(a);this.sbCatResize(this.recDivId,
a)},sbCatResize:function(a,b){if(SitbReader.SerendipityBar.dataLoaded){this.JQO[a]=jQuery(a);this.JQO[a].empty();this.drawBook(this.books[a](),a,b);var c=this.findBestPage(this.curBookTarget[a],a);this.curPage[a]=c;this.JQO[a].css("marginLeft",c*-1*SITB_READER_SB_WIDTH);this.updateNavInfo(a,this.navHolder[a])}},updateNavInfo:function(a,b){var c=this.curPage[a],d=this.pageCounts[a];jQuery(b+" #curpage").html(c+1);jQuery(b+" #pagecount").html(d);c<d-1?jQuery(b+" #nav #next").addClass("enabled"):jQuery(b+
" #nav #next").removeClass("enabled sbhighlight");c>0?jQuery(b+" #nav #prev").addClass("enabled"):jQuery(b+" #nav #prev").removeClass("enabled sbhighlight")},historyHandleResize:function(){var a=this.getAvailHeightForHistory();jQuery("#sitbReaderSB #historyholder").height(a);this.sbCatResize(this.histDivId,a)},historySlideUp:function(){var a=jQuery("#sitbReaderSB-history-content");a.is(":hidden")||(this.hideCount++,this.hidden[this.histDivId]=!0,SitbReader.SBWidget.resize(),a.slideUp("slow",function(){SitbReader.SBWidget.resize()}),
this.historyPaneWidget.slideUp())},historySlideDown:function(){var a=jQuery("#sitbReaderSB-history-content");a.is(":hidden")&&(this.hideCount--,this.hidden[this.histDivId]=!1,SitbReader.SBWidget.resize(),a.slideDown("slow",function(){SitbReader.SBWidget.resize()}),this.historyPaneWidget.slideDown())},recsSlideUp:function(){var a=jQuery("#sitbReaderSB-recs-content");a.is(":hidden")||(this.hideCount++,this.hidden[this.recDivId]=!0,a.slideUp("slow",function(){SitbReader.SBWidget.resize()}),this.recsPaneWidget.slideUp())},
recsSlideDown:function(){var a=jQuery("#sitbReaderSB-recs-content");a.is(":hidden")&&(this.hideCount--,this.hidden[this.recDivId]=!1,SitbReader.SBWidget.resize(),a.slideDown("slow",function(){SitbReader.SBWidget.resize()}),this.recsPaneWidget.slideDown())},getSBContentHeight:function(){var a=jQuery("#sitbReaderSBSplitter").height()+8-jQuery("#sitbReaderSB-history-title").height()-jQuery("#sitbReaderSB-recs-title").height();this.hideCount<=0&&(a/=2);return a},historyLoadSuccess:function(){jQuery("#sitbReaderSB #historyinfo #histlinktext").html(SITB_READER_SB_HIST_LINK);
jQuery("#sitbReaderSB #historyinfo #histstatustext").hide()},historyLoadFailure:function(){jQuery("#sitbReaderSB #historyinfo #histlinktext").html(SITB_READER_SB_NO_HIST_LINK);jQuery("#sitbReaderSB #historyinfo #histstatustext").html(SITB_READER_SB_ERR_HIST_TEXT).css("display","block");jQuery("#sitbReaderSB #sitbReaderSB-history #nav").remove()},historyLoadEmpty:function(){jQuery("#sitbReaderSB #historyinfo #histlinktext").html(SITB_READER_SB_HIST_LINK);jQuery("#sitbReaderSB #historyinfo #histstatustext").html(SITB_READER_SB_NO_HIST_TEXT).css("display",
"block");jQuery("#sitbReaderSB #sitbReaderSB-history #nav").remove()},historyLoadOff:function(){jQuery("#sitbReaderSB #historyinfo #histlinktext").html(SITB_READER_SB_OFF_HIST_LINK);jQuery("#sitbReaderSB #historyinfo #histstatustext").html(SITB_READER_SB_OFF_HIST_TEXT).css("display","block");jQuery("#sitbReaderSB #sitbReaderSB-history #nav").remove()},noSims:function(){jQuery("#sitbReaderSB #simsinfo").html(SITB_READER_SB_NO_SIMS).show();jQuery("#sitbReaderSB #sitbReaderSB-recs-content #nav").remove();
jQuery("#sitbReaderSB #recholder").height(8)},splitterOnMouseHelper:function(a){var b=jQuery("#sitbReaderSBOpener"),c=jQuery(".sitbReaderSBSplitter");a=="onMouseOver"?(this.isOpened?b.css("background-position","0 -2350px"):b.css("background-position","0 -2877px"),c.css("background-position","-117px 0")):(this.isOpened?b.css("background-position","0 -2086px"):b.css("background-position","0 -2613px"),c.css("background-position","-97px 0"))},getHtml:function(){return!SitbReader.SerendipityBar.isOn?"":
'<div id="sitbReader-sbarea">    <div id="sitbReaderSBSplitter" class="sitbReaderSBSplitter"          onclick="SitbReader.SBWidget.toggle()"          onmouseover="SitbReader.SBWidget.splitterOnMouseHelper(\'onMouseOver\')"         onmouseout="SitbReader.SBWidget.splitterOnMouseHelper(\'onMouseOut\')">        <div id="sitbReaderSBSplitter_mid" class="sitbReaderSBSplitter"></div>        <div id="sitbReaderSBSplitter_btm" class="sitbReaderSBSplitter"></div>    </div>    <div id="sitbReaderSBOpener" title="'+
SITB_READER_TTIP_SB_PANE_CLD+'"          onclick="SitbReader.SBWidget.toggle()"          onmouseover="SitbReader.SBWidget.splitterOnMouseHelper(\'onMouseOver\')"         onmouseout="SitbReader.SBWidget.splitterOnMouseHelper(\'onMouseOut\')">   </div>    <div id="sitbReaderSB">        <div id="sitbReaderSB-history">'+this.historyPaneWidget.getHtml()+'            <div id="sitbReaderSB-history-content" class="sitbReaderSB-content">                <div id="nav" class="hideforloading">                    <button id="prev" onmouseover="if (jQuery(this).hasClass(\'enabled\')) jQuery(this).addClass(\'sbhighlight\');" onmouseout="jQuery(this).removeClass(\'sbhighlight\');" onclick="SitbReader.SBWidget.showPrevHist()"/> <div id="navinfo"> '+
sitbReaderGetString("PAGE_OF",{HTML_START:'<span id="curpage"></span>',HTML_END:'<span id="pagecount"></span>'})+'</div>                    <button id="next" onmouseover="if (jQuery(this).hasClass(\'enabled\')) jQuery(this).addClass(\'sbhighlight\');" onmouseout="jQuery(this).removeClass(\'sbhighlight\');" onclick="SitbReader.SBWidget.showNextHist()"/>                </div>                <div id="historyholder"><div id="history"></div>            </div>            <div id="historyinfo" class="hideforloading"><div id="histstatustext"/>&gt;                <a href="/gp/history/?ybhGroup=Books/ref=rdr_'+
SitbReader.RefTag.Actions.sbBookHistory+'" title="'+SITB_READER_TTIP_SB_HIST_LINK+'">                    <span id="histlinktext"/>                </a>            </div>        </div>    </div>    <div id="sitbReaderSB-recs">'+this.recsPaneWidget.getHtml()+'        <div id="sitbReaderSB-recs-content" class="sitbReaderSB-content">            <div id="nav" class="hideforloading">                <div id="prev" onmouseover="if (jQuery(this).hasClass(\'enabled\')) jQuery(this).addClass(\'sbhighlight\');" onmouseout="jQuery(this).removeClass(\'sbhighlight\');" onclick="SitbReader.SBWidget.showPrevRecs()"/> <div id="navinfo"> '+
sitbReaderGetString("PAGE_OF",{HTML_START:'<span id="curpage"></span>',HTML_END:'<span id="pagecount"></span>'})+'</div>                <div id="next" onmouseover="if (jQuery(this).hasClass(\'enabled\')) jQuery(this).addClass(\'sbhighlight\');" onmouseout="jQuery(this).removeClass(\'sbhighlight\');" onclick="SitbReader.SBWidget.showNextRecs()"/></div><div id="recholder">                <div id="recs"></div></div>                <div id="simsinfo"/>            </div>        </div>    </div></div>'}};
SitbReader.ClickableTOCWidget={show:function(a){if(a=parseInt(a))if(SitbReader.ClickableTOC.hasPages[a]){var b=SitbReader.currentBook.pages[a].links;SitbReader.ClickableTOCActions.preCachePage(parseInt(a)+1);for(var c in b){var d=jQuery("<div class='toclink tocdest-"+b[c].dest+"' style='left:"+b[c].box[0]*100+"%; top:"+b[c].box[1]*100+"%; width:"+b[c].box[2]*100+"%; height:"+b[c].box[3]*100+"%'><div/></div>");SitbReader.currentBook.pages[b[c].dest].isX()?(d.addClass("tocunavailable"),d.attr("title",
sitbReaderGetString("PAGE_NOT_AVAILABLE"))):(SitbReader.ClickableTOC.visitedPages[b[c].dest]&&d.addClass("tocvisited"),function(a){d.click(function(){SitbReader.ClickableTOCActions.goToPage(a)});d.hover(function(){jQuery("#sitbReaderPageScroll .toclink.tocdest-"+a).addClass("tochover")},function(){jQuery("#sitbReaderPageScroll .toclink.tocdest-"+a).removeClass("tochover")})}(b[c].dest));jQuery("#sitbReaderHighlights-"+a).append(d)}}else SitbReader.ClickableTOCActions.loadTOCDataCall(a,SitbReader.ClickableTOCActions.storeAndShow)}};
SitbReader.PageSequenceWidget={scrollTimer:200,slowScrollTimer:500,redrawTimer:50,scrollTimeout:null,scrollSequenceStart:0,minScrollTrigger:0,maxScrollTrigger:3E3,scrollEventCount:0,deferredRedraw:null,bigScroll:!1,goToStartTime:-1,immediateScroll:!1,redrawCallback:void 0,reachedEndOfScroll:!1,scrollNow:function(){var a=SitbReader.PageSequenceWidget;if(a.immediateScroll)return a.immediateScroll=!1,!0;if(a.scrollEventCount%10==0&&!a.bigScroll){var b=(new Date).getTime(),c=jQuery("#sitbReaderPageContainer").scrollTop();
if(a.scrollEventCount==0){if(a.scrollSequenceStart=b,c<a.minScrollTrigger||c>a.maxScrollTrigger)a.bigScroll=!0}else if(c<a.minScrollTrigger||c>a.maxScrollTrigger)if(b-a.scrollSequenceStart>a.slowScrollTimer)return!0;else a.bigScroll=!0}return!1},show:function(a){SitbReader.PageSequenceWidget.reachedEndOfScroll=!1;var b=SitbReader.ZoomModel.getPageWidth();a?this._createDisplayScroll():(jQuery("#sitbReaderPageContainer").scrollTop(0),SitbReader.currentBook.isHTML()&&this._createDisplayElements());this.showDisplayElementByScroll();
jQuery("#sitbReaderPageContainer").scroll(function(){var a=SitbReader.PageSequenceWidget;clearTimeout(a.scrollTimeout);a.scrollNow()?a._scrollReleaseCallback():a.scrollTimeout=setTimeout(a._scrollReleaseCallback,a.scrollTimer,top);a.scrollEventCount++});jQuery("#sitbReaderPageScroll").css({height:SitbReader.pageSequence.scrollHeight,width:b}).bind("contextmenu",function(a){sitbReaderStopEvent(a);return!1});SITB_READER_IS_TOUCH_SUPPORTED&&(jQuery("#sitbReaderPlaceholder").bind("touchmove",function(a){a.originalEvent.touches.length==
1&&a.preventDefault()}).bind("touchend",function(a){a.originalEvent.touches.length>1&&SitbReader.LightboxActions.handleResize()}),jQuery("#vellumShade").bind("touchmove",function(a){a.originalEvent.touches.length==1&&a.preventDefault()}).bind("touchend",function(a){a.originalEvent.touches.length>1&&SitbReader.LightboxActions.handleResize()}),jQuery("#sitbReaderPageContainer").bind("touchstart",function(a){if(a.originalEvent.touches.length==1)SitbReader.ReaderWidget.lastPosition=a.originalEvent.touches[0].pageY}).bind("touchmove",
function(a){if(a.originalEvent.touches.length==1)a.preventDefault(),a=a.originalEvent.touches[0].pageY,adjustedScrollTop=Math.max(0,jQuery("#sitbReaderPageContainer").scrollTop()+SitbReader.ReaderWidget.lastPosition-a),jQuery("#sitbReaderPageContainer").scrollTop(adjustedScrollTop),SitbReader.ReaderWidget.lastPosition=a}).bind("touchend",function(a){a.originalEvent.touches.length>1&&SitbReader.LightboxActions.handleResize()}))},_scrollReleaseCallback:function(){var a=SitbReader.PageSequenceWidget,
b=jQuery("#sitbReaderPageContainer")[0].offsetHeight,c=jQuery("#sitbReaderPageContainer").scrollTop(),d=jQuery("#sitbReaderPageContainer")[0].scrollHeight,e=SITB_READER_SCROLL_END_TOLERANCE,f=!0;SitbReader.currentBook.isHTML()&&(jQuery("div.sitb-buy-box").length>0?e=jQuery("div.sitb-buy-box").outerHeight(!0)/2:f=!1);if(a.reachedEndOfScroll==!1&&f==!0&&b+c+e>=d)SitbReader.RefTag.post(SitbReader.RefTag.Actions.scrolledToEnd),a.reachedEndOfScroll=!0;b=(new Date).getTime();b-SitbReader.LightboxActions.openTime>
SITB_MESSAGE_CLOSE_DELAY&&b-SitbReader.LightboxActions.switchTime>SITB_MESSAGE_CLOSE_DELAY&&SitbReader.LightboxActions.readerReady&&a.closeMessagesAfterUserInteraction();SitbReader.currentBook.isPrint()?a.showDisplayElementByScroll(!0):(SitbReader.ReaderWidget.updatePageTurnersState(),a._handleScrollMetrics())},_createDisplayScroll:function(){var a=SitbReader.pageSequence;this._createDisplayElements();for(var b=SitbReader.ZoomModel.getPageWidth(),c=[],d=0;d<a.PARTIAL_DIVS_NUM;d++)c.push('<div id="scrollElm-'+
d+'"></div>');jQuery("#sitbReaderPageScroll").html(c.join("")).css({height:SitbReader.pageSequence.scrollHeight,width:b})},_createDisplayElements:function(a){SitbReader.pageSequence.emptyScroll();var b=SitbReader.currentBook;b.isPrint()?SitbReader.PageSequenceWidget._createPrintDisplayElements(b,a):SitbReader.PageSequenceWidget._createHtmlDisplayElement(b)},_createPrintDisplayElements:function(a,b){var c=SitbReader.pageSequence,d=a.pages,e=a.numPages,f=null,g,k,h=!1,m=a.bookmarks.getFirstAndLastPageNumberByName(sitbReaderGetString("FIRST_PAGES")),
q=m.last?m.last+1:null,m=m.first?m.first:null,l=SitbReader.availability.level,n=SitbReader.MessageWidget,p=sitbReaderIsIE?8:10,j;for(j=1;j<=e;j++){if(j==2||j==m)g=n.getDisplayElementMessage(SITB_READER_DE_MSG_TYPE.PREVIEW,{top:c.scrollHeight,pageNumber:j}),this._addOrReplaceMessageElement(g,c);j==q&&l==0&&!SitbReader.currentBook.hasFullAccess&&(g=n.getDisplayElementMessage(SITB_READER_DE_MSG_TYPE.SIGNIN1,{top:c.scrollHeight,pageNumber:j}),this._addOrReplaceMessageElement(g,c));if(!d[j].isX()&&!d[j].isY()){if(h&&
(h=!1,g=j-1,c.getDisplayElement(c.getScrollLength()-1).type!=SITB_READER_DE_TYPE.MSG)){var o;o=SitbReader.availability.isT2NonFPS()?SITB_READER_DE_MSG_TYPE.SKIP_T2NONFPS:SITB_READER_DE_MSG_TYPE.SKIP;g=n.getDisplayElementMessage(o,{top:c.scrollHeight,pageNumber:g,skipStart:k,skipEnd:g});c.pushDisplayElement(g);c.scrollHeight+=g.height;b&&b<j&&f==null&&(f=g)}g=d[j].getScaledDimensions().height;g=new SitbReader.DisplayElement(c.scrollHeight,g,SITB_READER_DE_TYPE.PG,j);c.pushDisplayElement(g);c.scrollHeight+=
g.height+p;b==j&&(f=g)}else h||(h=!0,k=j)}h&&(o=SitbReader.availability.isT2NonFPS()?SITB_READER_DE_MSG_TYPE.SKIP_T2NONFPS:SITB_READER_DE_MSG_TYPE.SKIP,g=j-1,g=n.getDisplayElementMessage(o,{top:c.scrollHeight,pageNumber:g,skipStart:k,skipEnd:g}),b&&f==null&&(f=g),c.pushDisplayElement(g),c.scrollHeight+=g.height);!SitbReader.currentBook.hasFullAccess&&l==0&&c.getDisplayElement(c.getScrollLength()-1).type!=SITB_READER_DE_TYPE.MSG&&(g=n.getDisplayElementMessage(SITB_READER_DE_MSG_TYPE.SIGNIN2,{top:c.scrollHeight,
pageNumber:j}),this._addOrReplaceMessageElement(g,c));return f},_createHtmlDisplayElement:function(){var a=SitbReader.pageSequence,b=new SitbReader.KindleContentWidget;a.pushDisplayElement(b);return b},_addOrReplaceMessageElement:function(a,b){var c=b.getDisplayElement(b.getScrollLength()-1);if(c&&c.type==SITB_READER_DE_TYPE.MSG)if(SitbReader.Message.getMessagePriority(c.msgType)<SitbReader.Message.getMessagePriority(a.msgType))a.top-=c.height,b.replaceDisplayElement(b.getScrollLength()-1,a),b.scrollHeight-=
c.height;else return;else b.pushDisplayElement(a);b.scrollHeight+=a.height},showDisplayElementByScroll:function(a,b){a&&SitbReader.metrics.startTimer("scroll");var c=jQuery("#sitbReaderPageContainer").height(),d=SitbReader.pageSequence;if(!b||b<0)b=jQuery("#sitbReaderPageContainer").scrollTop();var e=b+c,f=d.findVisibleElementIndices(b,e),g;for(g in f)d.getDisplayElement(f[g]).page&&d.getDisplayElement(f[g]).page.setVisible();g=d.currentPage;var k=f[parseInt(f.length/2)],k=d.findElementsRangeToSet(k),
h=d.findElementsToSet(f);if(h.length>1)this.minScrollTrigger=d.getDisplayElement(h[1]).top,this.maxScrollTrigger=d.getDisplayElement(h[h.length-1]).top-c;this.scrollEventCount=0;this.bigScroll=!1;d.setVisibleElements(h,k);d.selectCurrentPageNumber(f,b,e);if(d.currentPage!=g||SitbReader.currentBook.isHTML())this.onPageChange(d.currentPage);if(a)this.goToStartTime>0?(SitbReader.metrics.recordTimer("page",(new Date).getTime()-this.goToStartTime),this.goToStartTime=0):this._handleScrollMetrics(),SitbReader.metrics.endTimer("scroll")},
closeMessagesAfterUserInteraction:function(){SitbReader.MessageWidget.close(!1);SitbReader.ErrorMessageWidget.hide()},onPageChange:function(a){SitbReader.PagelabelWidget.update();SitbReader.BookmarksActions.update();SitbReader.ReaderActions.setPageTurners();SitbReader.currentSearch.numResults>0&&(a=jQuery.inArray(a,SitbReader.currentSearch.resultPageNumbers),SitbReader.SearchWidget.select(a),SitbReader.SearchWidget.adjustScrollBar(a),SitbReader.currentSearch.numDisplayedResults-a<=2&&SitbReader.SearchActions.fetchMoreResults())},
scrollToPageTop:function(a,b){var c=SitbReader.pageSequence,d=c.getPageDisplayIndex(a),e=c.displayScroll[d].top;b>0&&d-1>0&&c.getDisplayElement(d-1).type==SITB_READER_DE_TYPE.MSG?e=c.getDisplayElement(d-1).top:b<0&&d+1<c.getScrollLength()&&c.getDisplayElement(d+1).type==SITB_READER_DE_TYPE.MSG&&(e=jQuery("#sitbReaderPageContainer").height(),e=c.getDisplayElement(d+1).top-e+c.getDisplayElement(d+1).height);jQuery("#sitbReaderPageContainer").scrollTop()!=e&&jQuery("#sitbReaderPageContainer").scrollTop(e)},
redraw:function(){var a=SitbReader.pageSequence,b=-1,c=-1;if(SitbReader.currentBook.isPrint()){if(a.currentPage){b=a.getDisplayElement(a.getPageDisplayIndex(a.currentPage));if(sitbReaderIsBlank(b))return;b=(b.top-jQuery("#sitbReaderPageContainer").scrollTop())/b.height}var d=this._createDisplayElements(a.currentPage);a.currentPage&&d&&(c=Math.round(d.top-d.height*b));this.showDisplayElementByScroll(!1,c);c!=-1&&jQuery("#sitbReaderPageContainer").scrollTop(c)}jQuery("#sitbReaderPageScroll").height(SitbReader.pageSequence.scrollHeight).width(SitbReader.ZoomModel.getPageWidth());
SitbReader.ReaderWidget.updateOnResize();this.redrawCallback!==void 0&&this.redrawCallback.call()},_handleScrollMetrics:function(){var a=jQuery("#sitbReaderPageContainer").scrollTop(),b=jQuery("#sitbReaderPageContainer").height(),b=Math.abs(a-this.lastTop)/b;this.lastTop=a;SitbReader.metrics.count("scroll_"+(b>3?"large":b>0.75?"medium":"small"))},requestRedraw:function(){if(!this.deferredRedraw)this.deferredRedraw=setTimeout("SitbReader.PageSequenceWidget.deferredRedraw = false; SitbReader.PageSequenceWidget.redraw()",
this.redrawTimer)}};SitbReader.PagelabelWidget={update:function(){var a=jQuery("#sitbReaderPageLabel"),b=a.css("display")=="block";SitbReader.currentBook.pageLabels.hasLabels&&!b?a.show():!SitbReader.currentBook.pageLabels.hasLabels&&b&&a.hide();b&&(b=jQuery("#sitbReaderBottomButton").width(),a.html(SitbReader.currentBook.pageLabels.getLabel(SitbReader.pageSequence.currentPage)),a=b/2-a.width()/2,jQuery("#sitbReaderPageLabel")&&jQuery("#sitbReaderPageLabel").css("left",a))}};
SitbReader.ModeSwitchWidget={jQModeSwitch:void 0,modeTabs:{print:{oid:"#readerModeTabPrint",tabObject:void 0},kindle:{oid:"#readerModeTabKindle",tabObject:void 0}},load:function(){jQuery(".readerModeTab, .readerModeTab div.readerModeTabBorder").each(function(){jQuery(this).css("background-image","url("+SITB_READER_VERT_SPRITE_URL+")")});jQModeSwitch=jQuery("#sitbReaderMode");SITB_CHAPADA_ENABLED?(this.modeTabs.print.tabObject=jQuery(this.modeTabs.print.oid),this.modeTabs.kindle.tabObject=jQuery(this.modeTabs.kindle.oid),
this._resetTabs(),this._updateTabs()):jQModeSwitch.empty()},_resetTabs:function(){this.modeTabs.print.tabObject.unbind("click").removeClass("activeReaderModeTab").removeClass("deactivatedReaderModeTab");this.modeTabs.kindle.tabObject.unbind("click").removeClass("activeReaderModeTab").removeClass("deactivatedReaderModeTab")},_updateTabs:function(){var a=this.modeTabs.print.tabObject,b=this.modeTabs.kindle.tabObject,c=SitbReader.currentBook,d=SitbReader.ModeSwitchActions,e=c.buyingAsin;c.isPrint()?
(a.addClass("activeReaderModeTab"),!c.hasKindleAsin()&&!d.hasPath(e)||c.originalAsin?b.addClass("deactivatedReaderModeTab"):b.unbind("click").click(function(){d.switchMode(d.hasPath(e)?d.getPath(e):c.kindleAsin,SITB_READER_BOOK_TYPE.HTML)})):(b.addClass("activeReaderModeTab"),!c.hasPrintAsin()&&!d.hasPath(e)||c.originalAsin?a.addClass("deactivatedReaderModeTab"):a.unbind("click").click(function(){d.switchMode(d.hasPath(e)?d.getPath(e):c.sitbAsin,SITB_READER_BOOK_TYPE.PRINT)}))}};
SitbReader.BottomButtonWidget={BOTTOM_BUTTON_INVISIBLE_OPACITY:0.01,BOTTOM_BUTTON_HOVER_OPACITY:0.9,jQBottomButtonId:"#sitbReaderBottomButton",load:function(){this.jQBottomButton=jQuery(this.jQBottomButtonId);this.jQBottomButton.unbind("mouseover").unbind("click").unbind("mouseout").bind("mouseover",function(){SitbReader.BottomButtonWidget.jQBottomButton.fadeTo(250,SitbReader.BottomButtonWidget.BOTTOM_BUTTON_HOVER_OPACITY)}).bind("mouseout",function(){SitbReader.BottomButtonWidget.jQBottomButton.fadeTo(1E3,
SitbReader.BottomButtonWidget.BOTTOM_BUTTON_INVISIBLE_OPACITY)}).css("background","url("+SITB_READER_VERT_SPRITE_URL+") repeat-x 0px -489px").click(SitbReader.BottomButtonActions.moveNextPage);jQuery(".readerBottomButton").each(function(){jQuery(this).css("background","url("+SITB_READER_SPRITES_URL+") no-repeat 0px -3584px")})},show:function(){this.handleResize();setTimeout(function(){SitbReader.BottomButtonWidget.jQBottomButton.fadeTo(1E3,SitbReader.BottomButtonWidget.BOTTOM_BUTTON_INVISIBLE_OPACITY)},
1E3)},handleResize:function(){var a=jQuery("#sitbReaderPageContainer"),b=-8;a[0].scrollWidth>a.width()&&(b+=SITB_READER_SCROLLBAR_WIDTH);this.jQBottomButton.css({width:Math.max(0,a.innerWidth()-SITB_READER_SCROLLBAR_WIDTH),left:SitbReader.LeftPaneWidget.getWidth(),bottom:b});SitbReader.PagelabelWidget.update()},setEnabled:function(a){this.jQBottomButton.unbind("click");a&&this.jQBottomButton.click(SitbReader.BottomButtonActions.moveNextPage)}};
SitbReader.KindleContentWidget=function(){this.jQPartialDiv=this.jQContentHolder=void 0;this.hasContent=!1;this.height=this.top=0;this.type=SITB_READER_DE_TYPE.HS;this.pageNumber=1;this.pagePadding=120;SitbReader.KindleContentWidget._imageCount=0;SitbReader.KindleContentWidget._srlOffsetTop=0;SitbReader.KindleContentWidget._imagesPreSRL=0;SitbReader.KindleContentWidget._adjustmentMutex=0;SitbReader.KindleContentWidget._visibleWidget=void 0};
SitbReader.KindleContentWidget.prototype.setOnPartialDiv=function(a){this.jQPartialDiv=jQuery("#scrollElm-"+a);jQuery("#sitbReaderPageContainer");jQuery("#sitbReaderPageScroll");this.resize();SitbReader.KindleContentActions.initialize(this)};
SitbReader.KindleContentWidget.prototype.updateContent=function(a){this.hasContent=!0;this.jQPartialDiv.append(!sitbReaderIsIE?a.cloneNode(!0):a.firstChild.cloneNode(!0));this.jQContentHolder=jQuery("#sitbReaderKindleSample");SitbReader.KindleContentWidget._visibleWidget=this;for(a=jQuery("center[name='cover']",this.jQContentHolder).next();a.length>0&&sitbReaderIsBlank(jQuery.trim(a.text()));){var b=a.find("img");if(b.length>0){b.eq(0).remove();break}a=a.next()}a=jQuery("img",this.jQContentHolder);
SitbReader.KindleContentWidget._imageCount=a.length;var b=SitbReader.KindleContentActions._contentCache[SitbReader.currentBook.asin].srl,c=void 0,c=void 0!=b?jQuery("a[name='"+b+"']"):jQuery(".sitb-srl");if(c!=void 0&&c.position()!=void 0)SitbReader.KindleContentWidget._srlOffsetTop=c.position().top;jQuery.each(a,function(a,b){var c=jQuery(b);sitbReaderIsBlank(c.attr("src"))||(c.position().top<SitbReader.KindleContentWidget._srlOffsetTop&&(SitbReader.KindleContentWidget._imagesPreSRL+=1),c.load(SitbReader.KindleContentWidget._handleImage).error(SitbReader.KindleContentWidget._handleImage))});
this.resize(!1);setTimeout(function(){SitbReader.KindleContentActions.registerEvents()},0);setTimeout(function(){SitbReader.KindleContentWidget._imagesPreSRL==0&&SitbReader.KindleContentWidget._showSample()},0)};
SitbReader.KindleContentWidget.prototype.resize=function(a){var b=jQuery("#sitbReaderPageContainer"),c=jQuery("#sitbReaderPageScroll"),d=SitbReader.ZoomModel,e=d.getPageWidth()+"px",f=d.getPageWidth()-this.pagePadding+"px";c.css("width",e);this.jQPartialDiv.css("width",e);this.jQContentHolder&&this.jQContentHolder.css("width",f);this.hasContent?setTimeout(function(){SitbReader.KindleContentWidget._adjustHeight(a)},100):(this.jQPartialDiv.addClass("pageHtml").addClass("loadingLarge").css({height:b.height()+
"px","font-size":d.getFontSize()+"px"}),c.css("height",b.height()+"px"))};
SitbReader.KindleContentWidget._handleImage=function(a){var b=jQuery(this);b.unbind("load").unbind("error");a.type=="error"&&b.hide();b.position().top<SitbReader.KindleContentWidget._srlOffsetTop&&SitbReader.KindleContentWidget._imagesPreSRL--;SitbReader.KindleContentWidget._imageCount--;(SitbReader.KindleContentWidget._imagesPreSRL==0||SitbReader.KindleContentWidget._imageCount==0)&&SitbReader.KindleContentWidget._showSample();SitbReader.KindleContentWidget._imageCount==0&&SitbReader.KindleContentWidget._adjustHeight(!1)};
SitbReader.KindleContentWidget._showSample=function(){SitbReader.KindleContentWidget._imagesPreSRL=void 0;SitbReader.KindleContentWidget._adjustHeight(!1);SitbReader.KindleContentActions.goToLRL();SitbReader.KindleContentWidget._visibleWidget.jQPartialDiv.removeClass("loadingLarge");SitbReader.KindleContentWidget._visibleWidget.jQContentHolder.css("visibility","visible")};
SitbReader.KindleContentWidget._adjustHeight=function(a){if(SitbReader.KindleContentWidget._adjustmentMutex==1)SitbReader.KindleContentWidget._adjustmentMutex=2;else if(SitbReader.KindleContentWidget._adjustmentMutex>1)return;SitbReader.KindleContentWidget._adjustmentMutex=1;var b=SitbReader.ZoomModel;b.getPageWidth();var c=jQuery("#sitbReaderKindleSample"),d=jQuery("#sitbReaderEndOfSample",c),e=jQuery("#sitbReaderPageContainer");if(!(d.length==0||sitbReaderIsBlank(d))){if(a)for(var a=0,f=null;!f&&
a<=100;){var g=jQuery("#sitbLightbox").offset(),f=g.left+c.offset().left+100,g=Math.max(0,g.top-jQuery(document).scrollTop())+jQuery("#sitbLBHeader").height()+a;(f=document.elementFromPoint(f,g))&&f.className.match("sitb-")!="sitb-"&&f.nodeName.match("^H")!="H"&&f.id.match("^amazon")!="amazon"&&(f=null);a+=10}a=jQuery("img",c);jQuery.each(a,function(a,b){var c=jQuery(b),d=c.css("font-size"),d=SitbReader.ZoomModel.getPageWidth()-parseFloat(d.substring(0,d.length-2))-120;b.width>d||b.naturalWidth>d?
b.width=d:c.removeAttr("width")});c.css({"font-size":b.getFontSize()+"px"});jQuery("#sitbKindleFontStyle").remove();jQuery("#sitbReaderKindleSample").prepend("<style id='sitbKindleFontStyle' type='text/css'>"+SitbReader.ZoomModel.getZoomFontSizes()+"</style>");b=d.position().top;c.parent().parent().css("height",b);c.parent().css("height",b);c.css({height:b});SitbReader.pageSequence.scrollHeight=b;SitbReader.ReaderActions.setPanning();SitbReader.ReaderWidget.updatePageTurnersState();SitbReader.BottomButtonWidget.handleResize();
f&&e.scrollTop(jQuery(f).position().top);SitbReader.KindleContentWidget._adjustmentMutex--;SitbReader.KindleContentWidget._adjustmentMutex==2&&SitbReader.KindleContentWidget._adjustHeight()}};SitbReader.KindleContentWidget.prototype.visibleCompare=function(a,b){var c=this.top+this.height;return a<=this.top&&this.top<=b||c>=a&&c<b||c>=b&&this.top<=a?0:this.top>b?-1:1};
SitbReader.KindleContentWidget.prototype.getViewportPercentage=function(a,b){var c=b-a,d=this.top+this.height;return this.top>b||d<a?0:this.top<=a&&d>=a&&d<=b?(d-a)/c:this.top<=b&&this.top>=a&&d>=b?(b-this.top)/c:this.top<=a&&d>=b?1:this.top>=a&&d<=b?this.height/c:0};
SitbReader.CustomerRequestWidget={load:function(){if(!SitbReader.currentBook.hasKindleAsin()&&SitbReader.currentBook.isPrint()&&!SitbReader.ModeSwitchActions.hasPath(SitbReader.currentBook.buyingAsin)){var a=jQuery("#readerModeTabKindle");a.bind("mouseover",function(){SitbReader.CustomerRequestWidget.show()});a.bind("mouseout",function(){SitbReader.CustomerRequestWidget.hide()});a=this._getContent();jQuery("#sitbReaderCustomerRequestContent").html(a);jQuery("#sitbReaderCustomerRequestLink").bind("click",
function(){SitbReader.CustomerRequestActions.sendRequest()})}},show:function(){jQuery("#sitbReaderCustomerRequestContainer").show()},hide:function(){jQuery("#sitbReaderCustomerRequestContainer").hide()},_getContent:function(){return sitbReaderGetString("SEND_CUSTOMER_REQUEST")}};
function getSitbLightboxHTML(){return'<div id="sitbLightbox">    <div id="sitbLBHeader">       <div id="sitbReaderAmazonLogo"></div>       <div id="sitbReaderLookInside"></div>       <div id="sitbReaderMode">           <div class="readerModeTab" id="readerModeTabKindle">              <div class="readerModeTabBorder readerModeTabBorderLeft"/>               <div class="readerModeTabContent">'+sitbReaderGetString("KINDLE_PREVIEW")+'</div>              <div class="readerModeTabBorder readerModeTabBorderRight"/>               <div id="sitbReaderCustomerRequestContainer">                  <div id="sitbReaderCustomerRequestWrapper">                      <div id="sitbReaderCustomerRequestContent"></div>                  </div>              </div>           </div>           <div class="readerModeTab" id="readerModeTabPrint">              <div class="readerModeTabBorder readerModeTabBorderLeft"/>               <div class="readerModeTabContent">'+
sitbReaderGetString("PRINT_PREVIEW")+'</div>              <div class="readerModeTabBorder readerModeTabBorderRight"/>            </div>       </div>       <div id="sitbReaderZoomToolbar">           <button id="sitbReaderTitlebarZoomIn" title="'+SITB_READER_TTIP_ZOOM_IN+'"/>            <button id="sitbReaderTitlebarZoomOut" title="'+SITB_READER_TTIP_ZOOM_OUT+'"/>        </div>       <div id="sitbReaderTBLinks">           <div id="sitbReaderHelpMenu"></div>           <a href="javascript:void(0)" id="sitbReaderFeedbackLink">'+
sitbReaderGetString("FEEDBACK")+'</a>&nbsp;|&nbsp;           <a href="javascript:void(0)" id="sitbReaderHelpLink">'+sitbReaderGetString("HELP")+'</a>&nbsp;|&nbsp;           <a href="javascript:void(0)" id="sitbReaderFullscreenLink" onclick="SitbReader.LightboxWidget.toggleFullscreen();">'+SITB_READER_IN_STANDARDVIEW_TEXT+'</a>&nbsp;|&nbsp;           <a href="javascript:void(0)" id="sitbReaderCloseLink" class="sitbReaderClose" onclick="SitbReader.LightboxActions.back(SitbReader.RefTag.ExitMethod.link, true)">'+
sitbReaderGetString("CLOSE")+'</a>       </div>       <div id="sitbReaderCloseButton" class="sitbReaderClose" onclick="SitbReader.LightboxActions.back(SitbReader.RefTag.ExitMethod.button, true)" title="'+SITB_READER_TTIP_READER_CLOSE+'"></div>       <div id="sitbReaderHeaderSpacer" />    </div>  <div id="sitbReaderMiddle">    <div id="sitbReader-leftnav">      <div id="sitbReaderLeftPane">      \t  <div id="sitbReaderLeftStaticHeight">           <div id="sitbReaderBuyContent">           <div>                <a href="javascript:void(0)" id="sitbReaderBookThumbnailHolder"></a>              <div id="sitbReaderBookTitle"><a href="javascript:void(0)"></a> <span id="sitbReaderBinding"></span></div>              <div id="sitbReaderAuthorBlock"></div>            </div>            <div id="sitbReaderPriceBlock"></div>            <div id="sitbReaderDeviceBlock"></div>            <div id="sitbReaderUsedDiv">              &nbsp;            </div>          </div>           <div id="sitbReaderBookmarks">'+
SitbReader.BookmarksWidget.paneTitleWidget.getHtml()+'               <div id="sitbReaderBookmarks-pages"></div>           </div>\t\t   </div>           <div id="sitbReaderSearch">               <div id="sitbReaderSearch-loading"></div>'+SitbReader.SearchWidget.paneTitleWidget.getHtml()+'                   <div id="sitbReaderSearch-contents">                       <div id="sitbReaderSearch-headerheight">                           <div id="sitbReaderSearch-input">                               <form id="sitbReaderSearch-form">                                   <input type="text" class="sitbReaderSearch-inputbox"                                          title="'+
SITB_READER_TTIP_SEARCH_GO+'"                                          onfocus="SitbReader.ReaderKeyboardActions.isKeyHandler = false"                                          onblur="SitbReader.ReaderKeyboardActions.isKeyHandler = true">                                   <input type="button" class="sitbReaderSearch-button" title="'+SITB_READER_TTIP_SEARCH_INPUT+'" onclick="SitbReader.SearchWidget.submitSearch();"></input>                               </form>                           </div>                           <div id="sitbReaderSearch-count">                           <div class="sitbReader-horizontal-gray-dash-border"></div>                           <div class="sitbReader-horizontal-white-border"></div>                           <div class="sitbReaderSearch-count-block">                               <div id="sitbReaderSearch-close" title="'+
SITB_READER_TTIP_SEARCH_CLOSE+'" onclick="SitbReader.SearchActions.closeCurrentSearch();"></div>                               <span id="sitbReaderSearch-count-text"></span>                           </div>                           <div class="sitbReader-horizontal-white-border"></div>                           <div class="sitbReader-horizontal-gray-dash-border"></div>                       </div>                       <div id="sitbReaderSearch-sips"></div>\t\t\t        </div>                   <div id="sitbReaderSearch-all-results"                        onfocus="SitbReader.ReaderKeyboardActions.isKeyHandler = false"                        onblur="SitbReader.ReaderKeyboardActions.isKeyHandler = true">                   </div>               </div>           </div>      </div>      <div id="sitbReaderBorderOverlay"></div>      <div id="sitbReaderSplitter" class="sitbReaderSplitter"            onclick="SitbReader.LeftPaneWidget.toggle()"            onmouseover="SitbReader.LeftPaneWidget.splitterOnMouseHelper(\'onMouseOver\')"            onmouseout="SitbReader.LeftPaneWidget.splitterOnMouseHelper(\'onMouseOut\')">      </div>      <div id="sitbReaderSplitter_bottom" class="sitbReaderSplitter"></div>      <div id="sitbReaderCollapser"            onclick="SitbReader.LeftPaneWidget.toggle()"            onmouseover="SitbReader.LeftPaneWidget.splitterOnMouseHelper(\'onMouseOver\')"            onmouseout="SitbReader.LeftPaneWidget.splitterOnMouseHelper(\'onMouseOut\')">      </div></div>    <div id="sitbReader-pagearea">      <div id="sitbReaderPageContainerVerticalScroller">        <button id="sitbReaderLeftPageTurner" title="'+
SITB_READER_TTIP_PREV_PAGE+'"></button>        <button id="sitbReaderRightPageTurner" title="'+SITB_READER_TTIP_NEXT_PAGE+'"></button>      </div>      <div id="sitbReaderLoadingPageMessage"/>      <div id="sitbReaderErrorMessageContainer">        <div id="sitbReaderErrorMessageIcon"></div>        <div id="sitbReaderErrorMessageHeader"></div>        <div id="sitbReaderErrorMessageText"></div>        <div id="sitbReaderErrorMessageClose"></div>      </div>      <div id="sitbReaderMessageContainer">        <div id="sitbReaderInfoMessageIcon"></div>        <div id="sitbReaderMessageHeader">'+
SITB_READER_JUST_SO_YOU_KNOW+'</div>        <br/>        <ul id="sitbReaderMessageList">        </ul>        <div class="sitbReaderErrorMessageClose" onclick="SitbReader.MessageWidget.close(true);"></div>      </div>      <div id="sitbReaderMessageBoxContainer">      </div>      <div id="sitbReaderPageContainer">         <div id="sitbReaderPageScroll"></div>      </div>      <div id="sitbReaderBottomButton">          <div class="readerBottomButton" id="sitbReaderBottomButtonLeft" />          <div id="sitbReaderPageLabel"/>          <div class="readerBottomButton" id="sitbReaderBottomButtonRight" />      </div>'+
SitbReader.SBWidget.getHtml()+"</div>"}
function getSitbLightboxMenuHTML(){return'   <div id="sitbReaderMenu-top">       <div>           <div class="sitbReaderMenu-topleft"></div>           <div id="sitbReaderMenu-topborder-top" class="sitbReaderMenu-topborder sitbReaderMenu-topborder-top"></div>           <div id="sitbReaderMenu-topright-top" class="sitbReaderMenu-topright sitbReaderMenu-topright-top"></div>       </div>       <div>           <div class="sitbReaderMenu-leftborder"></div>           <div id="sitbReaderMenu-topcontent" class="sitbReaderMenu-content">               <div id="sitbReaderMenu-title"></div>               <div id="sitbReaderMenu-close" onclick="jQuery(\'#sitbReaderHelpMenu\').hide();"></div>           </div>           <div id="sitbReaderMenu-rightborder-top" class="sitbReaderMenu-rightborder sitbReaderMenu-rightborder-top"></div>       </div>   </div>   <div id="sitbReaderMenu-content">       <div>           <div class="sitbReaderMenu-topleft"></div>           <div id="sitbReaderMenu-topborder-content" class="sitbReaderMenu-topborder sitbReaderMenu-topborder-content"></div>           <div id="sitbReaderMenu-rightborder-content-top" class="sitbReaderMenu-rightborder sitbReaderMenu-rightborder-content-top"></div>       </div>       <div>           <div class="sitbReaderMenu-leftborder sitbReaderMenu-leftborder-content"></div>           <div id="sitbReaderMenu-content-center" class="sitbReaderMenu-content sitbReaderMenu-content-center">           </div>           <div id="sitbReaderMenu-rightborder-content" class="sitbReaderMenu-rightborder sitbReaderMenu-rightborder-content"></div>       </div>       <div>           <div class="sitbReaderMenu-bottomleft"></div>           <div id="sitbReaderMenu-bottomborder-content" class="sitbReaderMenu-bottomborder sitbReaderMenu-bottomborder-content"></div>           <div id="sitbReaderMenu-bottomright-content" class="sitbReaderMenu-bottomright sitbReaderMenu-bottomright-content"></div>       </div>   </div>'}
SitbReader.LODActions={_bookdataCache:[],_cacheIndex:0,_currentRequests:{},_openFor:{},open:function(a,b){SitbReader.LODActions.lightBoxOpenMethod=function(){SitbReader.LightboxActions._openReader(b)};SitbReader.LODActions.loadBookData(a)},openToRandom:function(a,b){SitbReader.LODActions.lightBoxOpenMethod=function(){SitbReader.LightboxActions._openReaderToRandomPage(b)};SitbReader.LODActions.loadBookData(a)},openToQuery:function(a,b,c){SitbReader.LODActions.lightBoxOpenMethod=function(){SitbReader.LightboxActions._openReaderToSearchResults(b,
c)};SitbReader.LODActions.loadBookData(a)},openToPage:function(a,b,c,d){SitbReader.LODActions.lightBoxOpenMethod=function(){SitbReader.LightboxActions._openReaderToPage(b,c,d)};SitbReader.LODActions.loadBookData(a)},loadBookData:function(a){SitbReader.sitbReaderOpenStart=(new Date).getTime();jQuery("body").css("overflow","hidden");SitbReader.LightboxWidget.dimTheLights();var b=this._getFromCache(a);SitbReader.currentBook&&SitbReader.currentBook.buyingAsin==a?SitbReader.LODActions.lightBoxOpenMethod():
b?this.callback(b):SitbReader.LODActions._currentRequests[a]?SitbReader.LODActions._openFor[a]=!0:(SitbReader.LODActions._currentRequests[a]=!0,sitbReaderAjaxCall({method:"getBookData",asin:a},function(b){delete SitbReader.LODActions._currentRequests[a];SitbReader.LODActions.callback(b)},function(b,d,e){delete SitbReader.LODActions._currentRequests[a];SitbReader.LODActions.errorCallback(b,d,e)}))},cache:function(a){!SitbReader.LODActions._getFromCache(a)&&!SitbReader.LODActions._currentRequests[a]&&
(SitbReader.LODActions._currentRequests[a]=!0,sitbReaderAjaxCall({method:"getBookData",asin:a},function(b){delete SitbReader.LODActions._currentRequests[a];SitbReader.LODActions.cacheCallback(b,a)},function(){SitbReader.LODActions._openFor[a]&&(delete SitbReader.LODActions._currentRequests[a],SitbReader.LODActions.errorCallback())}))},callback:function(a){typeof a.error!="undefined"?(jQuery("#vellumMsgTxt").html(sitbReadDhandlerMsg(a.error.text)),jQuery("#vellumMsgHdr").html(sitbReadDhandlerMsg(a.error.title)),
centerJQueryObjectInWindow(jQuery("#vellumMsg")).show(),(new Image).src="/gp/search-inside/reftag/ref="+a.error.reftag):(SitbReader.LODActions.cacheAndInitialize(a),SitbReader.LODActions.lightBoxOpenMethod())},cacheCallback:function(a,b){SitbReader.LODActions._openFor[b]?SitbReader.LODActions.callback(a):typeof a.error=="undefined"&&SitbReader.LODActions.cacheAndInitialize(a)},cacheAndInitialize:function(a){SitbReader.LODActions._putInCache(a.buyingAsin,a);SitbReader.LightboxActions.initialize(a)},
errorCallback:function(){jQuery("#vellumMsgTxt").html(sitbReaderGetString("INFORMATION_UNAVAILABLE"));jQuery("#vellumMsgHdr").html(sitbReaderGetString("SERVER_TIMEOUT"));centerJQueryObjectInWindow(jQuery("#vellumMsg")).show();(new Image).src="/gp/search-inside/reftag/ref=rdr_bar_jsto";SitbReader.RefTag.httpGet(SitbReader.RefTag.getFormatedRefTag(SitbReader.RefTag.Actions.timeout,SitbReader.RefTag.Timeout.readerOpen))},_putInCache:function(a,b){this._getFromCache(a)||(this._bookdataCache[this._cacheIndex++%
SITB_READER_BOOKDATA_CACHE_SIZE]=b)},_getFromCache:function(a){for(var b=0;b<this._bookdataCache.length;b++)if(this._bookdataCache[b]&&this._bookdataCache[b].buyingAsin==a)return this._bookdataCache[b];return null},lodMethod:Vellum.mt,lodArguments:Vellum.rg};
Vellum={c:SitbReader.LODActions.cache,o:SitbReader.LODActions.open,r:SitbReader.LODActions.openToRandom,q:SitbReader.LODActions.openToQuery,p:SitbReader.LODActions.openToPage,h:function(){jQuery("#vellumMsg").hide();jQuery("#vellumShade").hide();jQuery("#vellumLdgIco").hide();jQuery("body").css("overflow","auto");SitbReader.LightboxActions.back(SitbReader.RefTag.ExitMethod.exterior,!0)},x:function(){},pl:function(){},ao:Vellum.ao};
SitbReader.LODActions.lodMethod&&Vellum[SitbReader.LODActions.lodMethod].apply(SitbReader.LODActions,SitbReader.LODActions.lodArguments);
